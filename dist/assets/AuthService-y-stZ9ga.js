const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-Dlio5rBP.js","assets/main-6ahFnZtK.css"])))=>i.map(i=>d[i]);
import{G as c,t as d,v as i,S as s,_ as l,x as u}from"./main-Dlio5rBP.js";async function g(){try{const o=new c;return(await d(i,o)).user}catch(o){throw o.code==="auth/cancelled-popup-request"?s({message:"Login cancelado. Tente novamente.",type:"info"}):s({message:"Erro ao fazer login: "+o.message,type:"error"}),o}}function w(){const o=document.getElementById("btn-entrar");if(o){if(o.dataset.bound==="1")return;o.dataset.bound="1",o.style.pointerEvents="auto",o.disabled=!1,o.tabIndex=0,console.log("üîê Bot√£o de login pronto para clique"),o.addEventListener("click",async()=>{console.log("üîê Clique no bot√£o de login detectado");try{typeof window.showLoading=="function"&&window.showLoading(!0);const e=await g();if(e){try{const{ensureUserProfile:t}=await l(async()=>{const{ensureUserProfile:n}=await import("./main-Dlio5rBP.js").then(a=>a.a7);return{ensureUserProfile:n}},__vite__mapDeps([0,1]));await t(e)}catch{}window.appState.currentUser=e,r(!1);try{console.log("üìä Carregando dados do usu√°rio ap√≥s login..."),await u(e),console.log("‚úÖ Dados carregados com sucesso ap√≥s login")}catch(t){console.error("‚ùå Erro ao carregar dados ap√≥s login:",t)}try{const{renderPage:t}=await l(async()=>{const{renderPage:n}=await import("./main-Dlio5rBP.js").then(a=>a.ab);return{renderPage:n}},__vite__mapDeps([0,1]));window.location.hash="#/dashboard",await t("/dashboard")}catch{console.warn("‚ö†Ô∏è Router n√£o dispon√≠vel, usando fallback"),window.location.hash="#/dashboard"}}}catch(e){console.error("Erro no login:",e),typeof window.showLoading=="function"&&window.showLoading(!1)}})}}function f(){return new Promise(o=>{let e=!0,t=!1;const n=setTimeout(()=>{t||(console.log("‚è∞ Timeout aguardando autentica√ß√£o - assumindo n√£o autenticado"),t=!0,window.appState.currentUser=null,r(!0),o(!1))},2e3);i.onAuthStateChanged(a=>{t||(clearTimeout(n),t=!0,a?(console.log("‚úÖ Usu√°rio autenticado:",a.email),window.appState.currentUser=a,r(!1),e&&(e=!1,o(!0))):(console.log("‚ùå Usu√°rio n√£o autenticado"),window.appState.currentUser=null,typeof window.stopAllListeners=="function"&&window.stopAllListeners(),window.appState&&(window.appState.currentBudget=null,window.appState.transactions=[],window.appState.categories=[],window.appState.recorrentes=[],window.appState.notifications=[]),r(!0),e&&(e=!1,o(!1))))})})}async function h(){try{await i.signOut(),console.log("‚úÖ Logout realizado com sucesso")}catch(o){console.error("‚ùå Erro ao fazer logout:",o)}}function r(o){const e=document.getElementById("login-page"),t=document.getElementById("app-content");e&&t&&(o?(e.style.display="flex",t.style.display="none"):(e.style.display="none",t.style.display="block"))}export{f as checkAuthState,h as logout,w as setupLoginButton,r as toggleLoginPage};

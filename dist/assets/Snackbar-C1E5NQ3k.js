import{e as h}from"./main-BVWxnpqW.js";import{initFromStorage as g}from"./snackbarPrefs-BEdSEys5.js";var m={};class p{constructor(){this.queue=[],this.isShowing=!1,this.defaultDuration=3e3,this.bottomOffset=80,this.position="bottom",this.align="center",this.hoverPause=!0,this._currentTimeout=null,this._currentEl=null,this._restoreFocusEl=null;try{this.reducedMotion=typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)")?.matches}catch{this.reducedMotion=!1}try{const t=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent:"";/jsdom/i.test(t)&&(this.reducedMotion=!0)}catch{}try{typeof process<"u"&&m&&(m.VITEST||m.JEST_WORKER_ID)&&(this.reducedMotion=!0)}catch{}this.reducedMotion&&(this.hoverPause=!1),this.maxQueue=5,this._lastShownSig=null,this._lastShownAt=0,this._lastShownMap=new Map,this.cooldownMs=500,this._stats={totalShown:0,byType:Object.create(null),last:null}}show(t,n="info",o=null,a){const i={message:t,type:n,duration:o||this.defaultDuration,action:a&&typeof a=="object"?a:null},s=`${i.type}|${i.message}`,f=this.queue[this.queue.length-1];if(!(f&&`${f.type}|${f.message}`===s)){if(this._currentEl&&this._currentEl.getAttribute("data-snackbar-sig")===s){try{this.incrementCurrentCount()}catch{}return}try{const u=Date.now(),d=this._lastShownMap.get(s)||0;if(u-d<(this.cooldownMs|0))return;this._lastShownMap.set(s,u)}catch{}this.queue.length>=this.maxQueue&&this.queue.shift(),this.queue.push(i);try{this._stats.totalShown+=1,this._stats.byType[n]=(this._stats.byType[n]||0)+1,this._stats.last={type:n,message:t}}catch{}this.processQueue()}}call(t){typeof t=="string"?this.show(t,"info"):typeof t=="object"&&this.show(t.message||"Notificação",t.type||"info",t.duration)}processQueue(){if(this.isShowing||this.queue.length===0)return;this.isShowing=!0;const t=this.queue.shift();this.createSnackbar(t)}createSnackbar(t){const{message:n,type:o,duration:a,action:i}=t;this.removeExistingSnackbars();const s=document.createElement("div");s.className=this.getSnackbarClasses(o),s.classList.add("snackbar"),s.setAttribute("data-snackbar","1"),s.setAttribute("data-pos",this.position),s.setAttribute("data-align",this.align);const f=o==="error"||o==="warning";s.setAttribute("role",f?"alert":"status"),s.setAttribute("aria-live",f?"assertive":"polite"),s.setAttribute("aria-atomic","true"),s.innerHTML=this.getSnackbarContent(n,o,i),s.classList.add(`snackbar-${o}`),this.applyThemeStyles(s,o),s.style.zIndex="99999";try{const l=`${this.bottomOffset}px`;this.position==="top"?(s.style.top=`calc(${l} + env(safe-area-inset-top, 0px))`,s.style.bottom=""):(s.style.bottom=`calc(${l} + env(safe-area-inset-bottom, 0px))`,s.style.top=""),this.align==="left"?(s.style.left="16px",s.style.right="",s.style.transform="none"):this.align==="right"?(s.style.right="16px",s.style.left="",s.style.transform="none"):(s.style.left="50%",s.style.right="",s.style.transform="translateX(-50%)")}catch{}try{this._restoreFocusEl=document.activeElement instanceof HTMLElement?document.activeElement:null}catch{this._restoreFocusEl=null}document.body.appendChild(s),this.setupEventListeners(s,i);const u=()=>s.classList.add("snackbar-show");this.reducedMotion?s.classList.add("snackbar-show"):requestAnimationFrame(u);const d=()=>{this.clearDismissTimer();const l=Math.max(10,a|0);this._currentTimeout=setTimeout(()=>{this.removeSnackbar(s)},this.reducedMotion?Math.min(200,l):l)};this._currentEl=s;try{const l=`${o}|${n}`;s.setAttribute("data-snackbar-sig",l)}catch{}d(),this.hoverPause&&(s.addEventListener("mouseenter",()=>this.clearDismissTimer()),s.addEventListener("mouseleave",()=>d()),s.addEventListener("focusin",()=>this.clearDismissTimer()),s.addEventListener("focusout",()=>d())),this.reducedMotion||setTimeout(()=>{const l=s.querySelector(".snackbar-action"),b=s.querySelector(".snackbar-close");l?l.focus?.():b&&b.focus?.()},10)}getCurrentTheme(){return document.documentElement.classList.contains("dark")?"dark":"light"}getCurrentThemeColor(){return localStorage.getItem("themeColor")||document.documentElement.getAttribute("data-theme-color")||"blue"}applyThemeStyles(t,n){const o=this.getCurrentTheme(),a=this.getCurrentThemeColor(),i={blue:{primary:"#3B82F6",secondary:"#1E40AF",light:"#DBEAFE"},green:{primary:"#10B981",secondary:"#059669",light:"#D1FAE5"},purple:{primary:"#8B5CF6",secondary:"#7C3AED",light:"#EDE9FE"},orange:{primary:"#F59E0B",secondary:"#D97706",light:"#FEF3C7"}},s=i[a]||i.blue,u=(l=>{switch(l){case"success":return o==="dark"?{bg:s.primary,color:"#ffffff",border:s.secondary}:{bg:s.secondary,color:"#ffffff",border:s.primary};case"error":return o==="dark"?{bg:"#ef4444",color:"#ffffff",border:"#dc2626"}:{bg:"#dc2626",color:"#ffffff",border:"#b91c1c"};case"warning":return o==="dark"?{bg:"#f59e0b",color:"#1f2937",border:"#d97706"}:{bg:"#d97706",color:"#ffffff",border:"#b45309"};case"info":return o==="dark"?{bg:s.primary,color:"#ffffff",border:s.secondary}:{bg:s.secondary,color:"#ffffff",border:s.primary};default:return o==="dark"?{bg:s.primary,color:"#ffffff",border:s.secondary}:{bg:s.secondary,color:"#ffffff",border:s.primary}}})(n),d=o==="dark"?"0.4":"0.3";t.style.backgroundColor=u.bg,t.style.color=u.color,t.style.border=`1px solid ${u.border}`,t.style.boxShadow=`0 4px 12px rgba(${u.bg.replace("#","").match(/.{2}/g).map(l=>parseInt(l,16)).join(", ")}, ${d})`,setTimeout(()=>{const l=t.querySelector(".snackbar-close");l&&(l.style.color=u.color)},10)}getSnackbarClasses(t){return["fixed","left-1/2","transform","-translate-x-1/2","px-6","py-3","rounded-lg","shadow-lg","max-w-sm","w-full","mx-4","opacity-0","translate-y-4","transition-all","duration-300","ease-out"].join(" ")}getSnackbarContent(t,n,o){const a={success:"✅",error:"❌",warning:"⚠️",info:"ℹ️",default:"💬"},i=d=>{try{return String(d).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}catch{return String(d||"")}},s=i(t),f=o&&o.label?i(o.label):"",u=o&&o.label?`<button class="snackbar-action ml-2 underline font-semibold" aria-label="${f}">${f}</button>`:"";return`
      <div class="flex items-center gap-3">
        <span class="text-lg">${a[n]||a.default}</span>
        <span class="flex-1 text-sm font-medium">${s}</span>
        <span class="snackbar-count hidden text-xs font-bold px-2 py-0.5 rounded bg-black/20">×1</span>
        ${u}
        <button class="snackbar-close text-white opacity-70 hover:opacity-100 transition-opacity" aria-label="Fechar notificação">
          <span class="text-lg">×</span>
        </button>
      </div>
    `}removeExistingSnackbars(){document.querySelectorAll('[data-snackbar="1"]').forEach(n=>{this.removeSnackbar(n)})}incrementCurrentCount(){if(!this._currentEl)return;const t=this._currentEl.querySelector(".snackbar-count");if(!t)return;const o=(parseInt((t.textContent||"1").replace(/[^0-9]/g,""),10)||1)+1;if(t.textContent=`×${o}`,t.classList.remove("hidden"),this._currentEl.querySelector(".flex-1")){const i=this._currentEl.getAttribute("role")||"status";this._currentEl.setAttribute("aria-live",i==="alert"?"assertive":"polite"),this._currentEl.setAttribute("aria-atomic","true")}}removeSnackbar(t){if(!t||!t.parentNode)return;t.classList.remove("snackbar-show"),t.classList.add("snackbar-hide");const n=this.reducedMotion?50:300;setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),this.clearDismissTimer(),this._currentEl=null,this.isShowing=!1,this._lastShownAt=Date.now(),this._lastShownSig=null;try{this._restoreFocusEl&&document.contains(this._restoreFocusEl)&&this._restoreFocusEl.focus?.()}catch{}this.processQueue()},n)}setupEventListeners(t,n){const o=t.querySelector(".snackbar-close");o&&(o.addEventListener("click",()=>{this.removeSnackbar(t)}),t.addEventListener("keydown",i=>{i.key==="Escape"&&this.removeSnackbar(t)}));const a=t.querySelector(".snackbar-action");a&&(a.addEventListener("click",()=>{this.removeSnackbar(t);try{n&&typeof n.onClick=="function"&&n.onClick()}catch{}}),a.addEventListener("keydown",i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),a.click())})),t.addEventListener("click",i=>{i.target===t&&this.removeSnackbar(t)})}clearDismissTimer(){this._currentTimeout&&(clearTimeout(this._currentTimeout),this._currentTimeout=null)}closeCurrent(){this._currentEl&&this.removeSnackbar(this._currentEl)}clearQueue(){this.queue=[]}getStats(){try{return JSON.parse(JSON.stringify(this._stats))}catch{return{totalShown:0,byType:{},last:null}}}resetStats(){this._stats={totalShown:0,byType:Object.create(null),last:null}}}const r=new p;function c(e){typeof e=="string"?r.show(e,"info"):typeof e=="object"&&r.show(e.message,e.type||"info",e.duration,e.action)}c.show=(e,t="info",n,o)=>{r.show(e,t,n,o)};c.success=(e,t)=>{r.show(e,"success",t)};c.error=(e,t)=>{r.show(e,"error",t)};c.warning=(e,t)=>{r.show(e,"warning",t)};c.info=(e,t)=>{r.show(e,"info",t)};c.configure=(e={})=>{typeof e.defaultDuration=="number"&&(r.defaultDuration=e.defaultDuration),typeof e.bottom=="number"&&(r.bottomOffset=e.bottom),typeof e.position=="string"&&(r.position=e.position),typeof e.align=="string"&&(r.align=e.align),typeof e.hoverPause=="boolean"&&(r.hoverPause=e.hoverPause),typeof e.maxQueue=="number"&&(r.maxQueue=Math.max(1,e.maxQueue|0)),typeof e.cooldownMs=="number"&&(r.cooldownMs=Math.max(0,e.cooldownMs|0));try{r.clearDismissTimer(),r.isShowing=!1,r._currentEl=null,r._restoreFocusEl=null,r.queue=[];const t=document?.querySelectorAll?.('[data-snackbar="1"]');t&&t.forEach(n=>n.parentNode&&n.parentNode.removeChild(n))}catch{}try{y()}catch{}};c.clearQueue=()=>{r.clearQueue()};c.closeCurrent=()=>{r.closeCurrent()};c.__getStatsForTest=()=>r.getStats();c.__resetStatsForTest=()=>r.resetStats();function y(){try{if(!h||typeof h.on!="function")return;try{if(h.hasListeners&&h.hasListeners("snackbar:show"))return}catch{}h.on("snackbar:show",e=>{try{if(!e)return;if(typeof e=="string"){r.show(e,"info");return}const{message:t,type:n="info",duration:o,action:a}=e;r.show(t,n,o,a)}catch{}}),h.on("snackbar:configure",e=>{try{c.configure(e||{})}catch{}}),h.on("snackbar:clear",()=>{try{r.clearQueue(),r.closeCurrent()}catch{}}),h.on("snackbar:dismiss",()=>{try{r.closeCurrent()}catch{}}),h.on("snackbar:closeCurrent",()=>{try{r.closeCurrent()}catch{}}),h.on("snackbar:position",e=>{try{if(!e||typeof e!="object")return;typeof e.position=="string"&&(r.position=e.position),typeof e.align=="string"&&(r.align=e.align),typeof e.bottom=="number"&&(r.bottomOffset=e.bottom)}catch{}}),["success","error","warning","info"].forEach(e=>{try{h.on(`snackbar:${e}`,t=>{try{if(!t)return;if(typeof t=="string"){r.show(t,e);return}const{message:n,duration:o,action:a}=t;r.show(n,e,o,a)}catch{}})}catch{}})}catch{}}try{y()}catch{}try{typeof window<"u"&&!window.Snackbar&&(window.Snackbar=c)}catch{}c.close=()=>r.closeCurrent();c.clearQueue=()=>r.clearQueue();typeof window<"u"&&(window.Snackbar=c);c.emit=e=>{try{if(!e)return;typeof e=="string"?c.show(e,"info"):typeof e=="object"&&c.show(e.message||"Notificação",e.type||"info",e.duration,e.action)}catch{}try{h.emit("snackbar:show",e)}catch{}};try{g()}catch{}export{c as Snackbar};

import{e as y}from"./main-B-XVfQ8M.js";import{createPeriodIndicator as w}from"./PeriodIndicator-a2W_bjaH.js";function m(g){const i=document.createElement("nav");i.className="bottom-nav";const b=[{icon:"📊",label:"Dashboard",shortLabel:"Dash",route:"/dashboard"},{icon:"💸",label:"Transações",shortLabel:"Trans",route:"/transactions"},{icon:"📂",label:"Categorias",shortLabel:"Cat",route:"/categories"},{icon:"📈",label:"Análises",shortLabel:"Anál.",route:"/analytics"},{icon:"♻️",label:"Recorrentes",shortLabel:"Rec",route:"/recorrentes"},{icon:"🔔",label:"Notificações",shortLabel:"Notif",route:"/notifications"},{icon:"⚙️",label:"Config",shortLabel:"Conf",route:"/settings"}],h=async(t,e)=>{const a=t.route;console.log(`🔄 Tentando navegar para: ${a}`);const s=document.querySelector(".nav-btn.active");if(s&&s.getAttribute("data-route")===a){console.log(`✅ Já está na aba ${a}`);return}e.style.transform="scale(0.95)",e.style.opacity="0.8";try{document.querySelectorAll(".nav-btn").forEach(n=>{n.classList.remove("active")}),e.classList.add("active"),window.router?(await window.router(a),console.log(`✅ Navegação para ${a} bem-sucedida`)):window.routerNavigate?(await window.routerNavigate(a),console.log(`✅ Navegação (shim) para ${a} bem-sucedida`)):window.location.hash=a,window.updatePageTitle&&window.updatePageTitle(a)}catch(n){console.error(`❌ Erro na navegação para ${a}:`,n),window.location.hash=a,e.style.backgroundColor="#fef2f2",e.style.color="#dc2626",setTimeout(()=>{e.style.backgroundColor="",e.style.color=""},1e3),window.Snackbar&&window.Snackbar({message:"Erro na navegação. Tente novamente.",type:"error"})}finally{setTimeout(()=>{e.style.transform="",e.style.opacity=""},200)}};let c=null;b.forEach(t=>{const e=document.createElement("button");e.className="nav-btn",g===t.route&&e.classList.add("active"),e.setAttribute("data-route",t.route),e.setAttribute("aria-label",t.label);const a=t.route==="/notifications"?`
      <span class="notification-badge absolute -top-1 -right-1 bg-red-500 text-white text-[10px] rounded-full h-4 w-4 sm:h-5 sm:w-5 flex items-center justify-center font-bold leading-none transition-transform duration-200" style="display: none;" aria-live="polite" aria-atomic="true">
        0
      </span>
    `:"",s=t.route==="/settings"?`
      <span class="update-dot absolute -top-0.5 -right-0.5 bg-amber-400 dark:bg-amber-300 rounded-full h-2.5 w-2.5 ring-2 ring-white dark:ring-gray-900" style="display: none;" title="Atualização disponível"></span>
    `:"";e.innerHTML=`
      <span class="tab-indicator"></span>
      <div class="relative w-6 h-6 flex items-center justify-center">
        <span class="text-[20px] leading-none transition-transform duration-200">${t.icon}</span>
        ${a}
        ${s}
      </div>
      <span class="text-[8px] sm:text-[10px] md:text-sm font-medium leading-tight truncate max-w-[40px] sm:max-w-none">${window.innerWidth<640?t.shortLabel:t.label}</span>
    `,e.addEventListener("touchstart",()=>{e.style.transform="scale(0.95)"}),e.addEventListener("touchend",()=>{e.style.transform=""});let n=!1;if(e.addEventListener("click",async o=>{if(o.preventDefault(),n){console.log("🔄 Navegação já em andamento, ignorando clique");return}n=!0;try{await h(t,e)}finally{setTimeout(()=>{n=!1},500)}}),t.route==="/notifications"){const o=e.querySelector(".notification-badge"),r=l=>{try{const d=(Array.isArray(l)?l:Array.isArray(window.appState?.notifications)?window.appState.notifications:[]).filter(u=>!u.read).length;if(!o)return;const p=d>99?"99+":String(d);if(d>0){const u=o.textContent;o.textContent=p,o.style.display="flex",u!==p&&(typeof window.matchMedia=="function"&&window.matchMedia("(prefers-reduced-motion: reduce)").matches||(o.style.transform="scale(1.15)",setTimeout(()=>{try{o.style.transform=""}catch{}},180)))}else o.style.display="none"}catch{}};r(),c=y.on("notifications:updated",r)}if(t.route==="/settings"){const o=e.querySelector(".update-dot"),r=l=>{try{o&&(o.style.display=l?"block":"none")}catch{}};try{r(!!window.__updateAvailable)}catch{}try{y.on("update:available",r)}catch{}}i.appendChild(e)});const f=new MutationObserver(()=>{if(!i.isConnected){try{c&&c()}catch{}try{f.disconnect()}catch{}}});try{f.observe(document.body,{childList:!0,subtree:!0})}catch{}return i}const A=Object.freeze(Object.defineProperty({__proto__:null,BottomNav:m},Symbol.toStringTag,{value:"Module"})),N=Object.freeze(Object.defineProperty({__proto__:null,BottomNav:m,createPeriodIndicator:w},Symbol.toStringTag,{value:"Module"}));export{A as B,N as i};

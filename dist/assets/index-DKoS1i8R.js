const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-BTanfOAJ.js","assets/vendor-7JQXQzuE.js","assets/main-Dc-JefT-.css","assets/index-BBPND-j_.js","assets/PeriodIndicator-BzehPW_n.js"])))=>i.map(i=>d[i]);
import{k as e,_ as t,n as a,K as r,L as n,M as o}from"./main-BTanfOAJ.js";import{N as s,a0 as d,$ as i,Z as l,a4 as c,P as g,a3 as p,a2 as u,V as m,W as x,U as v,R as b,Q as f,T as w,X as h,a1 as y,Y as k,O as S}from"./main-BTanfOAJ.js";import{mountPeriodIndicator as R}from"./PeriodIndicator-BzehPW_n.js";import{calcularNumeroParcela as A,collapseAllDays as $,expandAllDays as E,formatTransactionDisplayDate as M,getCollapsedDays as D,getTransactionDate as F,getTransactionYearMonth as T,isDayCollapsed as N,loadAllOlderMonths as C,loadMonthSection as L,renderAllTransactions as j,renderFilteredTransactions as P,renderMonthSectionHTML as O,renderOlderMonthsControl as I,renderTransactionItemHTML as B,renderTransactions as _,renderTransactionsGroupedByDay as z,saveCollapsedDays as q,toggleDayGroup as U}from"./TransactionsPage-BcbZ5RSW.js";import{renderAllCategories as H,renderCategories as V,renderFilteredCategories as X}from"./CategoriesPage-B4w58uTD.js";import{renderNotifications as Y}from"./NotificationsPage-Da0H1oBs.js";import{closeVoiceModal as G,getVoiceSystem as J,normalizarTexto as W,openVoiceModal as Q,parseNumeroPorExtenso as K,processCategoryVoice as Z,processTransactionVoice as ee,processVoiceCommand as te,startVoiceRecognition as ae}from"./VoiceService-Cv5xWW3Y.js";import{b as re,r as ne,d as oe,a as se,f as de,e as ie,s as le,c as ce}from"./ConfigService-CM2NejyJ.js";import{checkAuthState as ge,logout as pe,setupLoginButton as ue,toggleLoginPage as me}from"./AuthService-VAGA0P9l.js";import"./vendor-7JQXQzuE.js";import"./perf--GZdtUOV.js";import"./NotificationModal-B0WP0Hkb.js";function xe(){const e=window.categoriasEmAlerta||[];0!==e.length?function(e){e.sort((e,t)=>t.percentual-e.percentual);const t=e.map(e=>{const t=e.percentual>=1,a=t?"red":"orange",r=t?"Limite ultrapassado":"PrÃ³ximo do limite";return`\n      <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-600">\n        <div class="flex items-center justify-between mb-3">\n          <div class="flex items-center gap-3">\n            <div class="w-8 h-8 bg-${a}-100 dark:bg-${a}-900 rounded-full flex items-center justify-center">\n              <span class="text-sm">${t?"ğŸš¨":"âš ï¸"}</span>\n            </div>\n            <div>\n              <h5 class="font-semibold text-gray-800 dark:text-gray-200">${e.nome}</h5>\n              <p class="text-xs text-${a}-600 dark:text-${a}-400">${r}</p>\n            </div>\n          </div>\n          <div class="text-right">\n            <div class="text-lg font-bold text-${a}-600 dark:text-${a}-400">\n              ${e.percentualFormatado}\n            </div>\n          </div>\n        </div>\n        \n        \x3c!-- Barra de progresso --\x3e\n        <div class="mb-3">\n          <div class="flex justify-between text-xs text-gray-600 dark:text-gray-400 mb-1">\n            <span>Gasto: R$ ${e.gasto.toFixed(2)}</span>\n            <span>Limite: R$ ${e.limite.toFixed(2)}</span>\n          </div>\n          <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">\n            <div class="bg-${a}-500 h-2 rounded-full transition-all duration-300" \n                 style="width: ${Math.min(100*e.percentual,100)}%"></div>\n          </div>\n        </div>\n        \n        \x3c!-- InformaÃ§Ãµes adicionais --\x3e\n        <div class="text-xs text-gray-500 dark:text-gray-400">\n          ${t?`Ultrapassou o limite em R$ ${(e.gasto-e.limite).toFixed(2)}`:`Restam R$ ${(e.limite-e.gasto).toFixed(2)} do limite`}\n        </div>\n      </div>\n    `}).join(""),a=`\n    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">\n      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-hidden">\n        \x3c!-- Header --\x3e\n        <div class="bg-gradient-to-r from-red-500 to-orange-600 p-4 text-white">\n          <div class="flex items-center justify-between">\n            <div class="flex items-center gap-3">\n              <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">\n                <span class="text-xl">ğŸš¨</span>\n              </div>\n              <div>\n                <h3 class="text-lg font-bold">Categorias em Alerta</h3>\n                <p class="text-red-100 text-sm">${e.length} categoria(s) precisam de atenÃ§Ã£o</p>\n              </div>\n            </div>\n            <button class="close-modal-btn text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors">\n              <span class="text-xl">Ã—</span>\n            </button>\n          </div>\n        </div>\n        \n        \x3c!-- Content --\x3e\n        <div class="p-6 overflow-y-auto max-h-[60vh]">\n          <div class="space-y-4">\n            ${t}\n          </div>\n          \n          \x3c!-- Dica --\x3e\n          <div class="mt-6 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4">\n            <div class="flex items-start gap-3">\n              <span class="text-blue-600 dark:text-blue-400 text-lg">ğŸ’¡</span>\n              <div>\n                <h5 class="font-semibold text-blue-800 dark:text-blue-200 text-sm mb-1">\n                  Dica\n                </h5>\n                <p class="text-blue-700 dark:text-blue-300 text-xs">\n                  Categorias com mais de 70% do limite gasto sÃ£o consideradas em alerta. \n                  Revise seus gastos para evitar ultrapassar os limites.\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        \x3c!-- Footer --\x3e\n        <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4">\n          <button class="close-modal-btn w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors">\n            Fechar\n          </button>\n        </div>\n      </div>\n    </div>\n  `;document.body.insertAdjacentHTML("beforeend",a),be()}(e):function(){const e='\n    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">\n      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden">\n        \x3c!-- Header --\x3e\n        <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-4 text-white">\n          <div class="flex items-center justify-between">\n            <div class="flex items-center gap-3">\n              <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">\n                <span class="text-xl">âœ…</span>\n              </div>\n              <div>\n                <h3 class="text-lg font-bold">Nenhum Alerta</h3>\n                <p class="text-green-100 text-sm">Todas as categorias estÃ£o dentro dos limites</p>\n              </div>\n            </div>\n            <button class="close-modal-btn text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors">\n              <span class="text-xl">Ã—</span>\n            </button>\n          </div>\n        </div>\n        \n        \x3c!-- Content --\x3e\n        <div class="p-6">\n          <div class="text-center">\n            <div class="w-16 h-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4">\n              <span class="text-3xl">ğŸ‰</span>\n            </div>\n            <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-2">\n              ParabÃ©ns!\n            </h4>\n            <p class="text-gray-600 dark:text-gray-400 text-sm">\n              Todas as suas categorias estÃ£o dentro dos limites estabelecidos. \n              Continue controlando seus gastos!\n            </p>\n          </div>\n        </div>\n        \n        \x3c!-- Footer --\x3e\n        <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4">\n          <button class="close-modal-btn w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors">\n            Fechar\n          </button>\n        </div>\n      </div>\n    </div>\n  ';document.body.insertAdjacentHTML("beforeend",e),be()}()}let ve=!1;function be(){document.querySelectorAll(".close-modal-btn").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),fe()},{once:!0})});const e=document.querySelector(".fixed.inset-0");e&&e.addEventListener("click",t=>{t.stopPropagation(),t.target===e&&(t.preventDefault(),t.stopImmediatePropagation(),fe())},{once:!0});const t=e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),fe())};document.addEventListener("keydown",t),window.currentModalEscHandler=t}function fe(){if(ve)return;ve=!0;const e=document.querySelector(".fixed.inset-0");e&&e.remove(),window.currentModalEscHandler&&(document.removeEventListener("keydown",window.currentModalEscHandler),window.currentModalEscHandler=null),setTimeout(()=>{ve=!1},300)}let we=!1;function he(){document.addEventListener("click",e=>{const t=e.target;if("alertas-categorias-btn"===t.id||t.closest("#alertas-categorias-btn")){if(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),we)return;we=!0,xe(),setTimeout(()=>{we=!1},500)}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",he):he();class ye{constructor(){this.draggedElement=null,this.dragOverElement=null,this.cardOrder=this.loadCardOrder(),this.init()}init(){this.setupDragAndDrop(),this.setupExportButtons(),this.setupResetButton()}setupDragAndDrop(){document.querySelectorAll(".draggable-card").forEach(e=>{e.draggable=!0,e.addEventListener("dragstart",t=>{this.draggedElement=e,e.classList.add("dragging"),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/html",e.outerHTML)}),e.addEventListener("dragend",t=>{e.classList.remove("dragging"),this.draggedElement=null,this.dragOverElement=null,document.querySelectorAll(".draggable-card").forEach(e=>{e.classList.remove("drag-over")})}),e.addEventListener("dragover",t=>{t.preventDefault(),t.dataTransfer.dropEffect="move",this.draggedElement&&this.draggedElement!==e&&(this.dragOverElement=e,e.classList.add("drag-over"))}),e.addEventListener("dragleave",t=>{e.contains(t.relatedTarget)||e.classList.remove("drag-over")}),e.addEventListener("drop",t=>{t.preventDefault(),e.classList.remove("drag-over"),this.draggedElement&&this.draggedElement!==e&&this.swapCards(this.draggedElement,e)})})}swapCards(e,t){const a=e.parentNode;Array.from(a.children).indexOf(e)<Array.from(a.children).indexOf(t)?a.insertBefore(e,t.nextSibling):a.insertBefore(e,t),this.saveCardOrder(),this.showNotification("Layout atualizado!","success")}saveCardOrder(){const e=document.querySelectorAll(".draggable-card"),t=Array.from(e).map(e=>e.dataset.cardType);localStorage.setItem("dashboard-card-order",JSON.stringify(t))}loadCardOrder(){const e=localStorage.getItem("dashboard-card-order");return e?JSON.parse(e):["progress","metrics","summary","top-recorrentes","categorias-inteligentes","atividade-recente"]}resetCardOrder(){localStorage.removeItem("dashboard-card-order"),this.showNotification("Layout resetado!","info"),setTimeout(()=>{window.location.reload()},1e3)}setupResetButton(){const e=document.getElementById("reset-layout-btn");e&&e.addEventListener("click",()=>{this.showResetConfirmationModal()})}showResetConfirmationModal(){const e=document.createElement("div");e.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",e.innerHTML='\n      <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4">\n        <div class="flex items-center gap-3 mb-4">\n          <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center">\n            <span class="text-2xl">âš ï¸</span>\n          </div>\n          <div>\n            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">\n              Resetar Layout\n            </h3>\n            <p class="text-sm text-gray-600 dark:text-gray-400">\n              Esta aÃ§Ã£o irÃ¡ reordenar os cards\n            </p>\n          </div>\n        </div>\n        \n        <div class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-6">\n          <h4 class="font-medium text-yellow-800 dark:text-yellow-200 mb-2">O que acontecerÃ¡:</h4>\n          <ul class="text-sm text-yellow-700 dark:text-yellow-300 space-y-1">\n            <li>â€¢ Todos os cards voltarÃ£o Ã  posiÃ§Ã£o original</li>\n            <li>â€¢ Sua personalizaÃ§Ã£o atual serÃ¡ perdida</li>\n            <li>â€¢ A pÃ¡gina serÃ¡ recarregada automaticamente</li>\n          </ul>\n        </div>\n        \n        <div class="flex gap-3">\n          <button id="confirm-reset" class="flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">\n            Sim, Resetar\n          </button>\n          <button id="cancel-reset" class="flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition-colors">\n            Cancelar\n          </button>\n        </div>\n      </div>\n    ',document.body.appendChild(e),e.querySelector("#confirm-reset").addEventListener("click",()=>{document.body.removeChild(e),this.resetCardOrder()}),e.querySelector("#cancel-reset").addEventListener("click",()=>{document.body.removeChild(e)}),e.addEventListener("click",t=>{t.target===e&&document.body.removeChild(e)})}setupExportButtons(){const e=document.getElementById("export-dashboard-btn");e&&e.addEventListener("click",()=>{this.showExportModal()})}showExportModal(){const e=document.createElement("div");e.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",e.innerHTML='\n      <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-lg w-full mx-4">\n        <div class="flex items-center gap-3 mb-4">\n          <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center">\n            <span class="text-2xl">ğŸ“±</span>\n          </div>\n          <div>\n            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">\n              Compartilhar Resumo\n            </h3>\n            <p class="text-sm text-gray-600 dark:text-gray-400">\n              Enviar resumo financeiro via WhatsApp\n            </p>\n          </div>\n        </div>\n        \n        <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 mb-6">\n          <h4 class="font-medium text-green-800 dark:text-green-200 mb-2">O que serÃ¡ compartilhado:</h4>\n          <ul class="text-sm text-green-700 dark:text-green-300 space-y-1">\n            <li>â€¢ ğŸ“Š Progresso do orÃ§amento (porcentagem e valores)</li>\n            <li>â€¢ ğŸ’° MÃ©tricas principais (receitas, despesas, saldo)</li>\n            <li>â€¢ ğŸ“ˆ Resumo detalhado com metas diÃ¡rias</li>\n            <li>â€¢ ğŸ“… PerÃ­odo e data de exportaÃ§Ã£o</li>\n          </ul>\n        </div>\n        \n        <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 mb-6">\n          <p class="text-sm text-blue-700 dark:text-blue-300">\n            <span class="font-medium">ğŸ’¡ Dica:</span> O resumo serÃ¡ formatado de forma organizada e fÃ¡cil de entender, perfeito para compartilhar com familiares ou para controle pessoal.\n          </p>\n        </div>\n        \n        <div class="flex gap-3">\n          <button id="share-whatsapp" class="flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center justify-center gap-2">\n            <span>ğŸ“±</span>\n            Enviar para WhatsApp\n          </button>\n          <button id="close-export-modal" class="flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition-colors">\n            Cancelar\n          </button>\n        </div>\n      </div>\n    ',document.body.appendChild(e),e.querySelector("#share-whatsapp").addEventListener("click",()=>{document.body.removeChild(e),this.shareToWhatsApp("Resumo")}),e.querySelector("#close-export-modal").addEventListener("click",()=>{document.body.removeChild(e)}),e.addEventListener("click",t=>{t.target===e&&document.body.removeChild(e)})}shareToWhatsApp(e="PDF"){this.showNotification("Preparando para compartilhar...","info");const t=this.gatherDashboardData(),a=this.generateWhatsAppMessage(t,e),r=`https://wa.me/?text=${encodeURIComponent(a)}`;window.open(r,"_blank"),this.showNotification("WhatsApp aberto para compartilhamento!","success")}gatherDashboardData(){const e=new Date,t=window.appState&&window.appState.selectedMonth||e.getMonth()+1,a=window.appState&&window.appState.selectedYear||e.getFullYear();return{period:`${["Janeiro","Fevereiro","MarÃ§o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][Math.max(0,Math.min(11,t-1))]||""}/${a}`,progress:this.extractProgressData(),metrics:this.extractMetricsData(),summary:this.extractSummaryData(),exportDate:(new Date).toLocaleString("pt-BR")}}extractProgressData(){const e=document.querySelector('[data-card-type="progress"]');if(!e)return{percentage:"0%",used:"R$ 0,00",total:"R$ 0,00"};const t=e.querySelector(".text-lg.font-bold"),a=e.querySelector(".text-xs.text-gray-600"),r=t?t.textContent.trim():"0%",n=a?a.textContent.trim():"R$ 0,00 de R$ 0,00",[o,s]=n.split(" de ");return{percentage:r,used:o||"R$ 0,00",total:s||"R$ 0,00"}}extractMetricsData(){const e=document.querySelectorAll('[data-card-type="metrics"] .bg-white'),t=[];return e.forEach(e=>{const a=e.querySelector(".text-lg.font-bold"),r=e.querySelector(".text-xs.text-gray-600");a&&r&&t.push({label:r.textContent.trim(),value:a.textContent.trim()})}),t}extractSummaryData(){const e=document.querySelector('[data-card-type="summary"]');if(!e)return{items:[]};const t=[];return e.querySelectorAll(".flex.justify-between.text-xs").forEach(e=>{const a=e.querySelector("span:first-child"),r=e.querySelector("span:last-child");a&&r&&t.push({label:a.textContent.trim(),value:r.textContent.trim()})}),{items:t}}generateWhatsAppMessage(e,t="PDF"){let a=`ğŸ“Š *RESUMO FINANCEIRO - ${e.period}*\n\n`;return a+="ğŸ“ˆ *Progresso do OrÃ§amento:*\n",a+=`â€¢ ${e.progress.percentage} (${e.progress.used} de ${e.progress.total})\n\n`,a+="ğŸ’° *MÃ©tricas:*\n",e.metrics.forEach(e=>{a+=`â€¢ ${e.label}: ${e.value}\n`}),a+="\n",a+="ğŸ“Š *Resumo Detalhado:*\n",e.summary.items.forEach(e=>{a+=`â€¢ ${e.label}: ${e.value}\n`}),a+="\n",a+=`ğŸ“… Exportado em: ${e.exportDate}\n`,a+=`ğŸ“„ Formato: ${t}\n\n`,a+="---\n",a+="ğŸ’¡ Gerado pelo Sistema de Controle Financeiro",a}showNotification(e,t="info"){const a=document.createElement("div");a.className="fixed top-4 right-4 px-4 py-2 rounded-lg text-white z-50 "+("success"===t?"bg-green-500":"error"===t?"bg-red-500":"bg-blue-500"),a.textContent=e,document.body.appendChild(a),setTimeout(()=>{document.body.contains(a)&&document.body.removeChild(a)},3e3)}}let ke=!1,Se=null;function Re(a){try{if(!a){const e=(window.location.hash||"").split("?")[0];if(e&&"#/dashboard"!==e&&"#/"!==e)return}}catch{}var r=a||document.getElementById("app-content");if(r){if(!ke)try{const t=()=>function(){try{Se&&clearTimeout(Se),Se=setTimeout(()=>{Se=null,Re()},50)}catch{}}();e.on("transactions:updated",t),e.on("categories:updated",t),e.on("budget:changed",t),e.on("period:changed",t),e.on("summary:updated",t),e.on("app:ready",t),ke=!0}catch{}var n=new Date;window.appState||(window.appState={});for(var o=window.appState&&window.appState.selectedYear||n.getFullYear(),s=window.appState&&window.appState.selectedMonth||n.getMonth()+1,d=["Janeiro","Fevereiro","MarÃ§o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][Math.max(0,Math.min(11,s-1))]||"",i=String(o)+"-"+String(s).padStart(2,"0"),l=window.appState&&Array.isArray(window.appState.transactions)?window.appState.transactions:[],c=window.appState&&Array.isArray(window.appState.categories)?window.appState.categories:[],g=l.filter(function(e){return yt(ht(e))===i}),p=0,u=0,m=0;m<g.length;m++){var x=g[m],v=kt(null!==x.valor&&void 0!==x.valor?x.valor:x.amount);"receita"===(x.tipo||x.type||"despesa")?p+=Math.abs(v):u+=Math.abs(v)}var b=p-u;g.length;var f=0;try{var w=window.appState&&window.appState.currentBudget;if(w&&w.valorTotal)f=kt(w.valorTotal);else for(var h=0;h<c.length;h++){if(ae=c[h]){var y=kt(ae.limite),k=ae.tipo||"despesa";y>0&&"despesa"===k&&(f+=y)}}}catch{}for(var S=Object.create(null),A=0;A<g.length;A++){var $=g[A];if("despesa"===($.tipo||"despesa")){var E=$.categoriaId||$.categoryId;if(E){var M=Math.abs(kt(null!==$.valor&&void 0!==$.valor?$.valor:$.amount));S[E]=(S[E]||0)+M}}}for(var D=0,F=[],T=0,N=0,C=0;C<c.length;C++){var L=c[C];if(L){var j=kt(L.limite);if(j>0){var P=S[L.id]||0,O=j>0?P/j:0;if("despesa"===(k=L.tipo||"despesa"))T+=j-P,N++;O>=.7&&(D++,F.push({id:L.id,nome:L.nome,gasto:P,limite:j,percentual:O,percentualFormatado:(100*O).toFixed(1)+"%"}))}}}var I=new Date(o,s,0).getDate(),B=(new Date).getDate(),_=Math.max(1,I-B+1),z=T>0?T/_:0,q=p-u,U=q>0?q/_:0,H=.8*q,V=H>0?H/_:0,X={diferencaOrcamentoVsReceitas:z-U,orcamentoMaiorQueReceitas:z>U},Y={receitasVsGastos:u>0?p/u:0,coberturaOrcamento:f>0?Math.min(p/f*100,100):0,deficitOrcamento:Math.max(0,f-p),saldoPositivo:b>0};window.categoriasEmAlerta=F;for(var G=f>0?Math.min(Math.max(u/f,0),1):0,J=Object.create(null),W=0;W<g.length;W++){var Q=g[W];if("despesa"===(Q.tipo||"despesa")){var K=Q.categoriaId||Q.categoryId||Q.categoria&&Q.categoria.id||"sem-categoria",Z=kt(null!==Q.valor&&void 0!==Q.valor?Q.valor:Q.amount);J[K]=(J[K]||0)+Math.abs(Z)}}var ee=[];for(var K in J)if(Object.prototype.hasOwnProperty.call(J,K)){for(var te="Outros",ae=0;ae<c.length;ae++)if(c[ae].id===K){te=c[ae].nome||"Outros";break}ee.push({id:K,nome:te,valor:J[K]})}ee.sort(function(e,t){return t.valor-e.valor}),ee.length>5&&(ee=ee.slice(0,5));var re="";if(re+='<div class="tab-container">',re+='  <div class="tab-header">',re+='    <div class="bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-600">',re+='      <div class="flex items-center justify-between w-full gap-4">',re+="        \x3c!-- TÃ­tulo com Ã­cone e badge --\x3e",re+='        <div class="flex items-center gap-3">',re+='          <div class="flex items-center gap-2">',re+='            <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">',re+='              <span class="text-white text-sm">ğŸ“Š</span>',re+="            </div>",re+="            <div>",re+='              <h2 class="text-gray-800 dark:text-white font-semibold text-base">Dashboard</h2>',re+='              <div class="flex items-center gap-1">',re+='                <span class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span>',re+='                <span class="text-green-600 dark:text-green-400 text-xs">Tempo Real</span>',re+="              </div>",re+="            </div>",re+="          </div>",re+="        </div>",re+="        \x3c!-- Seletor de perÃ­odo integrado --\x3e",re+='        <div id="dash-period-indicator"></div>',re+="      </div>",re+="    </div>",re+="  </div>",re+='  <div class="tab-content">',re+='    <div class="content-spacing">',re+='      <div class="mb-12">',re+='        <div class="flex items-center gap-2 mb-4">',re+='          <div class="w-1 h-6 bg-gradient-to-b from-blue-500 to-green-500 rounded-full"></div>',re+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">ğŸ“Š Resumo</h2>',re+="        </div>",re+='        <div class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-2xl shadow-lg border border-blue-200 dark:border-gray-600 p-4 mb-6">',re+="          \x3c!-- Header Compacto --\x3e",re+='          <div class="flex items-center justify-between mb-4 gap-4">',re+="            <div>",re+='              <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 flex items-center gap-2">',re+='                <span class="text-xl">ğŸ“Š</span>',re+="                Dashboard Financeiro",re+="              </h3>",re+='              <p class="text-sm text-gray-600 dark:text-gray-400">'+d+"/"+o+"</p>",re+="            </div>",re+='            <div class="flex gap-2">',re+='              <button id="export-dashboard-btn" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-3 py-2 rounded-xl text-xs font-semibold transition-all duration-200 flex items-center gap-1.5 shadow-md hover:shadow-lg transform hover:scale-105">',re+='                <span class="text-sm">ğŸ“±</span>',re+='                <span class="hidden sm:inline">Compartilhar</span>',re+="              </button>",re+='              <button id="reset-layout-btn" class="bg-gradient-to-r from-slate-500 to-slate-600 hover:from-slate-600 hover:to-slate-700 text-white px-3 py-2 rounded-xl text-xs font-semibold transition-all duration-200 flex items-center gap-1.5 shadow-md hover:shadow-lg transform hover:scale-105">',re+='                <span class="text-sm">ğŸ”„</span>',re+='                <span class="hidden sm:inline">Resetar</span>',re+="              </button>",re+="            </div>",re+="          </div>",re+="          \x3c!-- Card de Progresso do OrÃ§amento --\x3e",re+='          <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-600 mb-4 draggable-card" data-card-type="progress">',re+='            <div class="drag-handle"></div>',re+='            <div class="flex items-center justify-between mb-2">',re+='              <div class="flex items-center gap-2">',re+='                <span class="text-lg">ğŸ“Š</span>',re+='                <span class="text-sm font-semibold text-gray-700 dark:text-gray-300">Progresso do OrÃ§amento</span>',re+="              </div>",re+='              <div class="text-right">',re+='                <div class="text-lg font-bold '+(G>.7?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400")+'">'+(100*G).toFixed(1)+"%</div>",re+='                <div class="text-xs text-gray-600 dark:text-gray-400">R$ '+St(u)+" de R$ "+St(f)+"</div>",re+="              </div>",re+="            </div>",re+='            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">',re+='              <div class="h-2 rounded-full '+(G>.7?"bg-red-500":"bg-green-500")+'" style="width: '+Math.min(100*G,100)+'%"></div>',re+="            </div>",re+="          </div>",re+="          \x3c!-- MÃ©tricas Compactas --\x3e",re+='          <div class="grid grid-cols-3 gap-3 mb-4 draggable-card" data-card-type="metrics">',re+='            <div class="drag-handle"></div>',re+='            <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">',re+='              <div class="text-lg mb-1">ğŸ’š</div>',re+='              <div class="text-lg font-bold text-green-600 dark:text-green-400">R$ '+St(p)+"</div>",re+='              <div class="text-xs text-gray-600 dark:text-gray-400">Receitas</div>',re+="            </div>",re+='            <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">',re+='              <div class="text-lg mb-1">ğŸ’¸</div>',re+='              <div class="text-lg font-bold text-red-600 dark:text-red-400">R$ '+St(u)+"</div>",re+='              <div class="text-xs text-gray-600 dark:text-gray-400">Despesas</div>',re+="            </div>",re+='                        <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">',re+='              <div class="text-lg mb-1">ğŸ’°</div>',re+='              <div class="text-lg font-bold '+(b>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+'">R$ '+St(b)+"</div>",re+='              <div class="text-xs text-gray-600 dark:text-gray-400">Saldo</div>',re+="            </div>",re+="          </div>",re+="          \x3c!-- Resumo Financeiro Compacto --\x3e",re+='          <div class="bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border border-gray-200 dark:border-gray-600 draggable-card" data-card-type="summary">',re+='            <div class="drag-handle"></div>',re+='            <h5 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-1">',re+="              <span>ğŸ“ˆ</span>",re+="              Resumo Financeiro",re+="            </h5>",re+='            <div class="space-y-2">',re+='              <div class="flex justify-between text-xs bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 p-3 rounded-lg border-l-4 border-blue-500 shadow-sm mb-2">',re+='                <span class="text-blue-800 dark:text-blue-300 font-semibold flex items-center gap-1"><span class="text-base">ğŸ’¡</span> Meta DiÃ¡ria (OrÃ§amento):</span>',re+='                <span class="font-bold text-blue-600 dark:text-blue-400 text-sm">R$ '+St(z)+"/dia</span>",re+="              </div>",re+='              <div class="flex justify-between text-xs bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 p-3 rounded-lg border-l-4 border-green-500 shadow-sm mb-2">',re+='                <span class="text-green-800 dark:text-green-300 font-semibold flex items-center gap-1"><span class="text-base">ğŸ’°</span> Meta DiÃ¡ria (100% Receitas):</span>',re+='                <span class="font-bold '+(U>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+' text-sm">R$ '+St(U)+"/dia</span>",re+="              </div>",re+='              <div class="flex justify-between text-xs bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/30 dark:to-orange-900/30 p-3 rounded-lg border-l-4 border-yellow-500 shadow-sm mb-2">',re+='                <span class="text-yellow-800 dark:text-yellow-300 font-semibold flex items-center gap-1"><span class="text-base">âš ï¸</span> Meta DiÃ¡ria (Conservadora):</span>',re+='                <span class="font-bold '+(V>0?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400")+' text-sm">R$ '+St(V)+"/dia</span>",re+="              </div>",D>0&&(re+='              <div class="flex justify-between text-xs cursor-pointer bg-gradient-to-r from-red-50 to-orange-50 dark:from-red-900/30 dark:to-orange-900/30 hover:from-red-100 hover:to-orange-100 dark:hover:from-red-900/40 dark:hover:to-orange-900/40 p-3 rounded-lg transition-all duration-200 border-l-4 border-red-500 shadow-md hover:shadow-lg animate-pulse" id="alertas-categorias-btn" title="Clique para ver categorias em alerta">',re+='                <span class="text-red-700 dark:text-red-300 font-bold flex items-center gap-1"><span class="text-base">ğŸš¨</span> Alertas Importantes:</span>',re+='                <span class="font-bold text-red-600 dark:text-red-400 text-sm bg-red-100 dark:bg-red-900/50 px-3 py-1 rounded-full">'+D+" categoria(s)</span>",re+="              </div>"),f>0){if(re+='              <div class="border-t border-gray-200 dark:border-gray-600 pt-3 mt-3">',re+='                <div class="text-xs font-bold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-1"><span class="text-base">ğŸ’¡</span> AnÃ¡lise e RecomendaÃ§Ãµes:</div>',Y.coberturaOrcamento>=100?re+='                <div class="text-xs text-green-700 dark:text-green-300 bg-green-50 dark:bg-green-900/20 p-2 rounded-lg border-l-4 border-green-500 mb-2 font-medium"><span class="text-base">âœ…</span> Receitas cobrem 100% do orÃ§amento</div>':Y.coberturaOrcamento>=80?re+='                <div class="text-xs text-yellow-700 dark:text-yellow-300 bg-yellow-50 dark:bg-yellow-900/20 p-2 rounded-lg border-l-4 border-yellow-500 mb-2 font-medium"><span class="text-base">âš ï¸</span> Receitas cobrem '+Y.coberturaOrcamento.toFixed(0)+"% do orÃ§amento</div>":re+='                <div class="text-xs text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border-l-4 border-red-500 mb-2 font-medium"><span class="text-base">âŒ</span> Receitas cobrem apenas '+Y.coberturaOrcamento.toFixed(0)+"% do orÃ§amento</div>",Y.deficitOrcamento>0&&(re+='                <div class="text-xs text-orange-700 dark:text-orange-300 bg-orange-50 dark:bg-orange-900/20 p-2 rounded-lg border-l-4 border-orange-500 mb-2 font-medium"><span class="text-base">ğŸ“Š</span> Faltam receitas: R$ '+St(Y.deficitOrcamento)+"</div>"),re+='                <div class="mt-2 p-2 bg-gray-50 dark:bg-gray-700 rounded text-xs">',re+='                  <div class="font-medium text-gray-700 dark:text-gray-300 mb-1">ğŸ¯ RecomendaÃ§Ãµes:</div>',Y.coberturaOrcamento<100){var ne=f;Math.max(0,ne-p)>0&&(re+='                  <div class="text-blue-600 dark:text-blue-400">â€¢ ğŸ’¡ Considere reduzir limites de categorias ou aumentar receitas</div>')}Y.coberturaOrcamento<80&&(re+='                  <div class="text-orange-600 dark:text-orange-400">â€¢ Considere reduzir limites de categorias</div>'),Y.receitasVsGastos<1&&(re+='                  <div class="text-red-600 dark:text-red-400">â€¢ Controle gastos ou aumente receitas</div>'),re+=X.orcamentoMaiorQueReceitas?'                  <div class="text-orange-600 dark:text-orange-400">â€¢ Meta orÃ§amento Ã© R$ '+St(X.diferencaOrcamentoVsReceitas)+"/dia maior que receitas</div>":'                  <div class="text-green-600 dark:text-green-400">â€¢ Meta orÃ§amento estÃ¡ dentro das receitas</div>',re+='                  <div class="text-blue-700 dark:text-blue-300 text-xs mt-2 p-3 bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 rounded-lg border-l-4 border-blue-500 shadow-sm">',re+='                    <div class="font-bold flex items-center gap-1 mb-1"><span class="text-base">ğŸ”„</span> RecÃ¡lculo DinÃ¢mico:</div>',re+='                    <div class="font-medium">â€¢ Dias restantes: <span class="text-blue-600 dark:text-blue-400 font-bold">'+_+" dias</span></div>",re+='                    <div class="font-medium">â€¢ Gasto mÃ©dio atual: <span class="text-blue-600 dark:text-blue-400 font-bold">R$ '+St(u/(I-_+1))+"/dia</span></div>",re+="                  </div>",Y.saldoPositivo&&Y.coberturaOrcamento>=100&&(re+='                  <div class="text-green-700 dark:text-green-300 bg-green-50 dark:bg-green-900/20 p-2 rounded-lg mt-2 font-bold flex items-center gap-1"><span class="text-base">ğŸ‰</span> Excelente controle financeiro!</div>'),re+="                </div>",re+="              </div>"}re+="            </div>",re+="          </div>",re+="        </div>",re+="      </div>";try{for(var oe=window.appState&&window.appState.currentBudget&&window.appState.currentBudget.id,se=Object.create(null),de=0;de<g.length;de++){var ie=g[de];if("despesa"===(ie.tipo||"despesa"))if((ie.recorrenteId||ie.recorrenteNome)&&(!ie.budgetId||!oe||ie.budgetId===oe)){var le=ie.recorrenteId||"nome:"+(ie.recorrenteNome||"Recorrente"),ce=Math.abs(kt(null!==ie.valor&&void 0!==ie.valor?ie.valor:ie.amount));se[le]||(se[le]={nome:ie.recorrenteNome||"Recorrente",total:0,count:0,parcelaAtual:null,parcelasTotal:null,recId:ie.recorrenteId||null}),se[le].total+=ce,se[le].count+=1;try{if(null!==ie.parcelaAtual&&void 0!==ie.parcelaAtual){var ge=Number(ie.parcelaAtual);!isNaN(ge)&&ge>0&&(se[le].parcelaAtual=Math.max(se[le].parcelaAtual||0,ge))}if(null!==ie.parcelasTotal&&void 0!==ie.parcelasTotal){var pe=Number(ie.parcelasTotal);!isNaN(pe)&&pe>0&&(se[le].parcelasTotal=pe)}if(!se[le].parcelaAtual){var ue=["parcela","parcelaAtual","currentInstallment","installment","parcelaAtualNumero"];for(m=0;m<ue.length;m++){var me=ue[m];if(null!==ie[me]&&void 0!==ie[me]){var xe=Number(ie[me]);if(!isNaN(xe)&&xe>0){se[le].parcelaAtual=Math.max(se[le].parcelaAtual||0,xe);break}}}}if(!se[le].parcelasTotal){var ve=["totalParcelas","parcelasTotal","totalInstallments","installments","parcelasTotalNumero"];for(W=0;W<ve.length;W++){var be=ve[W];if(null!==ie[be]&&void 0!==ie[be]){var fe=Number(ie[be]);if(!isNaN(fe)&&fe>0){se[le].parcelasTotal=fe;break}}}}!se[le].parcelaAtual&&se[le].count>0&&(se[le].parcelaAtual=se[le].count),!se[le].parcelasTotal&&se[le].parcelaAtual&&(1===se[le].count?se[le].parcelasTotal=1:se[le].parcelasTotal=Math.max(2*se[le].parcelaAtual,se[le].count))}catch{}}}var we=[];for(var Ae in se)Object.prototype.hasOwnProperty.call(se,Ae)&&(se[Ae].parcelaAtual||se[Ae].parcelasTotal,we.push({key:Ae,nome:se[Ae].nome,total:se[Ae].total,count:se[Ae].count,parcelaAtual:se[Ae].parcelaAtual,parcelasTotal:se[Ae].parcelasTotal}));if(we.sort(function(e,t){return t.total-e.total}),we.length>5&&(we=we.slice(0,5)),re+='      <div class="mb-12 draggable-card" data-card-type="top-recorrentes">',re+='        <div class="drag-handle"></div>',re+='        <div class="flex items-center justify-between gap-2 mb-6">',re+='          <div class="flex items-center gap-2">',re+='            <div class="w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full"></div>',re+='            <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">â™»ï¸ Top Recorrentes</h2>',re+="          </div>",re+='          <div class="text-sm text-gray-500 dark:text-gray-400">',re+='            <span class="font-medium">'+we.length+"</span> itens",re+="          </div>",re+="        </div>",re+='        <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden">',we.length){re+='          <div class="divide-y divide-gray-100 dark:divide-gray-800">';for(var $e=0;$e<we.length;$e++){var Ee="",Me="",De="emerald",Fe="ğŸ”„",Te="Ativa";try{if(null!==we[$e].parcelaAtual&&void 0!==we[$e].parcelaAtual&&null!==we[$e].parcelasTotal&&void 0!==we[$e].parcelasTotal){var Ne=Number(we[$e].parcelaAtual),Ce=Number(we[$e].parcelasTotal),Le=Ce-Ne,je=Math.round(Ne/Ce*100),Pe="blue";je>=75&&(Pe="yellow"),je>=90&&(Pe="orange"),0===Le&&(Pe="green"),Ee='<span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-'+Pe+"-100 text-"+Pe+"-800 dark:bg-"+Pe+"-900 dark:text-"+Pe+"-200 ml-3 border border-"+Pe+"-200 dark:border-"+Pe+'-700">'+String(Ne)+"/"+String(Ce)+"</span>",Le>0?(je>=90?(De="orange",Fe="âš¡",Te="Quase Finalizada","bg-gradient-to-r from-orange-50 to-yellow-50 dark:from-gray-800 dark:to-gray-800"):je>=75?(De="yellow",Fe="ğŸ“ˆ",Te="Em Andamento","bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-gray-800 dark:to-gray-800"):(De="emerald",Fe="ğŸ”„",Te="Ativa","bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-gray-800 dark:to-gray-800"),'<span class="text-gray-500 dark:text-gray-500 text-xs">'+Ne+" de "+totalParcelas+"</span>",Me='<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 overflow-hidden shadow-inner">',Me+='<div class="bg-gradient-to-r from-'+De+"-400 to-"+De+'-500 h-4 rounded-full transition-all duration-700 ease-out relative flex items-center justify-end pr-2" style="width: '+je+'%">',Me+='<div class="absolute inset-0 bg-white opacity-20 rounded-full"></div>',Me+='<span class="text-xs font-bold text-white relative z-10">'+je+"%</span>",Me+="</div>",Me+="</div>"):0===Le&&(De="green",Fe="âœ…",Te="Finalizada",'<span class="text-green-500 dark:text-green-500 text-xs">'+totalParcelas+" parcelas</span>",Me='<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 overflow-hidden shadow-inner">',Me+='<div class="bg-gradient-to-r from-green-400 to-emerald-500 h-4 rounded-full relative flex items-center justify-end pr-2">',Me+='<div class="absolute inset-0 bg-white opacity-20 rounded-full"></div>',Me+='<span class="text-xs font-bold text-white relative z-10">100%</span>',Me+="</div>",Me+="</div>")}}catch{}re+='            <div class="p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200 border-b border-gray-100 dark:border-gray-800 last:border-b-0">',re+='              <div class="flex items-center justify-between gap-4">',re+='                <div class="flex items-center gap-3 flex-1 min-w-0">',re+='                  <div class="w-10 h-10 rounded-lg flex items-center justify-center text-lg bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-800 dark:to-gray-700 border border-blue-200 dark:border-gray-600">',re+="                    "+Fe,re+="                  </div>",re+='                  <div class="flex-1 min-w-0">',re+='                    <div class="flex items-center gap-2 mb-1">',re+='                      <h3 class="font-semibold text-gray-900 dark:text-gray-100 truncate">'+(we[$e].nome||"Recorrente")+"</h3>",re+="                      "+Ee,re+="                    </div>",re+='                    <div class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400">',re+='                      <span class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded-full">'+String(we[$e].count)+" transaÃ§Ãµes</span>",re+='                      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-'+De+"-100 text-"+De+"-800 dark:bg-"+De+"-900 dark:text-"+De+'-200">',re+="                        "+Te,re+="                      </span>",re+="                    </div>",re+="                  </div>",re+="                </div>",re+='                <div class="text-right">',re+='                  <div class="text-lg font-bold text-gray-900 dark:text-gray-100">R$ '+Number(we[$e].total||0).toFixed(2)+"</div>",re+='                  <div class="text-xs text-gray-500 dark:text-gray-400">total</div>',re+="                </div>",re+="              </div>",re+="              "+(Me?'<div class="mt-3">'+Me+"</div>":""),re+="            </div>"}re+="          </div>"}else re+='          <div class="empty-state p-12 text-center">',re+='            <div class="empty-icon text-6xl mb-6">â™»ï¸</div>',re+='            <div class="empty-text text-xl font-bold mb-3 text-gray-900 dark:text-gray-100">Sem recorrentes neste perÃ­odo</div>',re+='            <div class="empty-description text-gray-500 dark:text-gray-400 mb-6">Despesas recorrentes cadastradas aparecerÃ£o aqui</div>',re+='            <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2 mx-auto">',re+='              <span class="text-lg">â•</span>',re+="              <span>Nova Recorrente</span>",re+="            </button>",re+="          </div>";re+="        </div>",re+="      </div>"}catch{}try{for(var Oe=[],Ie=0;Ie<c.length;Ie++){var Be=c[Ie];if(Be){for(var _e=Be.id,ze=kt(Be.limite),qe=Be.tipo||"despesa",Ue=0,He=0;He<g.length;He++){var Ve=g[He],Xe=(Ve.categoriaId||Ve.categoryId)===_e,Ye="despesa"===(Ve.tipo||"despesa");Xe&&Ye&&(Ue+=Math.abs(kt(null!==Ve.valor&&void 0!==Ve.valor?Ve.valor:Ve.amount)))}Oe.push({id:_e,nome:Be.nome||"Categoria",cor:Be.cor||"#4F46E5",tipo:qe,limite:ze,gasto:Ue})}}N=Oe.filter(function(e){return(e.limite||0)>0&&"despesa"===(e.tipo||"despesa")}).map(function(e){var t=Number(e.limite||0),a=t>0?e.gasto/t*100:0;return{...e,porcentagem:a,temLimite:!0}}).sort(function(e,t){var a=e.gasto>e.limite,r=t.gasto>t.limite;return a&&!r?-1:!a&&r?1:t.porcentagem-e.porcentagem});var Ge=Oe.filter(function(e){return e.gasto>0&&"despesa"===(e.tipo||"despesa")}).map(function(e){return{...e,temLimite:!1}}).sort(function(e,t){return t.gasto-e.gasto}),Je=[],We=new Set;for(m=0;m<Math.min(4,N.length);m++)Je.push(N[m]),We.add(N[m].id);for(W=0;W<Ge.length&&Je.length<6;W++)if(!We.has(Ge[W].id)){var Qe=Ge[W];if((Qe.limite||0)>0){var Ke=Number(Qe.limite||0),Ze=Ke>0?Qe.gasto/Ke*100:0;Qe={...Qe,porcentagem:Ze,temLimite:!0}}Je.push(Qe),We.add(Qe.id)}if(re+='      <div class="mb-12 draggable-card" data-card-type="categorias-inteligentes">',re+='        <div class="drag-handle"></div>',re+='        <div class="flex items-center gap-2 mb-4">',re+='          <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-pink-500 rounded-full"></div>',re+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">ğŸ“Š Categorias Inteligentes</h2>',re+="        </div>",re+='        <div class="u-card overflow-hidden">',re+='          <div class="bg-gradient-to-r from-purple-50 via-blue-50 to-orange-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 p-4 border-b border-gray-200 dark:border-gray-700">',re+='            <div class="flex justify-between items-center gap-4">',re+="              <div>",re+='                <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">ğŸ¯ VisÃ£o Inteligente</h3>',re+='                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Limites prioritÃ¡rios + maiores gastos</p>',re+="              </div>",re+='              <button id="add-category-dashboard-btn" class="btn btn-primary btn-sm">+ Nova</button>',re+="            </div>",re+="          </div>",re+='          <div class="p-4">',0===Je.length)re+='            <div class="empty-state">',re+='              <div class="empty-icon">ğŸ“‚</div>',re+='              <div class="empty-text">Nenhuma categoria encontrada</div>',re+='              <div class="empty-description">Crie categorias e adicione gastos para ver o resumo</div>',re+="            </div>";else for(var et=0;et<Je.length;et++){var tt,at,rt,nt=Je[et],ot=Number(nt.limite||0),st=ot>0?nt.gasto/ot*100:0;if(nt.temLimite)st>=100?(tt="ğŸš¨",at="bg-red-500",rt="EXCEDEU"):st>=90?(tt="âš ï¸",at="bg-red-400",rt="CRÃTICO"):st>=75?(tt="âš¡",at="bg-yellow-500",rt="ALERTA"):st>=50?(tt="ğŸ“Š",at="bg-orange-500",rt="ATENÃ‡ÃƒO"):(tt="âœ…",at="bg-green-500",rt="OK");else{var dt=et+1;1===dt?(tt="ğŸ¥‡",rt="1Âº LUGAR"):2===dt?(tt="ğŸ¥ˆ",rt="2Âº LUGAR"):3===dt?(tt="ğŸ¥‰",rt="3Âº LUGAR"):(tt="ğŸ“ˆ",rt="TOP "+dt),at="bg-blue-500"}if(re+='            <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-3 border border-gray-200 dark:border-gray-700'+(nt.temLimite&&st>=90?" ring-2 ring-red-200 dark:ring-red-800":"")+' mb-3">',re+='              <div class="flex items-center justify-between mb-2 gap-4">',re+='                <div class="flex items-center gap-2">',re+='                  <span class="text-lg">'+tt+"</span>",re+='                  <div class="w-3 h-3 rounded-full" style="background-color: '+nt.cor+'"></div>',re+='                  <span class="font-medium text-sm text-gray-900 dark:text-gray-100">'+nt.nome+"</span>",rt)re+='                  <span class="text-xs px-2 py-1 rounded-full font-medium '+(nt.temLimite&&st>=90?"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300":"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300")+'">'+rt+"</span>";if(re+="                </div>",re+='                <span class="font-bold text-sm '+(nt.temLimite&&nt.gasto>ot?"text-red-600":"text-gray-900 dark:text-gray-100")+'">R$ '+St(nt.gasto)+"</span>",re+="              </div>",nt.temLimite)re+='              <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">',re+="                <span>Limite: R$ "+St(ot)+"</span>",re+='                <span class="'+(st>=100?"text-red-600 font-bold":st>=90?"text-orange-600 font-medium":"")+'">'+st.toFixed(1)+"%</span>",re+="              </div>",re+='              <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">',re+='                <div class="'+at+' h-2 rounded-full transition-all duration-300" style="width: '+Math.min(st,100)+'%"></div>',re+="              </div>",st>=100&&(re+='              <div class="mt-2 text-xs text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 px-2 py-1 rounded">Excedeu em R$ '+St(nt.gasto-ot)+"</div>");else re+='              <p class="text-xs text-gray-500 dark:text-gray-400">Sem limite definido â€¢ PosiÃ§Ã£o por gasto</p>';re+="            </div>"}re+="          </div>",re+="        </div>",re+="      </div>"}catch{}try{var it=g.slice().sort(function(e,t){var a=ht(e)||new Date(0);return(ht(t)||new Date(0))-a}).slice(0,5);if(re+='      <div class="mb-12 draggable-card" data-card-type="atividade-recente">',re+='        <div class="drag-handle"></div>',re+='        <div class="flex items-center justify-between gap-2 mb-6">',re+='          <div class="flex items-center gap-2">',re+='            <div class="w-1 h-6 bg-gradient-to-b from-green-500 to-blue-500 rounded-full"></div>',re+='            <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">ğŸ’³ Atividade Recente</h2>',re+="          </div>",re+='          <div class="text-sm text-gray-500 dark:text-gray-400">',re+='            <span class="font-medium">'+it.length+"</span> transaÃ§Ãµes",re+="          </div>",re+="        </div>",re+='        <div class="u-card overflow-hidden">',re+='          <div class="bg-gradient-to-r from-green-50 to-blue-50 dark:from-gray-800 dark:to-gray-800 p-4 border-b border-gray-200 dark:border-gray-700">',re+='            <div class="flex flex-wrap justify-between items-center gap-2">',re+='              <h3 class="text-lg md:text-xl font-bold text-gray-900 dark:text-gray-100">Ãšltimas TransaÃ§Ãµes</h3>',re+='              <button onclick="window.showAddTransactionModal && window.showAddTransactionModal()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200 shadow-md hover:shadow-lg">',re+="                + Nova TransaÃ§Ã£o",re+="              </button>",re+="            </div>",re+="          </div>",0===it.length)re+='          <div class="empty-state p-8">',re+='            <div class="empty-icon text-4xl mb-4">ğŸ§¾</div>',re+='            <div class="empty-text text-lg font-medium mb-2">Sem transaÃ§Ãµes neste perÃ­odo</div>',re+='            <div class="empty-description text-sm text-gray-500 dark:text-gray-400 mb-4">Adicione transaÃ§Ãµes para acompanhar seus gastos e receitas</div>',re+='            <button class="btn btn-primary" onclick="window.showAddTransactionModal && window.showAddTransactionModal()">Adicionar transaÃ§Ã£o</button>',re+="          </div>";else{re+='          <div class="divide-y divide-gray-100 dark:divide-gray-800">';for(var lt=0;lt<it.length;lt++){var ct=it[lt],gt=c.find(function(e){return e.id===(ct.categoriaId||ct.categoryId)}),pt="receita"===(ct.tipo||"despesa")?"+":"-",ut=Math.abs(kt(null!==ct.valor&&void 0!==ct.valor?ct.valor:ct.amount)),mt=ht(ct),xt=mt?mt.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"",vt="receita"===(ct.tipo||"despesa"),bt="";try{if(ct.recorrenteId&&(ct.parcelaAtual||ct.parcelasTotal)){ge=null!==ct.parcelaAtual&&void 0!==ct.parcelaAtual?ct.parcelaAtual:"",pe=null!==ct.parcelasTotal&&void 0!==ct.parcelasTotal?ct.parcelasTotal:"";(ge||pe)&&(bt='<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 ml-2">'+(ge||"?")+"/"+(pe||"?")+"</span>")}}catch{}var ft=vt?"ğŸ’°":"ğŸ’¸";re+='            <div class="p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200">',re+='              <div class="flex items-start justify-between gap-4">',re+='                <div class="flex items-start gap-3 min-w-0 flex-1">',re+='                  <div class="flex-shrink-0 mt-1">',re+='                    <div class="w-10 h-10 rounded-full flex items-center justify-center text-lg" style="background-color: '+(gt&&gt.cor||"#6B7280")+"20; color: "+(gt&&gt.cor||"#6B7280")+'">',re+="                      "+ft,re+="                    </div>",re+="                  </div>",re+='                  <div class="min-w-0 flex-1">',re+='                    <div class="flex items-center gap-2 mb-1">',re+='                      <h4 class="font-semibold text-gray-900 dark:text-gray-100 truncate">'+(ct.descricao||ct.description||"TransaÃ§Ã£o")+"</h4>",re+="                      "+bt,re+="                    </div>",re+='                    <div class="flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400">',re+='                      <span class="font-medium">'+(gt&&gt.nome||"Sem categoria")+"</span>",re+="                      <span>â€¢</span>",re+="                      <span>"+xt+"</span>",re+="                    </div>",re+="                  </div>",re+="                </div>",re+='                <div class="text-right flex-shrink-0">',re+='                  <div class="text-lg font-bold '+(vt?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+'">'+pt+"R$ "+St(ut)+"</div>",re+='                  <div class="text-xs text-gray-500 dark:text-gray-400">'+(vt?"receita":"despesa")+"</div>",re+="                </div>",re+="              </div>",re+="            </div>"}re+="          </div>"}re+="        </div>",re+="      </div>"}catch{}re+="    </div>",re+="  </div>",re+="</div>",r.innerHTML=re;try{R("#dash-period-indicator")}catch{}try{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new ye}):new ye}catch{}try{window.showCategoriasAlertaModal=async function(){try{const n=new Date,s=window.appState&&window.appState.selectedYear||n.getFullYear(),i=window.appState&&window.appState.selectedMonth||n.getMonth()+1,l=String(s)+"-"+String(i).padStart(2,"0"),c=(Array.isArray(window.appState?.transactions)?window.appState.transactions:[]).filter(function(e){return yt(ht(e))===l}),g=(Array.isArray(window.appState?.categories)?window.appState.categories:[]).filter(function(e){return e&&"despesa"===(e.tipo||"despesa")&&kt(e.limite)>0}).map(function(e){for(var t=0,a=0;a<c.length;a++){var r=c[a];if("despesa"===(r.tipo||"despesa"))(r.categoriaId||r.categoryId)===e.id&&(t+=Math.abs(kt(null!==r.valor&&void 0!==r.valor?r.valor:r.amount)))}var n=kt(e.limite),o=n>0?t/n*100:0;return{id:e.id,nome:e.nome||"Categoria",cor:e.cor||"#4F46E5",limite:n,gasto:t,pct:o}}).filter(function(e){return e.pct>=70}).sort(function(e,t){return t.pct-e.pct});let p='<div class="mb-3 text-xs text-gray-600 dark:text-gray-300">Mostrando categorias com uso do limite â‰¥ 70% em '+d+" "+o+".</div>";if(g.length){p+='<div class="space-y-3">';for(var e=0;e<g.length;e++){var a=g[e],r=a.pct>=100?"bg-red-500":a.pct>=90?"bg-red-400":a.pct>=75?"bg-yellow-500":"bg-orange-500";p+='              <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700">                <div class="flex items-center justify-between mb-2">                  <div class="flex items-center gap-2">                    <div class="w-3 h-3 rounded-full" style="background-color:'+a.cor+'"></div>                    <span class="font-medium text-sm text-gray-900 dark:text-gray-100">'+a.nome+'</span>                  </div>                  <span class="font-bold text-sm '+(a.pct>=100?"text-red-600":a.pct>=90?"text-orange-600":"text-gray-900 dark:text-gray-100")+'">R$ '+St(a.gasto)+'</span>                </div>                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">                  <span>Limite: R$ '+St(a.limite)+"</span>                  <span>"+a.pct.toFixed(1)+'%</span>                </div>                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">                  <div class="'+r+' h-2 rounded-full" style="width:'+Math.min(a.pct,100).toFixed(1)+'%"></div>                </div>                <div class="mt-1 text-[11px] text-gray-500 dark:text-gray-400">Restante: R$ '+St(Math.max(a.limite-a.gasto,0))+"</div>              </div>"}p+="</div>"}else p+='<div class="text-center py-6">            <div class="text-3xl mb-2">âœ…</div>            <div class="text-gray-700 dark:text-gray-200">Nenhuma categoria em alerta</div>          </div>';const{Modal:u}=await t(async()=>{const{Modal:e}=await import("./main-BTanfOAJ.js").then(e=>e.a8);return{Modal:e}},__vite__mapDeps([0,1,2])),m=u({title:"Categorias em alerta",content:p,onClose:function(){try{document.getElementById("app-modal")?.remove()}catch{}}});document.body.appendChild(m)}catch(n){try{alert("Erro ao abrir modal: "+(n?.message||n))}catch{}}}}catch{}he(),setTimeout(()=>{const e=document.getElementById("add-category-dashboard-btn");e&&e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),window.showAddCategoryModal?window.showAddCategoryModal():alert("FunÃ§Ã£o de adicionar categoria nÃ£o estÃ¡ disponÃ­vel")})},100)}function wt(e){try{if(!e)return null;if(e&&"function"==typeof e.toDate)return e.toDate();if(e&&e.seconds)return new Date(1e3*e.seconds);var t=new Date(e);return isNaN(t)?null:t}catch{return null}}function ht(e){if(!e)return null;for(var t=[e.createdAt,e.data,e.date,e.dataTransacao,e.updatedAt],a=0;a<t.length;a++){var r=wt(t[a]);if(r)return r}return null}function yt(e){return e?e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0"):""}function kt(e){try{if(null==e)return 0;if("number"==typeof e)return e;var t=String(e).trim();t=(t=(t=t.replace(/[^0-9,.-]/g,"")).replace(/\.(?=\d{3}(?:\D|$))/g,"")).replace(",",".");var a=parseFloat(t);return isNaN(a)?0:a}catch{return 0}}function St(e){try{return Number(e||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}catch{return Number(e||0).toFixed(2)}}}async function Ae(e){const t=document.createElement("div");t.className="recorrentes-page";const a=document.createElement("div");a.className="tab-header mb-6",a.innerHTML='<h1 class="text-2xl font-semibold text-gray-900 leading-tight">â™»ï¸ Recorrentes</h1>',t.appendChild(a);const r=document.createElement("div");r.className="recorrentes-content",r.innerHTML='\n    <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-6">\n      <div class="flex justify-between items-center mb-6 gap-4">\n        <h3 class="text-lg font-bold text-gray-900 dark:text-white">ğŸ” Gerenciar Recorrentes</h3>\n  <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="btn btn-primary btn-sm">\n          â• Nova Recorrente\n        </button>\n      </div>\n      <div class="text-center py-8">\n        <div class="text-4xl mb-4">â™»ï¸</div>\n        <p class="text-gray-600 dark:text-gray-400">PÃ¡gina de recorrentes em desenvolvimento</p>\n        <p class="text-sm text-gray-500 dark:text-gray-500 mt-2">Carregando recorrentes...</p>\n      </div>\n    </div>\n  ',t.appendChild(r),e&&(e.innerHTML="",e.appendChild(t)),await $e()}async function $e(){try{if("#/recorrentes"!==(window.location.hash||"").split("?")[0])return;const e=Date.now();if(window.__lastRecorrentesRender&&e-window.__lastRecorrentesRender<300)return;window.__lastRecorrentesRender=e,await a();const t=document.getElementById("app-content"),{year:n,month:o}=function(){try{if(window?.appState?.selectedYear&&window?.appState?.selectedMonth)return{year:window.appState.selectedYear,month:window.appState.selectedMonth}}catch{}const e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1}}(),s=window.appState?.currentBudget?.id;let d=window.appState.recorrentes||[];s&&(d=d.filter(e=>e.budgetId===s||!e.budgetId)),d=d.slice().sort((e,t)=>String(e.descricao||e.nome||"").localeCompare(String(t.descricao||t.nome||"")));const i=window.appState.transactions||[],l=["Janeiro","Fevereiro","MarÃ§o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][o-1]||"";let c=d.length,g=0,p=0,u=0,m=0,x=0;for(const a of d){const e=!1!==a.ativa,t=Number(a.valor??0),s=r(a,i,n,o);!!s?.foiEfetivadaEsteMes?(u+=t,g++,m+=t):e&&(!s?.aposUltimaParcela&&!s?.antesDaPrimeiraParcela)&&(u+=t,p++,x+=t)}const v=g+p,b="undefined"!=typeof window&&window.innerWidth<=480?"recorrentes-compact":"";t.innerHTML=`\n      <div class="tab-container ${b}">\n        <div class="tab-header">\n          <div class="bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-600">\n            <div class="flex items-center justify-between w-full gap-4">\n              <div class="flex items-center gap-3">\n                <div class="flex items-center gap-2">\n                  <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center">\n                    <span class="text-white text-sm">â™»ï¸</span>\n                  </div>\n                  <div>\n                    <h2 class="text-gray-800 dark:text-white font-semibold text-base">Recorrentes</h2>\n                    <div class="flex items-center gap-1">\n                      <span class="text-indigo-600 dark:text-indigo-400 text-xs">${d.length} ativos</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div id="rec-period-indicator"></div>\n            </div>\n          </div>\n        </div>\n        <div class="tab-content">\n          <div class="content-spacing">\n            \x3c!-- ========== SEÃ‡ÃƒO 1: RESUMO COMPACTO ========== --\x3e\n            <div class="mb-12">\n              <div class="flex items-center gap-2 mb-4">\n                <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-green-500 rounded-full"></div>\n                <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">â™»ï¸ Resumo</h2>\n              </div>\n              \n              <div class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-2xl shadow-lg border border-blue-200 dark:border-gray-600 p-4 mb-6">\n                \x3c!-- Header Compacto --\x3e\n                <div class="flex items-center justify-between mb-4 gap-4">\n                  <div>\n                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 flex items-center gap-2">\n                      <span class="text-xl">â™»ï¸</span>\n                      Controle de Recorrentes\n                    </h3>\n                    <p class="text-sm text-gray-600 dark:text-gray-400">${c} recorrentes â€¢ ${String(o).padStart(2,"0")}/${n}</p>\n                  </div>\n                  <div class="text-right">\n                    <div class="text-lg font-bold text-purple-600 dark:text-purple-400">\n                      R$ ${u.toFixed(2)}\n                    </div>\n                    <p class="text-xs text-gray-500 dark:text-gray-400">Potencial</p>\n                  </div>\n                </div>\n                \n                \x3c!-- MÃ©tricas Compactas --\x3e\n                <div class="grid grid-cols-3 gap-3 mb-4">\n                  <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">\n                    <div class="text-lg mb-1">âœ…</div>\n                    <div class="text-lg font-bold text-green-600 dark:text-green-400">${g}</div>\n                    <div class="text-xs text-gray-600 dark:text-gray-400">Aplicadas</div>\n                  </div>\n                  \n                  <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">\n                    <div class="text-lg mb-1">â³</div>\n                    <div class="text-lg font-bold text-orange-600 dark:text-orange-400">${p}</div>\n                    <div class="text-xs text-gray-600 dark:text-gray-400">Pendentes</div>\n                  </div>\n                  \n                  <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">\n                    <div class="text-lg mb-1">ğŸŸ¢</div>\n                    <div class="text-lg font-bold text-blue-600 dark:text-blue-400">${v}</div>\n                    <div class="text-xs text-gray-600 dark:text-gray-400">Ativas</div>\n                  </div>\n                </div>\n\n                \x3c!-- Resumo Financeiro Compacto --\x3e\n                <div class="bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border border-gray-200 dark:border-gray-600">\n                  <h5 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-1">\n                    <span>ğŸ’°</span>\n                    Resumo Financeiro\n                  </h5>\n                  <div class="space-y-1">\n                    <div class="flex justify-between text-xs">\n                      <span class="text-gray-600 dark:text-gray-400">Aplicado:</span>\n                      <span class="font-medium text-green-600 dark:text-green-400">R$ ${m.toFixed(2)}</span>\n                    </div>\n                    <div class="flex justify-between text-xs">\n                      <span class="text-gray-600 dark:text-gray-400">Pendente:</span>\n                      <span class="font-medium text-orange-600 dark:text-orange-400">R$ ${x.toFixed(2)}</span>\n                    </div>\n                    <div class="flex justify-between text-xs border-t border-gray-200 dark:border-gray-600 pt-1">\n                      <span class="text-gray-600 dark:text-gray-400">Total:</span>\n                      <span class="font-bold text-purple-600 dark:text-purple-400">\n                        R$ ${u.toFixed(2)}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class="mb-12">\n              <div class="flex items-center gap-2 mb-4">\n                <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-green-500 rounded-full"></div>\n                <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">ğŸ”§ AÃ§Ãµes & Filtros</h2>\n              </div>\n              <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-4 flex flex-col md:flex-row gap-3 md:gap-4 md:items-center md:justify-between">\n                <div class="text-sm text-gray-600 dark:text-gray-400">PerÃ­odo selecionado: <strong>${l}/${n}</strong></div>\n                <div class="flex gap-2">\n                  <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="btn btn-primary btn-sm">â• Nova Recorrente</button>\n                  <button ${0===p?"disabled":""} onclick="window.efetivarRecorrentesMesAtual && window.efetivarRecorrentesMesAtual()" class="btn btn-outline btn-sm" ${0===p?"disabled":""}>\n                    âš¡ Efetivar Pendentes (${p})\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            <div class="mb-12">\n              <div class="flex items-center gap-2 mb-4">\n                <div class="w-1 h-6 bg-gradient-to-b from-green-500 to-teal-500 rounded-full"></div>\n                <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">ğŸ“‹ Lista de Recorrentes</h2>\n              </div>\n              <div id="rec-list" class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-4"></div>\n            </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;try{const e=t.querySelector(".tab-container"),a="__recResizeHandler";window[a]&&window.removeEventListener("resize",window[a]);const r=()=>{e&&(window.innerWidth<=480?e.classList.add("recorrentes-compact"):e.classList.remove("recorrentes-compact"))};window[a]=r,r(),window.addEventListener("resize",r,{passive:!0})}catch{}try{R("#rec-period-indicator")}catch{}const f=document.getElementById("rec-list");try{const e=document.getElementById("rec-summary-toggle"),t=document.getElementById("rec-summary-details");e&&t&&e.addEventListener("click",()=>{t.classList.contains("hidden")?(t.classList.remove("hidden"),e.textContent="Ocultar detalhes"):(t.classList.add("hidden"),e.textContent="Mostrar detalhes")})}catch{}if(d.length){const e=n,t=o,a=d.map(a=>{const n=r(a,i,e,t);if(n?.aposUltimaParcela||n?.antesDaPrimeiraParcela)return null;const o=a.descricao||a.nome||a.name||a.id,s=!1!==a.ativa,d=Number(a.valor??0).toLocaleString("pt-BR",{minimumFractionDigits:2});let l="emerald",c="ğŸ”„",g="Ativa",p="bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-gray-800 dark:to-gray-800",u="",m="",x="emerald",v="from-emerald-400 to-emerald-500",b="";if(n?.temParcelas){const e=n.parcelaAtual||1,t=n.totalParcelas||1,a=Math.round(e/t*100),r=t-e;let o="blue";a>=75&&(o="yellow"),a>=90&&(o="orange"),0===r&&(o="green"),b=`<span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-${o}-100 text-${o}-800 dark:bg-${o}-900 dark:text-${o}-200 ml-3 border border-${o}-200 dark:border-${o}-700">${e}/${t}</span>`,r>0?(a>=90?(l="orange",c="âš¡",g="Quase Finalizada",p="bg-gradient-to-r from-orange-50 to-red-50 dark:from-gray-800 dark:to-gray-800",x="orange",v="from-orange-400 via-orange-500 to-red-500"):a>=75?(l="yellow",c="ğŸ“ˆ",g="Em Andamento",p="bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-gray-800 dark:to-gray-800",x="yellow",v="from-yellow-400 via-yellow-500 to-orange-500"):a>=50?(l="blue",c="ğŸ”„",g="Em Andamento",p="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-800",x="blue",v="from-blue-400 via-blue-500 to-indigo-500"):(l="emerald",c="ğŸ”„",g="Ativa",p="bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-gray-800 dark:to-gray-800",x="emerald",v="from-emerald-400 via-emerald-500 to-teal-500"),m=`<div class="flex items-center justify-between text-sm mb-3">\n              <div class="flex items-center gap-2">\n                <span class="text-gray-600 dark:text-gray-400">${1===r?"1 parcela restante":r+" parcelas restantes"}</span>\n                <span class="w-1 h-1 bg-gray-400 rounded-full"></span>\n                <span class="text-gray-500 dark:text-gray-500 text-xs">${e} de ${t}</span>\n              </div>\n              <span class="font-bold text-${l}-600 dark:text-${l}-400 text-lg">${a}%</span>\n            </div>`,u=`<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-5 overflow-hidden shadow-inner border border-gray-300 dark:border-gray-600">\n              <div class="bg-gradient-to-r ${v} h-5 rounded-full transition-all duration-1000 ease-out relative flex items-center justify-end pr-3 shadow-sm" style="width: ${a}%">\n                <div class="absolute inset-0 bg-white opacity-25 rounded-full"></div>\n                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 rounded-full"></div>\n                <span class="text-xs font-bold text-white relative z-10 drop-shadow-sm">${a}%</span>\n              </div>\n            </div>`):0===r&&(l="green",c="âœ…",g="Finalizada",p="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-gray-800 dark:to-gray-800",x="green",v="from-green-400 via-green-500 to-emerald-500",m=`<div class="flex items-center justify-between text-sm mb-3">\n              <div class="flex items-center gap-2">\n                <span class="text-green-600 dark:text-green-400 font-medium">Recorrente finalizada</span>\n                <span class="w-1 h-1 bg-green-400 rounded-full"></span>\n                <span class="text-green-500 dark:text-green-500 text-xs">${t} parcelas</span>\n              </div>\n              <span class="font-bold text-green-600 dark:text-green-400 text-lg">100%</span>\n            </div>`,u=`<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-5 overflow-hidden shadow-inner border border-gray-300 dark:border-gray-600">\n              <div class="bg-gradient-to-r ${v} h-5 rounded-full relative flex items-center justify-end pr-3 shadow-sm">\n                <div class="absolute inset-0 bg-white opacity-25 rounded-full"></div>\n                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 rounded-full"></div>\n                <span class="text-xs font-bold text-white relative z-10 drop-shadow-sm">100%</span>\n              </div>\n            </div>`)}return`\n          <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden mb-4 hover:shadow-xl transition-all duration-300 group">\n            \x3c!-- Header Principal --\x3e\n            <div class="p-5">\n              <div class="flex items-start justify-between gap-4">\n                \x3c!-- Lado Esquerdo: Ãcone e Nome --\x3e\n                <div class="flex items-center gap-4 flex-1 min-w-0">\n                  <div class="w-14 h-14 rounded-xl flex items-center justify-center text-2xl bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-800 dark:to-gray-700 border border-blue-200 dark:border-gray-600 shadow-sm">\n                    ${c}\n                  </div>\n                  <div class="flex-1 min-w-0">\n                    <h3 class="font-bold text-gray-900 dark:text-gray-100 truncate text-lg mb-2 ${s?"":"line-through opacity-70"}">${o}</h3>\n                    <div class="flex items-center gap-2 flex-wrap">\n                      ${b}\n                      ${n?.foiEfetivadaEsteMes?'<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-bold bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 ml-2">âœ… aplicada</span>':""}\n                    </div>\n                  </div>\n                </div>\n                \n                \x3c!-- Lado Direito: Valor --\x3e\n                <div class="text-right">\n                  <div class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-1">R$ ${d}</div>\n                  <div class="text-xs text-gray-500 dark:text-gray-400 font-medium">valor da parcela</div>\n                </div>\n              </div>\n            </div>\n            \n            \x3c!-- SeÃ§Ã£o de Status e Progresso --\x3e\n            <div class="px-5 pb-4">\n              <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-4">\n                <div class="flex items-center justify-between mb-3">\n                  <span class="text-sm font-semibold text-gray-700 dark:text-gray-300">Status</span>\n                  <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-${l}-100 text-${l}-800 dark:bg-${l}-900 dark:text-${l}-200 border border-${l}-200 dark:border-${l}-700">\n                    ${g}\n                  </span>\n                </div>\n                ${m}\n                ${u}\n              </div>\n            </div>\n            \n            \x3c!-- BotÃµes de AÃ§Ã£o - Design Clean --\x3e\n            <div class="bg-gray-50 dark:bg-gray-800 px-5 py-3 border-t border-gray-200 dark:border-gray-700">\n              <div class="flex items-center justify-end gap-2">\n                <button onclick="window.editRecorrente && window.editRecorrente('${a.id}')" class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 border border-blue-200 dark:border-blue-800 transition-all duration-200" title="Editar recorrente">\n                  <span>âœï¸</span>\n                  <span>Editar</span>\n                </button>\n                <button onclick="window.showHistoricoRecorrente && window.showHistoricoRecorrente('${a.id}')" class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium text-purple-700 dark:text-purple-300 bg-purple-50 dark:bg-purple-900/20 hover:bg-purple-100 dark:hover:bg-purple-900/40 border border-purple-200 dark:border-purple-800 transition-all duration-200" title="Ver histÃ³rico">\n                  <span>ğŸ“Š</span>\n                  <span>HistÃ³rico</span>\n                </button>\n                <button onclick="window.deleteRecorrente && window.deleteRecorrente('${a.id}')" class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/40 border border-red-200 dark:border-red-800 transition-all duration-200" title="Excluir recorrente">\n                  <span>ğŸ—‘ï¸</span>\n                  <span>Excluir</span>\n                </button>\n            </div>\n            </div>\n          </div>\n        `}).filter(Boolean).join("");f.innerHTML=a||'\n        <div class="empty-state p-12 text-center">\n          <div class="empty-icon text-6xl mb-6">ğŸ—“ï¸</div>\n          <div class="empty-text text-xl font-bold mb-3 text-gray-900 dark:text-gray-100">Nenhuma recorrente neste perÃ­odo</div>\n          <div class="empty-description text-gray-500 dark:text-gray-400 mb-6">Altere o perÃ­odo ou crie uma recorrente vÃ¡lida para este mÃªs</div>\n          <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2 mx-auto">\n            <span class="text-lg">â•</span>\n            <span>Nova Recorrente</span>\n          </button>\n        </div>\n      '}else f.innerHTML='\n        <div class="empty-state p-12 text-center">\n          <div class="empty-icon text-6xl mb-6">â™»ï¸</div>\n          <div class="empty-text text-xl font-bold mb-3 text-gray-900 dark:text-gray-100">Nenhuma recorrente cadastrada</div>\n          <div class="empty-description text-gray-500 dark:text-gray-400 mb-6">Crie sua primeira recorrente para automatizar lanÃ§amentos</div>\n          <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2 mx-auto">\n            <span class="text-lg">â•</span>\n            <span>Nova Recorrente</span>\n          </button>\n        </div>\n      '}catch(e){}}try{const t=async()=>{if("#/recorrentes"===(window.location.hash||"").split("?")[0]){try{await a()}catch{}return $e()}};e.on("period:changed",()=>queueMicrotask(()=>t())),e.on("budget:changed",()=>queueMicrotask(()=>t())),e.on("transactions:updated",()=>queueMicrotask(()=>t())),e.on("transaction:added",()=>queueMicrotask(()=>t())),e.on("transaction:updated",()=>queueMicrotask(()=>t())),e.on("transaction:deleted",()=>queueMicrotask(()=>t()))}catch{}function Ee(){try{if(!window.appState||!window.appState.transactions)return void(window.Snackbar?window.Snackbar({message:"Nenhum dado disponÃ­vel para exportar.",type:"warning"}):alert("Nenhum dado disponÃ­vel para exportar."));const e={transactions:window.appState.transactions,categories:window.appState.categories,budgets:window.appState.budgets,recorrentes:window.appState.recorrentes},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download="financeiro-backup.json",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),window.Snackbar&&window.Snackbar({message:"âœ… Backup JSON exportado com sucesso!",type:"success"})}catch(e){window.Snackbar?window.Snackbar({message:"Erro ao exportar backup: "+e.message,type:"error"}):alert("Erro ao exportar backup: "+e.message)}}async function Me(){try{if(void 0===window.XLSX&&await t(()=>import("https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"),[]),!window.appState||!window.appState.transactions)return void(window.Snackbar?window.Snackbar({message:"Nenhum dado disponÃ­vel para exportar.",type:"warning"}):alert("Nenhum dado disponÃ­vel para exportar."));const e=window.XLSX.utils.book_new(),a=window.appState.transactions.map(e=>({"DescriÃ§Ã£o":e.descricao,Valor:e.valor,Tipo:e.tipo,Categoria:window.appState.categories.find(t=>t.id===e.categoriaId)?.nome||"",Data:e.createdAt&&e.createdAt.toDate?e.createdAt.toDate().toLocaleDateString():""}));window.XLSX.utils.book_append_sheet(e,window.XLSX.utils.json_to_sheet(a),"TransaÃ§Ãµes");const r=window.appState.categories.map(e=>({Nome:e.nome,Tipo:e.tipo,Limite:e.limite,Cor:e.cor}));window.XLSX.utils.book_append_sheet(e,window.XLSX.utils.json_to_sheet(r),"Categorias");const n=window.appState.budgets.map(e=>({Nome:e.nome,"DescriÃ§Ã£o":e.descricao,ID:e.id}));window.XLSX.utils.book_append_sheet(e,window.XLSX.utils.json_to_sheet(n),"OrÃ§amentos"),window.XLSX.writeFile(e,"financeiro-dados.xlsx"),window.Snackbar&&window.Snackbar({message:"âœ… Arquivo Excel exportado com sucesso!",type:"success"})}catch(e){window.Snackbar?window.Snackbar({message:"Erro ao exportar Excel: "+e.message,type:"error"}):alert("Erro ao exportar Excel: "+e.message)}}async function De(){try{if(void 0===window.jspdf&&await t(()=>import("https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"),[]),!window.appState||!window.appState.transactions)return void(window.Snackbar?window.Snackbar({message:"Nenhum dado disponÃ­vel para exportar.",type:"warning"}):alert("Nenhum dado disponÃ­vel para exportar."));const{jsPDF:e}=window.jspdf,a=new e;let r=10;a.setFontSize(20),a.setFont("helvetica","bold"),a.text("ğŸ“Š RelatÃ³rio Financeiro",10,r),r+=15;const n=window.appState.currentBudget;n&&(a.setFontSize(14),a.setFont("helvetica","bold"),a.text(`OrÃ§amento: ${n.nome}`,10,r),r+=8,a.setFontSize(10),a.setFont("helvetica","normal"),a.text(`ID: ${n.id}`,10,r),r+=10);const o=window.appState.transactions.filter(e=>"receita"===e.tipo).reduce((e,t)=>e+parseFloat(t.valor),0),s=window.appState.transactions.filter(e=>"despesa"===e.tipo).reduce((e,t)=>e+parseFloat(t.valor),0),d=o-s;a.setFontSize(12),a.setFont("helvetica","bold"),a.text("Resumo Geral:",10,r),r+=8,a.setFontSize(10),a.setFont("helvetica","normal"),a.text(`Total Receitas: R$ ${o.toFixed(2)}`,12,r),r+=6,a.text(`Total Despesas: R$ ${s.toFixed(2)}`,12,r),r+=6,a.setFont("helvetica","bold"),a.text(`Saldo: R$ ${d.toFixed(2)}`,12,r),a.setFontSize(12),a.setFont("helvetica","bold"),a.text("TransaÃ§Ãµes Recentes:",10,r),r+=8,a.setFontSize(9),a.setFont("helvetica","normal"),window.appState.transactions.sort((e,t)=>new Date(t.createdAt?.toDate?.()||t.createdAt)-new Date(e.createdAt?.toDate?.()||e.createdAt)).slice(0,15).forEach(e=>{const t=window.appState.categories.find(t=>t.id===e.categoriaId)?.nome||"Sem categoria",n=`${e.createdAt?.toDate?.()?e.createdAt.toDate().toLocaleDateString():"Data nÃ£o disponÃ­vel"} - ${e.descricao} | R$ ${e.valor} | ${e.tipo} | ${t}`;r>270&&(a.addPage(),r=10),a.text(n,12,r),r+=6}),r+=5,a.setFontSize(12),a.setFont("helvetica","bold"),a.text("Gastos por Categoria:",10,r),r+=8,a.setFontSize(9),a.setFont("helvetica","normal"),window.appState.categories.forEach(e=>{const t=window.appState.transactions.filter(t=>t.categoriaId===e.id&&"despesa"===t.tipo).reduce((e,t)=>e+parseFloat(t.valor),0);if(t>0){const n=e.limite?` / R$ ${e.limite}`:"",o=e.limite?` (${(t/e.limite*100).toFixed(1)}%)`:"";r>270&&(a.addPage(),r=10),a.text(`${e.nome}: R$ ${t.toFixed(2)}${n}${o}`,12,r),r+=6}}),a.save("relatorio-financeiro.pdf"),window.Snackbar&&window.Snackbar({message:"âœ… RelatÃ³rio PDF exportado com sucesso!",type:"success"})}catch(e){window.Snackbar?window.Snackbar({message:"Erro ao exportar PDF: "+e.message,type:"error"}):alert("Erro ao exportar PDF: "+e.message)}}function Fe(){try{let e=function(e,t,r,n=170){return a.splitTextToSize(e,n).forEach(e=>{r>270&&(a.addPage(),r=10),a.text(e,t,r),r+=6}),r};if(void 0===window.jspdf)return void(window.Snackbar?window.Snackbar({message:"Erro: Biblioteca jsPDF nÃ£o estÃ¡ carregada. Tente recarregar a pÃ¡gina.",type:"error"}):alert("Erro: Biblioteca jsPDF nÃ£o estÃ¡ carregada. Tente recarregar a pÃ¡gina."));const{jsPDF:t}=window.jspdf,a=new t;let r=10;a.setFontSize(24),a.setFont("helvetica","bold"),a.setFillColor(79,70,229),a.rect(0,0,210,40,"F"),a.setTextColor(255,255,255),a.text("Controle Financeiro",20,25),a.setFontSize(14),a.text("Guia Completo de Uso",20,35),r=50,a.setFontSize(12),a.setFont("helvetica","bold"),a.setTextColor(0,0,0),r=e("ğŸ¯ Como Usar o Aplicativo",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e("1. FaÃ§a login com sua conta Google",25,r),r=e("2. Crie categorias para organizar suas despesas e receitas",25,r),r=e("3. Adicione transaÃ§Ãµes usando o botÃ£o + ou comandos de voz",25,r),r=e("4. Configure despesas recorrentes para pagamentos fixos",25,r),r=e("5. Monitore seu saldo e gastos no dashboard",25,r),r+=10,a.setFontSize(12),a.setFont("helvetica","bold"),r=e("ğŸ¤ Comandos de Voz DisponÃ­veis",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e('â€¢ "gastei 50 reais no supermercado em alimentaÃ§Ã£o"',25,r),r=e('â€¢ "recebi 2000 de salÃ¡rio em rendimentos"',25,r),r=e('â€¢ "criar categoria alimentaÃ§Ã£o despesa 500"',25,r),r=e('â€¢ "qual meu saldo"',25,r),r=e('â€¢ "mostrar transaÃ§Ãµes"',25,r),r+=10,a.setFontSize(12),a.setFont("helvetica","bold"),r=e("ğŸ“Š Funcionalidades Principais",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e("â€¢ Dashboard com resumo financeiro",25,r),r=e("â€¢ GestÃ£o de transaÃ§Ãµes e categorias",25,r),r=e("â€¢ Sistema de despesas recorrentes",25,r),r=e("â€¢ Alertas de limite de categoria",25,r),r=e("â€¢ Backup e exportaÃ§Ã£o de dados",25,r),r=e("â€¢ Interface responsiva para mobile",25,r),r+=10,a.setFontSize(12),a.setFont("helvetica","bold"),r=e("ğŸ’¾ Backup e ExportaÃ§Ã£o",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e("â€¢ ExportaÃ§Ã£o em JSON para backup completo",25,r),r=e("â€¢ ExportaÃ§Ã£o em Excel para relatÃ³rios",25,r),r=e("â€¢ ExportaÃ§Ã£o em PDF para documentaÃ§Ã£o",25,r),r=e("â€¢ RestauraÃ§Ã£o de dados de backup",25,r),r+=10,a.setFontSize(12),a.setFont("helvetica","bold"),r=e("ğŸ”§ Suporte e Contato",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e("Para dÃºvidas ou problemas:",25,r),r=e("â€¢ Verifique os logs do console (F12)",30,r),r=e("â€¢ Teste em diferentes navegadores",30,r),r=e("â€¢ Consulte a documentaÃ§Ã£o tÃ©cnica",30,r),a.save("guia-servo-tech-financas.pdf"),window.Snackbar&&window.Snackbar({message:"âœ… Guia PDF exportado com sucesso!",type:"success"})}catch(e){window.Snackbar?window.Snackbar({message:"Erro ao exportar guia PDF: "+e.message,type:"error"}):alert("Erro ao exportar guia PDF: "+e.message)}}function Te(){t(async()=>{const{Modal:e}=await import("./index-BBPND-j_.js").then(e=>e.i);return{Modal:e}},__vite__mapDeps([3,0,1,2,4])).then(({Modal:e})=>{e({title:"ğŸ“¤ OpÃ§Ãµes de ExportaÃ§Ã£o",content:'\n        <div class="space-y-4">\n          <button onclick="window.downloadBackup && window.downloadBackup()" class="w-full btn btn-primary btn-sm">\n            <span class="icon-standard">ğŸ’¾</span>\n            Backup JSON Completo\n          </button>\n          <button onclick="window.exportToExcel && window.exportToExcel()" class="w-full btn btn-outline btn-sm">\n            <span class="icon-standard">ğŸ“Š</span>\n            Exportar para Excel\n          </button>\n          <button onclick="window.exportToPDF && window.exportToPDF()" class="w-full btn btn-outline btn-sm">\n            <span class="icon-standard">ğŸ“„</span>\n            Exportar para PDF\n          </button>\n          <button onclick="window.exportReadmePDF && window.exportReadmePDF()" class="w-full btn btn-outline btn-sm">\n            <span class="icon-standard">ğŸ“–</span>\n            Guia de Uso (PDF)\n          </button>\n        </div>\n      '})}).catch(()=>{alert("Abra as opÃ§Ãµes de exportaÃ§Ã£o nas configuraÃ§Ãµes.")})}function Ne(){try{"scrollRestoration"in history&&(history.scrollRestoration="manual")}catch{}const e=["/dashboard","/transactions","/categories","/analytics","/recorrentes","/notifications","/settings"];function t(t){const a=e.indexOf((e=>{const t=(e||"").split("?")[0];return t&&t.startsWith("/")?t:"/dashboard"})(window.location.hash.slice(1)));if(-1===a)return;let r;r="next"===t?(a+1)%e.length:0===a?e.length-1:a-1;const n=e[r];window.location.hash=n,function(e){const t={"/dashboard":"Dashboard","/transactions":"TransaÃ§Ãµes","/categories":"Categorias","/analytics":"AnÃ¡lises","/recorrentes":"Recorrentes","/notifications":"NotificaÃ§Ãµes","/settings":"ConfiguraÃ§Ãµes"}[e]||"Dashboard";document.title=`Financeiro - ${t}`}(n)}document.addEventListener("keydown",e=>{if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName)switch(e.key){case"ArrowLeft":e.preventDefault(),t("prev");break;case"ArrowRight":e.preventDefault(),t("next")}})}async function Ce(){try{if(window.appState?.isInitialized)return;if(window.appState?.currentUser){await async function(){try{const e=window.appState?.currentUser?.uid;if(!e)return;const{loadUserBudgets:a}=await t(async()=>{const{loadUserBudgets:e}=await import("./main-BTanfOAJ.js").then(e=>e.ae);return{loadUserBudgets:e}},__vite__mapDeps([0,1,2]));await a(e);const{selectDefaultBudget:r}=await t(async()=>{const{selectDefaultBudget:e}=await import("./main-BTanfOAJ.js").then(e=>e.ae);return{selectDefaultBudget:e}},__vite__mapDeps([0,1,2]));await r(e),"function"==typeof window.loadTransactions&&await window.loadTransactions(),"function"==typeof window.loadCategories&&await window.loadCategories(),"function"==typeof window.loadRecorrentes&&await window.loadRecorrentes(),"function"==typeof window.loadNotifications&&await window.loadNotifications(),"function"==typeof window.listenNotifications&&await window.listenNotifications(),window.appState.currentBudget?.id&&"function"==typeof window.startAllListeners&&await window.startAllListeners(window.appState.currentBudget.id)}catch(e){}}();try{const a=new Date,r=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,n=localStorage.getItem("recorrentes:lastAutoApplied");if(1===a.getDate()&&n!==r){const a=window.appState?.currentUser?.uid,n=window.appState?.currentBudget?.id;if(a&&n){const{aplicarRecorrentesDoMes:o,loadRecorrentes:s}=await t(async()=>{const{aplicarRecorrentesDoMes:e,loadRecorrentes:t}=await import("./main-BTanfOAJ.js").then(e=>e.a7);return{aplicarRecorrentesDoMes:e,loadRecorrentes:t}},__vite__mapDeps([0,1,2])),d=await o(a,n,!0);"function"==typeof window.loadTransactions&&await window.loadTransactions(),await s();try{e.emit("transactions:updated")}catch{}try{e.emit("categories:updated")}catch{}try{e.emit("recorrentes:updated")}catch{}localStorage.setItem("recorrentes:lastAutoApplied",r),d?.aplicadas>0&&window.Snackbar&&window.Snackbar({message:`Recorrentes do mÃªs aplicadas automaticamente (${d.aplicadas}).`,type:"info"})}}}catch(a){}Le()}}catch(r){}}function Le(){e.on("transaction:added",je),e.on("transaction:updated",Pe),e.on("transaction:deleted",Oe),e.on("category:added",Ie),e.on("category:updated",Be),e.on("category:deleted",_e),e.on("budget:changed",ze)}function je(e){}function Pe(e){}function Oe(e){}function Ie(e){}function Be(e){}function _e(e){}function ze(e){}function qe(e,t="BRL"){if(null==e||isNaN(e))return"R$ 0,00";try{return new Intl.NumberFormat("pt-BR",{style:"currency",currency:t}).format(e)}catch(a){return`R$ ${e.toFixed(2).replace(".",",")}`}}function Ue(e,t={}){if(!e)return"";try{const a={year:"numeric",month:"2-digit",day:"2-digit",...t},r=new Date(e);return isNaN(r.getTime())?"":new Intl.DateTimeFormat("pt-BR",a).format(r)}catch(a){return""}}function He(e,t){return t&&0!==t?Math.round(e/t*100):0}function Ve(e){return e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():""}function Xe(e,t){let a;return function(...r){clearTimeout(a),a=setTimeout(()=>{clearTimeout(a),e(...r)},t)}}function Ye(e,t){let a;return function(){const r=arguments,n=this;a||(e.apply(n,r),a=!0,setTimeout(()=>a=!1,t))}}function Ge(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function Je(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function We(e){return e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():""}function Qe(e,t=50){return!e||e.length<=t?e:e.substring(0,t)+"..."}function Ke(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Ze(e){return Math.round(100*(e+Number.EPSILON))/100}function et(e){const t=[];if(e.descricao&&0!==e.descricao.trim().length?e.descricao.trim().length<3&&t.push("DescriÃ§Ã£o deve ter pelo menos 3 caracteres"):t.push("DescriÃ§Ã£o Ã© obrigatÃ³ria"),!e.valor||isNaN(e.valor)?t.push("Valor deve ser um nÃºmero vÃ¡lido"):e.valor<=0&&t.push("Valor deve ser maior que zero"),e.tipo&&["receita","despesa"].includes(e.tipo)||t.push('Tipo deve ser "receita" ou "despesa"'),e.categoriaId||t.push("Categoria Ã© obrigatÃ³ria"),e.data){const a=new Date(e.data);isNaN(a.getTime())&&t.push("Data deve ser vÃ¡lida")}return{isValid:0===t.length,errors:t}}function tt(e){const t=[];return e.nome&&0!==e.nome.trim().length?e.nome.trim().length<2&&t.push("Nome da categoria deve ter pelo menos 2 caracteres"):t.push("Nome da categoria Ã© obrigatÃ³rio"),e.tipo&&["receita","despesa"].includes(e.tipo)||t.push('Tipo deve ser "receita" ou "despesa"'),void 0!==e.limite&&null!==e.limite&&(isNaN(e.limite)?t.push("Limite deve ser um nÃºmero vÃ¡lido"):e.limite<0&&t.push("Limite nÃ£o pode ser negativo")),e.cor&&!function(e){const t=(new Option).style;return t.color=e,""!==t.color}(e.cor)&&t.push("Cor deve ser um cÃ³digo de cor vÃ¡lido"),{isValid:0===t.length,errors:t}}function at(e){const t=[];return e.nome&&0!==e.nome.trim().length?e.nome.trim().length<3&&t.push("Nome do orÃ§amento deve ter pelo menos 3 caracteres"):t.push("Nome do orÃ§amento Ã© obrigatÃ³rio"),!e.valorTotal||isNaN(e.valorTotal)?t.push("Valor total deve ser um nÃºmero vÃ¡lido"):e.valorTotal<=0&&t.push("Valor total deve ser maior que zero"),e.periodo&&!["mensal","semanal","anual"].includes(e.periodo)&&t.push('PerÃ­odo deve ser "mensal", "semanal" ou "anual"'),{isValid:0===t.length,errors:t}}function rt(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function nt(e){const t=[];return(!e||e.length<6)&&t.push("Senha deve ter pelo menos 6 caracteres"),/[A-Z]/.test(e)||t.push("Senha deve conter pelo menos uma letra maiÃºscula"),/[a-z]/.test(e)||t.push("Senha deve conter pelo menos uma letra minÃºscula"),/\d/.test(e)||t.push("Senha deve conter pelo menos um nÃºmero"),{isValid:0===t.length,errors:t}}function ot(e){if(11!==(e=e.replace(/[^\d]/g,"")).length)return!1;if(/^(\d)\1{10}$/.test(e))return!1;let t=0;for(let o=0;o<9;o++)t+=parseInt(e.charAt(o))*(10-o);let a=t%11,r=a<2?0:11-a;t=0;for(let o=0;o<10;o++)t+=parseInt(e.charAt(o))*(11-o);a=t%11;let n=a<2?0:11-a;return parseInt(e.charAt(9))===r&&parseInt(e.charAt(10))===n}function st(e){return(e=e.replace(/[^\d]/g,"")).length>=10&&e.length<=11}function dt(e){try{const t=window.appState.budgets.find(t=>t.id===e);if(!t)return{receitas:0,despesas:0,saldo:0};const a=window.appState.transactions.filter(t=>t.budgetId===e),r=a.filter(e=>"receita"===e.tipo).reduce((e,t)=>e+(t.valor||0),0),n=a.filter(e=>"despesa"===e.tipo).reduce((e,t)=>e+(t.valor||0),0),o=r-n;return{receitas:pt(r),despesas:pt(n),saldo:pt(o),orcado:t.valorTotal||0}}catch(t){return{receitas:0,despesas:0,saldo:0,orcado:0}}}function it(e,t=null){try{let a=window.appState.transactions.filter(t=>t.budgetId===e);if(t){const e=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0");a=a.filter(t=>(t.data?new Date(t.data).getFullYear()+"-"+String(new Date(t.data).getMonth()+1).padStart(2,"0"):(new Date).getFullYear()+"-"+String((new Date).getMonth()+1).padStart(2,"0"))===e)}const r={};return a.forEach(e=>{const t=e.categoriaId,a=window.appState.categories.find(e=>e.id===t);a&&(r[t]||(r[t]={id:t,nome:a.nome,cor:a.cor,tipo:a.tipo,receitas:0,despesas:0,total:0}),"receita"===e.tipo?r[t].receitas+=e.valor||0:r[t].despesas+=e.valor||0,r[t].total=r[t].receitas-r[t].despesas)}),Object.values(r).map(e=>({...e,receitas:pt(e.receitas),despesas:pt(e.despesas),total:pt(e.total)})).sort((e,t)=>Math.abs(t.total)-Math.abs(e.total))}catch(a){return[]}}function lt(e,t=6){try{const a=[],r=new Date;for(let n=0;n<t;n++){const t=new Date(r.getFullYear(),r.getMonth()-n,1),o=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0"),s=t.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),d=window.appState.transactions.filter(t=>{if(t.budgetId!==e)return!1;if(!t.data)return!1;const a=new Date(t.data);return a.getFullYear()+"-"+String(a.getMonth()+1).padStart(2,"0")===o}),i=d.filter(e=>"receita"===e.tipo).reduce((e,t)=>e+(t.valor||0),0),l=d.filter(e=>"despesa"===e.tipo).reduce((e,t)=>e+(t.valor||0),0),c=i-l;a.push({month:o,monthName:s,receitas:pt(i),despesas:pt(l),saldo:pt(c),transactionCount:d.length})}return a.reverse()}catch(a){return[]}}function ct(e,t=3){try{const a=lt(e,t);if(a.length<2)return{trend:"estavel",percentage:0};const r=a[a.length-1],n=a[a.length-2];if(0===n.saldo)return{trend:"estavel",percentage:0};const o=(r.saldo-n.saldo)/Math.abs(n.saldo)*100;let s="estavel";return o>5?s="crescimento":o<-5&&(s="declinio"),{trend:s,percentage:pt(o),change:pt(r.saldo-n.saldo)}}catch(a){return{trend:"estavel",percentage:0}}}function gt(e,t=3){try{const a=lt(e,t);if(a.length<2)return null;const r=[];for(let e=1;e<a.length;e++){const t=a[e].saldo-a[e-1].saldo;r.push(t)}const n=r.reduce((e,t)=>e+t,0)/r.length,o=a[a.length-1].saldo,s=[];for(let e=1;e<=t;e++){const t=o+n*e;s.push({month:e,projectedSaldo:pt(t),confidence:Math.max(0,100-20*e)})}return s}catch(a){return null}}function pt(e){return Math.round(100*(e+Number.EPSILON))/100}"undefined"!=typeof window&&(window.efetivarRecorrentesMesAtual=async function(){try{const t=window.appState?.currentUser?.uid,r=window.appState?.currentBudget?.id;if(!t||!r)return void(window.Snackbar?window.Snackbar({message:"UsuÃ¡rio ou orÃ§amento nÃ£o encontrado",type:"error"}):alert("UsuÃ¡rio ou orÃ§amento nÃ£o encontrado"));const o=new Date,s=window.appState?.selectedYear||o.getFullYear(),d=window.appState?.selectedMonth||o.getMonth()+1,i=await n(t,r,!0,s,d);"function"==typeof window.loadTransactions&&await window.loadTransactions(),await a(),window.Snackbar&&(i?.aplicadas>0?window.Snackbar({message:`Efetivadas ${i.aplicadas} recorrentes. ${i.pendentes} pendentes.`,type:"success"}):window.Snackbar({message:"Nenhuma recorrente para efetivar neste mÃªs.",type:"info"}));try{const t=window.appState?.currentBudget?.id;e.emit("transactions:updated",{budgetId:t,transactions:window.appState?.transactions||[]})}catch{}try{const t=window.appState?.currentBudget?.id;e.emit("categories:updated",{budgetId:t,categories:window.appState?.categories||[]})}catch{}try{e.emit("recorrentes:updated")}catch{}try{window.renderDashboard&&window.renderDashboard()}catch{}await $e()}catch(t){window.Snackbar?window.Snackbar({message:"Erro ao efetivar recorrentes",type:"error"}):alert("Erro ao efetivar recorrentes")}},window.editRecorrente=function(e){try{const t=(window.appState?.recorrentes||[]).find(t=>t.id===e);if(!t)return void(window.Snackbar?window.Snackbar({message:"Recorrente nÃ£o encontrada",type:"error"}):alert("Recorrente nÃ£o encontrada"));"function"==typeof window.showAddRecorrenteModal&&window.showAddRecorrenteModal(t)}catch(t){}},window.deleteRecorrente=async function(t){const r=window.appState?.currentUser?.uid;if(!r)return void(window.Snackbar?window.Snackbar({message:"UsuÃ¡rio nÃ£o autenticado",type:"error"}):alert("UsuÃ¡rio nÃ£o autenticado"));if("function"!=typeof window.confirm||window.confirm("Excluir esta recorrente?"))try{await o(r,t),await a();try{"function"==typeof window.loadTransactions&&await window.loadTransactions()}catch{}window.Snackbar&&window.Snackbar({message:"Recorrente apagada",type:"success"}),await $e();try{e.emit("recorrentes:updated")}catch{}}catch(n){window.Snackbar?window.Snackbar({message:"Erro ao excluir recorrente",type:"error"}):alert("Erro ao excluir recorrente")}});export{s as addTransactionWithNotifications,d as applyCompactMode,i as applyCurrentTheme,l as applyTheme,c as applyThemeSettings,A as calcularNumeroParcela,dt as calculateBudgetBalance,it as calculateCategoryTotals,lt as calculateMonthlyStats,He as calculatePercentage,gt as calculateProjections,ct as calculateTrends,We as capitalizeFirst,ge as checkAuthState,G as closeVoiceModal,$ as collapseAllDays,Xe as debounce,g as deleteTransactionWithNotifications,Ee as downloadBackup,E as expandAllDays,Fe as exportReadmePDF,Me as exportToExcel,De as exportToPDF,qe as formatCurrency,Ue as formatDate,M as formatTransactionDisplayDate,Ge as generateId,D as getCollapsedDays,p as getCurrentCompactMode,u as getCurrentTheme,F as getTransactionDate,T as getTransactionYearMonth,J as getVoiceSystem,Ce as initializeApp,N as isDayCollapsed,Ke as isNumeric,Je as isValidEmail,m as leaveSharedBudget,C as loadAllOlderMonths,L as loadMonthSection,pe as logout,W as normalizarTexto,Ve as normalizeText,Q as openVoiceModal,K as parseNumeroPorExtenso,Z as processCategoryVoice,ee as processTransactionVoice,te as processVoiceCommand,x as removeUserFromBudget,H as renderAllCategories,j as renderAllTransactions,re as renderBottomNav,V as renderCategories,Re as renderDashboard,ne as renderFAB,X as renderFilteredCategories,P as renderFilteredTransactions,O as renderMonthSectionHTML,Y as renderNotifications,I as renderOlderMonthsControl,Ae as renderRecorrentes,B as renderTransactionItemHTML,_ as renderTransactions,z as renderTransactionsGroupedByDay,oe as resetScrollPosition,Ze as roundToTwoDecimals,q as saveCollapsedDays,v as sendCategoryChangeNotification,b as sendTransactionDeletedNotification,f as sendTransactionNotification,w as sendTransactionUpdatedNotification,se as setupCategoryButtons,de as setupDashboardButtons,Le as setupEventListeners,ie as setupHeaderButtons,ue as setupLoginButton,Ne as setupNavigation,h as setupThemeToggle,le as setupTransactionButtons,Te as showExportOptions,ce as showLoading,ae as startVoiceRecognition,Ye as throttle,y as toggleCompactMode,U as toggleDayGroup,me as toggleLoginPage,k as toggleTheme,Qe as truncateText,S as updateTransactionWithNotifications,at as validateBudget,ot as validateCPF,tt as validateCategory,rt as validateEmail,nt as validatePassword,st as validatePhone,et as validateTransaction};

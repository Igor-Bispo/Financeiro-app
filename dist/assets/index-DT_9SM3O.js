const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-OjaIp7EQ.js","assets/vendor-7JQXQzuE.js","assets/main-CJ6DwGSY.css","assets/index-CoZHK14T.js","assets/PeriodIndicator-CGknNJvc.js"])))=>i.map(i=>d[i]);
import{k as e,_ as t}from"./main-OjaIp7EQ.js";import{N as a,a0 as r,$ as o,Z as n,a4 as s,P as i,a3 as d,a2 as l,V as c,W as g,U as p,R as u,Q as m,T as v,X as x,a1 as b,Y as f,O as h}from"./main-OjaIp7EQ.js";import{mountPeriodIndicator as y}from"./PeriodIndicator-CGknNJvc.js";import{calcularNumeroParcela as w,collapseAllDays as k,expandAllDays as S,formatTransactionDisplayDate as D,getCollapsedDays as A,getTransactionDate as R,getTransactionYearMonth as T,isDayCollapsed as F,loadAllOlderMonths as E,loadMonthSection as C,renderAllTransactions as M,renderFilteredTransactions as $,renderMonthSectionHTML as N,renderOlderMonthsControl as L,renderTransactionItemHTML as j,renderTransactions as O,renderTransactionsGroupedByDay as I,saveCollapsedDays as P,toggleDayGroup as B}from"./TransactionsPage-Bz69yW2z.js";import{renderAllCategories as _,renderCategories as z,renderFilteredCategories as q}from"./CategoriesPage-CbUTxUMT.js";import{renderNotifications as U}from"./NotificationsPage-LRJ1uuMq.js";import{render as V}from"./RecorrentesPage-BviOzZF0.js";import{closeVoiceModal as G,getVoiceSystem as X,normalizarTexto as Y,openVoiceModal as H,parseNumeroPorExtenso as J,processCategoryVoice as W,processTransactionVoice as Q,processVoiceCommand as K,startVoiceRecognition as Z}from"./VoiceService-Di9ZePZc.js";import{b as ee,r as te,d as ae,a as re,f as oe,e as ne,s as se,c as ie}from"./ConfigService-DR3aZRGY.js";import{checkAuthState as de,logout as le,setupLoginButton as ce,toggleLoginPage as ge}from"./AuthService-DCnUDsIo.js";import"./vendor-7JQXQzuE.js";import"./perf--GZdtUOV.js";import"./NotificationModal-B7R6h_Eo.js";function pe(){const e=window.categoriasEmAlerta||[];0!==e.length?function(e){e.sort((e,t)=>t.percentual-e.percentual);const t=e.map(e=>{const t=e.percentual>=1,a=t?"red":"orange",r=t?"Limite ultrapassado":"Pr√≥ximo do limite";return`\n      <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-600">\n        <div class="flex items-center justify-between mb-3">\n          <div class="flex items-center gap-3">\n            <div class="w-8 h-8 bg-${a}-100 dark:bg-${a}-900 rounded-full flex items-center justify-center">\n              <span class="text-sm">${t?"üö®":"‚ö†Ô∏è"}</span>\n            </div>\n            <div>\n              <h5 class="font-semibold text-gray-800 dark:text-gray-200">${e.nome}</h5>\n              <p class="text-xs text-${a}-600 dark:text-${a}-400">${r}</p>\n            </div>\n          </div>\n          <div class="text-right">\n            <div class="text-lg font-bold text-${a}-600 dark:text-${a}-400">\n              ${e.percentualFormatado}\n            </div>\n          </div>\n        </div>\n        \n        \x3c!-- Barra de progresso --\x3e\n        <div class="mb-3">\n          <div class="flex justify-between text-xs text-gray-600 dark:text-gray-400 mb-1">\n            <span>Gasto: R$ ${e.gasto.toFixed(2)}</span>\n            <span>Limite: R$ ${e.limite.toFixed(2)}</span>\n          </div>\n          <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">\n            <div class="bg-${a}-500 h-2 rounded-full transition-all duration-300" \n                 style="width: ${Math.min(100*e.percentual,100)}%"></div>\n          </div>\n        </div>\n        \n        \x3c!-- Informa√ß√µes adicionais --\x3e\n        <div class="text-xs text-gray-500 dark:text-gray-400">\n          ${t?`Ultrapassou o limite em R$ ${(e.gasto-e.limite).toFixed(2)}`:`Restam R$ ${(e.limite-e.gasto).toFixed(2)} do limite`}\n        </div>\n      </div>\n    `}).join(""),a=`\n    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">\n      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-hidden">\n        \x3c!-- Header --\x3e\n        <div class="bg-gradient-to-r from-red-500 to-orange-600 p-4 text-white">\n          <div class="flex items-center justify-between">\n            <div class="flex items-center gap-3">\n              <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">\n                <span class="text-xl">üö®</span>\n              </div>\n              <div>\n                <h3 class="text-lg font-bold">Categorias em Alerta</h3>\n                <p class="text-red-100 text-sm">${e.length} categoria(s) precisam de aten√ß√£o</p>\n              </div>\n            </div>\n            <button class="close-modal-btn text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors">\n              <span class="text-xl">√ó</span>\n            </button>\n          </div>\n        </div>\n        \n        \x3c!-- Content --\x3e\n        <div class="p-6 overflow-y-auto max-h-[60vh]">\n          <div class="space-y-4">\n            ${t}\n          </div>\n          \n          \x3c!-- Dica --\x3e\n          <div class="mt-6 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4">\n            <div class="flex items-start gap-3">\n              <span class="text-blue-600 dark:text-blue-400 text-lg">üí°</span>\n              <div>\n                <h5 class="font-semibold text-blue-800 dark:text-blue-200 text-sm mb-1">\n                  Dica\n                </h5>\n                <p class="text-blue-700 dark:text-blue-300 text-xs">\n                  Categorias com mais de 70% do limite gasto s√£o consideradas em alerta. \n                  Revise seus gastos para evitar ultrapassar os limites.\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        \x3c!-- Footer --\x3e\n        <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4">\n          <button class="close-modal-btn w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors">\n            Fechar\n          </button>\n        </div>\n      </div>\n    </div>\n  `;document.body.insertAdjacentHTML("beforeend",a),me()}(e):function(){const e='\n    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">\n      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden">\n        \x3c!-- Header --\x3e\n        <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-4 text-white">\n          <div class="flex items-center justify-between">\n            <div class="flex items-center gap-3">\n              <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">\n                <span class="text-xl">‚úÖ</span>\n              </div>\n              <div>\n                <h3 class="text-lg font-bold">Nenhum Alerta</h3>\n                <p class="text-green-100 text-sm">Todas as categorias est√£o dentro dos limites</p>\n              </div>\n            </div>\n            <button class="close-modal-btn text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors">\n              <span class="text-xl">√ó</span>\n            </button>\n          </div>\n        </div>\n        \n        \x3c!-- Content --\x3e\n        <div class="p-6">\n          <div class="text-center">\n            <div class="w-16 h-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4">\n              <span class="text-3xl">üéâ</span>\n            </div>\n            <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-2">\n              Parab√©ns!\n            </h4>\n            <p class="text-gray-600 dark:text-gray-400 text-sm">\n              Todas as suas categorias est√£o dentro dos limites estabelecidos. \n              Continue controlando seus gastos!\n            </p>\n          </div>\n        </div>\n        \n        \x3c!-- Footer --\x3e\n        <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4">\n          <button class="close-modal-btn w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors">\n            Fechar\n          </button>\n        </div>\n      </div>\n    </div>\n  ';document.body.insertAdjacentHTML("beforeend",e),me()}()}let ue=!1;function me(){document.querySelectorAll(".close-modal-btn").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),ve()},{once:!0})});const e=document.querySelector(".fixed.inset-0");e&&e.addEventListener("click",t=>{t.stopPropagation(),t.target===e&&(t.preventDefault(),t.stopImmediatePropagation(),ve())},{once:!0});const t=e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),ve())};document.addEventListener("keydown",t),window.currentModalEscHandler=t}function ve(){if(ue)return;ue=!0;const e=document.querySelector(".fixed.inset-0");e&&e.remove(),window.currentModalEscHandler&&(document.removeEventListener("keydown",window.currentModalEscHandler),window.currentModalEscHandler=null),setTimeout(()=>{ue=!1},300)}let xe=!1;function be(){document.addEventListener("click",e=>{const t=e.target;if("alertas-categorias-btn"===t.id||t.closest("#alertas-categorias-btn")){if(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),xe)return;xe=!0,pe(),setTimeout(()=>{xe=!1},500)}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",be):be();class fe{constructor(){this.draggedElement=null,this.dragOverElement=null,this.cardOrder=this.loadCardOrder(),this.init()}init(){this.setupDragAndDrop(),this.setupExportButtons(),this.setupResetButton()}setupDragAndDrop(){document.querySelectorAll(".draggable-card").forEach(e=>{e.draggable=!0,e.addEventListener("dragstart",t=>{this.draggedElement=e,e.classList.add("dragging"),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/html",e.outerHTML)}),e.addEventListener("dragend",t=>{e.classList.remove("dragging"),this.draggedElement=null,this.dragOverElement=null,document.querySelectorAll(".draggable-card").forEach(e=>{e.classList.remove("drag-over")})}),e.addEventListener("dragover",t=>{t.preventDefault(),t.dataTransfer.dropEffect="move",this.draggedElement&&this.draggedElement!==e&&(this.dragOverElement=e,e.classList.add("drag-over"))}),e.addEventListener("dragleave",t=>{e.contains(t.relatedTarget)||e.classList.remove("drag-over")}),e.addEventListener("drop",t=>{t.preventDefault(),e.classList.remove("drag-over"),this.draggedElement&&this.draggedElement!==e&&this.swapCards(this.draggedElement,e)})})}swapCards(e,t){const a=e.parentNode;Array.from(a.children).indexOf(e)<Array.from(a.children).indexOf(t)?a.insertBefore(e,t.nextSibling):a.insertBefore(e,t),this.saveCardOrder(),this.showNotification("Layout atualizado!","success")}saveCardOrder(){const e=document.querySelectorAll(".draggable-card"),t=Array.from(e).map(e=>e.dataset.cardType);localStorage.setItem("dashboard-card-order",JSON.stringify(t))}loadCardOrder(){const e=localStorage.getItem("dashboard-card-order");return e?JSON.parse(e):["progress","metrics","summary","top-recorrentes","categorias-inteligentes","atividade-recente"]}resetCardOrder(){localStorage.removeItem("dashboard-card-order"),this.showNotification("Layout resetado!","info"),setTimeout(()=>{window.location.reload()},1e3)}setupResetButton(){const e=document.getElementById("reset-layout-btn");e&&e.addEventListener("click",()=>{this.showResetConfirmationModal()})}showResetConfirmationModal(){const e=document.createElement("div");e.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",e.innerHTML='\n      <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4">\n        <div class="flex items-center gap-3 mb-4">\n          <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center">\n            <span class="text-2xl">‚ö†Ô∏è</span>\n          </div>\n          <div>\n            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">\n              Resetar Layout\n            </h3>\n            <p class="text-sm text-gray-600 dark:text-gray-400">\n              Esta a√ß√£o ir√° reordenar os cards\n            </p>\n          </div>\n        </div>\n        \n        <div class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-6">\n          <h4 class="font-medium text-yellow-800 dark:text-yellow-200 mb-2">O que acontecer√°:</h4>\n          <ul class="text-sm text-yellow-700 dark:text-yellow-300 space-y-1">\n            <li>‚Ä¢ Todos os cards voltar√£o √† posi√ß√£o original</li>\n            <li>‚Ä¢ Sua personaliza√ß√£o atual ser√° perdida</li>\n            <li>‚Ä¢ A p√°gina ser√° recarregada automaticamente</li>\n          </ul>\n        </div>\n        \n        <div class="flex gap-3">\n          <button id="confirm-reset" class="flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">\n            Sim, Resetar\n          </button>\n          <button id="cancel-reset" class="flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition-colors">\n            Cancelar\n          </button>\n        </div>\n      </div>\n    ',document.body.appendChild(e),e.querySelector("#confirm-reset").addEventListener("click",()=>{document.body.removeChild(e),this.resetCardOrder()}),e.querySelector("#cancel-reset").addEventListener("click",()=>{document.body.removeChild(e)}),e.addEventListener("click",t=>{t.target===e&&document.body.removeChild(e)})}setupExportButtons(){const e=document.getElementById("export-dashboard-btn");e&&e.addEventListener("click",()=>{this.showExportModal()})}showExportModal(){const e=document.createElement("div");e.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",e.innerHTML='\n      <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-lg w-full mx-4">\n        <div class="flex items-center gap-3 mb-4">\n          <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center">\n            <span class="text-2xl">üì±</span>\n          </div>\n          <div>\n            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">\n              Compartilhar Resumo\n            </h3>\n            <p class="text-sm text-gray-600 dark:text-gray-400">\n              Enviar resumo financeiro via WhatsApp\n            </p>\n          </div>\n        </div>\n        \n        <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 mb-6">\n          <h4 class="font-medium text-green-800 dark:text-green-200 mb-2">O que ser√° compartilhado:</h4>\n          <ul class="text-sm text-green-700 dark:text-green-300 space-y-1">\n            <li>‚Ä¢ üìä Progresso do or√ßamento (porcentagem e valores)</li>\n            <li>‚Ä¢ üí∞ M√©tricas principais (receitas, despesas, saldo)</li>\n            <li>‚Ä¢ üìà Resumo detalhado com metas di√°rias</li>\n            <li>‚Ä¢ üìÖ Per√≠odo e data de exporta√ß√£o</li>\n          </ul>\n        </div>\n        \n        <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 mb-6">\n          <p class="text-sm text-blue-700 dark:text-blue-300">\n            <span class="font-medium">üí° Dica:</span> O resumo ser√° formatado de forma organizada e f√°cil de entender, perfeito para compartilhar com familiares ou para controle pessoal.\n          </p>\n        </div>\n        \n        <div class="flex gap-3">\n          <button id="share-whatsapp" class="flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center justify-center gap-2">\n            <span>üì±</span>\n            Enviar para WhatsApp\n          </button>\n          <button id="close-export-modal" class="flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition-colors">\n            Cancelar\n          </button>\n        </div>\n      </div>\n    ',document.body.appendChild(e),e.querySelector("#share-whatsapp").addEventListener("click",()=>{document.body.removeChild(e),this.shareToWhatsApp("Resumo")}),e.querySelector("#close-export-modal").addEventListener("click",()=>{document.body.removeChild(e)}),e.addEventListener("click",t=>{t.target===e&&document.body.removeChild(e)})}shareToWhatsApp(e="PDF"){this.showNotification("Preparando para compartilhar...","info");const t=this.gatherDashboardData(),a=this.generateWhatsAppMessage(t,e),r=`https://wa.me/?text=${encodeURIComponent(a)}`;window.open(r,"_blank"),this.showNotification("WhatsApp aberto para compartilhamento!","success")}gatherDashboardData(){const e=new Date,t=window.appState&&window.appState.selectedMonth||e.getMonth()+1,a=window.appState&&window.appState.selectedYear||e.getFullYear();return{period:`${["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][Math.max(0,Math.min(11,t-1))]||""}/${a}`,progress:this.extractProgressData(),budget:this.extractBudgetInfo(),dailyGoals:this.extractDailyGoals(),analysis:this.extractAnalysis(),exportDate:(new Date).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}}extractProgressData(){const e=document.querySelector('[data-card-type="progress"]');if(!e)return{percentage:"0%",used:"R$ 0,00",total:"R$ 0,00"};const t=e.querySelector(".text-lg.font-bold"),a=e.querySelector(".text-xs.text-gray-600"),r=t?t.textContent.trim():"0%",o=a?a.textContent.trim():"R$ 0,00 de R$ 0,00",[n,s]=o.split(" de ");return{percentage:r,used:n||"R$ 0,00",total:s||"R$ 0,00"}}extractMetricsData(){const e=document.querySelectorAll('[data-card-type="metrics"] .bg-white'),t=[];return e.forEach(e=>{const a=e.querySelector(".text-lg.font-bold"),r=e.querySelector(".text-xs.text-gray-600");a&&r&&t.push({label:r.textContent.trim(),value:a.textContent.trim()})}),t}extractBudgetInfo(){let e="R$ 0,00",t="R$ 0,00",a="R$ 0,00",r="R$ 0,00";document.querySelectorAll('[data-card-type="metrics"] .bg-white').forEach(e=>{const o=e.querySelector(".text-lg.font-bold"),n=e.querySelector(".text-xs.text-gray-600");if(o&&n){const e=n.textContent.trim().toLowerCase(),s=o.textContent.trim();e.includes("receita")?t=s:e.includes("despesa")?a=s:e.includes("saldo")&&(r=s)}});const o=document.querySelector('[data-card-type="progress"]');if(o){const t=o.querySelector(".text-xs.text-gray-600");if(t){const a=t.textContent.trim().match(/de\s*(R\$\s*[\d.,]+)/);a&&(e=a[1].trim())}}return{planned:e,income:t,expenses:a,balance:r}}extractDailyGoals(){const e=document.querySelector('[data-card-type="summary"]');let t="R$ 0,00/dia",a="R$ 0,00/dia",r="R$ 0,00/dia";if(e){const o=e.querySelectorAll(".bg-gradient-to-r");for(let e of o){const o=e.textContent||e.innerText||"";if(o.includes("Meta Di√°ria (Or√ßamento)")){const a=e.querySelector("span.font-bold.text-blue-600, span.font-bold.text-sm");a&&(t=a.textContent.trim())}if(o.includes("Meta Di√°ria (100% Receitas)")){const t=e.querySelector("span.font-bold.text-green-600, span.font-bold.text-red-600, span.font-bold.text-sm");t&&(a=t.textContent.trim())}if(o.includes("Meta Di√°ria (Conservadora)")){const t=e.querySelector("span.font-bold.text-yellow-600, span.font-bold.text-red-600, span.font-bold.text-sm");t&&(r=t.textContent.trim())}}if("R$ 0,00/dia"===t&&"R$ 0,00/dia"===a&&"R$ 0,00/dia"===r){const o=e.querySelectorAll('span[class*="font-bold"]');for(let e of o){const o=e.closest(".flex")?.textContent||e.parentElement?.textContent||"",n=e.textContent.trim();o.includes("Meta Di√°ria (Or√ßamento)")&&n.includes("R$")?t=n:o.includes("Meta Di√°ria (100% Receitas)")&&n.includes("R$")?a=n:o.includes("Meta Di√°ria (Conservadora)")&&n.includes("R$")&&(r=n)}}}return{budget:t,fullIncome:a,conservative:r}}extractAnalysis(){const e=document.querySelector('[data-card-type="summary"]');let t=!1,a=0,r="0",o="0",n=null,s="positive";const i=e?.querySelector("#alertas-categorias-btn .font-bold");i&&i.textContent.includes("categoria")&&(t=!0,a=parseInt(i.textContent.match(/\d+/)?.[0]||"0"),s=a>3?"critical":"warning");const d=new Date,l=d.getFullYear(),c=d.getMonth();o=(new Date(l,c+1,0).getDate()-d.getDate()).toString();const g=this.extractProgressData(),p=parseFloat(g.percentage.replace("%",""));r=Math.round(p).toString(),p>90?s="critical":p>70&&(s="warning");const u=document.querySelector('[data-card-type="categorias-inteligentes"]');if(u){const e=u.querySelector(".categoria-item .font-medium");e&&(n=e.textContent.trim())}return{hasAlerts:t,alerts:a,coverage:r,daysRemaining:o,topCategory:n,status:s}}generateWhatsAppMessage(e,t="PDF"){let a=`üìä *RESUMO FINANCEIRO - ${e.period}*\n\n`;return a+="ÔøΩ *SITUA√á√ÉO ATUAL:*\n",a+=`‚Ä¢ Or√ßamento Total: ${e.budget.planned}\n`,a+=`‚Ä¢ Receitas: ${e.budget.income}\n`,a+=`‚Ä¢ Despesas: ${e.budget.expenses}\n`,a+=`‚Ä¢ Saldo Atual: ${e.budget.balance}\n`,a+=`‚Ä¢ Progresso: ${e.progress.percentage} do or√ßamento usado\n\n`,a+="üéØ *METAS DI√ÅRIAS:*\n",a+=`‚Ä¢ üí° Meta Or√ßamento: ${e.dailyGoals.budget}\n`,a+=`‚Ä¢ üí∞ Meta 100% Receitas: ${e.dailyGoals.fullIncome}\n`,a+=`‚Ä¢ ‚ö†Ô∏è Meta Conservadora: ${e.dailyGoals.conservative}\n\n`,a+="üìà *AN√ÅLISE INTELIGENTE:*\n",e.analysis.hasAlerts&&(a+=`‚Ä¢ üö® ${e.analysis.alerts} categoria(s) em alerta\n`),a+=`‚Ä¢ üìä Cobertura do Or√ßamento: ${e.analysis.coverage}%\n`,a+=`‚Ä¢ üèÉ‚Äç‚ôÄÔ∏è Dias restantes no m√™s: ${e.analysis.daysRemaining}\n`,e.analysis.topCategory&&(a+=`‚Ä¢ üî• Maior gasto: ${e.analysis.topCategory}\n`),a+="\n","positive"===e.analysis.status?(a+="‚úÖ *STATUS: CONTROLADO*\n",a+="üí° Continue assim! Suas finan√ßas est√£o bem organizadas.\n\n"):"warning"===e.analysis.status?(a+="‚ö†Ô∏è *STATUS: ATEN√á√ÉO*\n",a+="üí° Monitore os gastos para n√£o ultrapassar o or√ßamento.\n\n"):(a+="üî¥ *STATUS: CR√çTICO*\n",a+="üí° Considere revisar seus gastos para equilibrar as finan√ßas.\n\n"),a+=`üìÖ Exportado em: ${e.exportDate}\n`,a+=`ÔøΩ Via: ${"Resumo"===t?"App Mobile/Web":t}\n\n`,a+="---\n",a+="üöÄ *Servo Tech - Controle Financeiro*\n",a+="üí° Gerado automaticamente pelo seu assistente financeiro",a}showNotification(e,t="info"){const a=document.createElement("div");a.className="fixed top-4 right-4 px-4 py-2 rounded-lg text-white z-50 "+("success"===t?"bg-green-500":"error"===t?"bg-red-500":"bg-blue-500"),a.textContent=e,document.body.appendChild(a),setTimeout(()=>{document.body.contains(a)&&document.body.removeChild(a)},3e3)}}let he=!1,ye=null;function we(a){try{if(!a){const e=(window.location.hash||"").split("?")[0];if(e&&"#/dashboard"!==e&&"#/"!==e)return}}catch{}var r=a||document.getElementById("app-content");if(r){if(!he)try{const t=()=>function(){try{ye&&clearTimeout(ye),ye=setTimeout(()=>{ye=null,we()},50)}catch{}}();e.on("transactions:updated",t),e.on("categories:updated",t),e.on("budget:changed",t),e.on("period:changed",t),e.on("summary:updated",t),e.on("app:ready",t),he=!0}catch{}var o=new Date;window.appState||(window.appState={});for(var n=window.appState&&window.appState.selectedYear||o.getFullYear(),s=window.appState&&window.appState.selectedMonth||o.getMonth()+1,i=["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][Math.max(0,Math.min(11,s-1))]||"",d=String(n)+"-"+String(s).padStart(2,"0"),l=window.appState&&Array.isArray(window.appState.transactions)?window.appState.transactions:[],c=window.appState&&Array.isArray(window.appState.categories)?window.appState.categories:[],g=l.filter(function(e){return Dt(St(e))===d}),p=0,u=0,m=0;m<g.length;m++){var v=g[m],x=At(null!==v.valor&&void 0!==v.valor?v.valor:v.amount);"receita"===(v.tipo||v.type||"despesa")?p+=Math.abs(x):u+=Math.abs(x)}var b=p-u,f=0;try{var h=window.appState&&window.appState.currentBudget;if(h&&h.valorTotal)f=At(h.valorTotal);else for(var w=0;w<c.length;w++){if(ne=c[w]){var k=At(ne.limite),S=ne.tipo||"despesa";k>0&&"despesa"===S&&(f+=k)}}}catch{}for(var D=Object.create(null),A=0;A<g.length;A++){var R=g[A];if("despesa"===(R.tipo||"despesa")){var T=R.categoriaId||R.categoryId;if(T){var F=Math.abs(At(null!==R.valor&&void 0!==R.valor?R.valor:R.amount));D[T]=(D[T]||0)+F}}}for(var E=0,C=[],M=0,$=0;$<c.length;$++){var N=c[$];if(N){var L=At(N.limite);if(L>0){var j=D[N.id]||0,O=L>0?j/L:0;"despesa"===(S=N.tipo||"despesa")&&M++,O>=.7&&(E++,C.push({id:N.id,nome:N.nome,gasto:j,limite:L,percentual:O,percentualFormatado:(100*O).toFixed(1)+"%"}))}}}var I,P=new Date(n,s,0).getDate(),B=new Date,_=B.getMonth()+1,z=B.getFullYear();I=n===z&&s===_?B.getDate():n<z||n===z&&s<_?P:1;var q=Math.max(1,P-I+1),U=f-u,V=U>0?U/q:0,G=p-u,X=G>0?G/q:0,Y=.8*G,H=Y>0?Y/q:0,J={diferencaOrcamentoVsReceitas:V-X,orcamentoMaiorQueReceitas:V>X},W={receitasVsGastos:u>0?p/u:0,coberturaOrcamento:f>0?Math.min(p/f*100,100):0,deficitOrcamento:Math.max(0,f-p),saldoPositivo:b>0};window.categoriasEmAlerta=C;for(var Q=f>0?Math.min(Math.max(u/f,0),1):0,K=Object.create(null),Z=0;Z<g.length;Z++){var ee=g[Z];if("despesa"===(ee.tipo||"despesa")){var te=ee.categoriaId||ee.categoryId||ee.categoria&&ee.categoria.id||"sem-categoria",ae=At(null!==ee.valor&&void 0!==ee.valor?ee.valor:ee.amount);K[te]=(K[te]||0)+Math.abs(ae)}}var re=[];for(var te in K)if(Object.prototype.hasOwnProperty.call(K,te)){for(var oe="Outros",ne=0;ne<c.length;ne++)if(c[ne].id===te){oe=c[ne].nome||"Outros";break}re.push({id:te,nome:oe,valor:K[te]})}re.sort(function(e,t){return t.valor-e.valor}),re.length>5&&(re=re.slice(0,5));var se="";if(se+='<div class="tab-container">',se+='  <div class="tab-header">',se+='    <div class="bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-600">',se+='      <div class="flex items-center justify-between w-full gap-4">',se+="        \x3c!-- T√≠tulo com √≠cone e badge --\x3e",se+='        <div class="flex items-center gap-3">',se+='          <div class="flex items-center gap-2">',se+='            <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">',se+='              <span class="text-white text-sm">üìä</span>',se+="            </div>",se+="            <div>",se+='              <h2 class="text-gray-800 dark:text-white font-semibold text-base">Dashboard</h2>',se+='              <div class="flex items-center gap-1">',se+='                <span class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span>',se+='                <span class="text-green-600 dark:text-green-400 text-xs">Tempo Real</span>',se+="              </div>",se+="            </div>",se+="          </div>",se+="        </div>",se+="        \x3c!-- Seletor de per√≠odo integrado --\x3e",se+='        <div id="dash-period-indicator"></div>',se+="      </div>",se+="    </div>",se+="  </div>",se+='  <div class="tab-content">',se+='    <div class="content-spacing">',se+='      <div class="mb-12">',se+='        <div class="flex items-center gap-2 mb-4">',se+='          <div class="w-1 h-6 bg-gradient-to-b from-blue-500 to-green-500 rounded-full"></div>',se+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üìä Resumo</h2>',se+="        </div>",se+='        <div class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-2xl shadow-lg border border-blue-200 dark:border-gray-600 p-4 mb-6">',se+="          \x3c!-- Header Compacto --\x3e",se+='          <div class="flex items-center justify-between mb-4 gap-4">',se+="            <div>",se+='              <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 flex items-center gap-2">',se+='                <span class="text-xl">üìä</span>',se+="                Dashboard Financeiro",se+="              </h3>",se+='              <p class="text-sm text-gray-600 dark:text-gray-400">'+i+"/"+n+"</p>",se+="            </div>",se+='            <div class="flex gap-2">',se+='              <button id="export-dashboard-btn" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-3 py-2 rounded-xl text-xs font-semibold transition-all duration-200 flex items-center gap-1.5 shadow-md hover:shadow-lg transform hover:scale-105">',se+='                <span class="text-sm">üì±</span>',se+='                <span class="hidden sm:inline">Compartilhar</span>',se+="              </button>",se+='              <button id="reset-layout-btn" class="bg-gradient-to-r from-slate-500 to-slate-600 hover:from-slate-600 hover:to-slate-700 text-white px-3 py-2 rounded-xl text-xs font-semibold transition-all duration-200 flex items-center gap-1.5 shadow-md hover:shadow-lg transform hover:scale-105">',se+='                <span class="text-sm">üîÑ</span>',se+='                <span class="hidden sm:inline">Resetar</span>',se+="              </button>",se+="            </div>",se+="          </div>",se+="          \x3c!-- Card de Progresso do Or√ßamento --\x3e",se+='          <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-600 mb-4 draggable-card" data-card-type="progress">',se+='            <div class="drag-handle"></div>',se+='            <div class="flex items-center justify-between mb-2">',se+='              <div class="flex items-center gap-2">',se+='                <span class="text-lg">üìä</span>',se+='                <span class="text-sm font-semibold text-gray-700 dark:text-gray-300">Progresso do Or√ßamento</span>',se+="              </div>",se+='              <div class="text-right">',se+='                <div class="text-lg font-bold '+(Q>.7?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400")+'">'+(100*Q).toFixed(1)+"%</div>",se+='                <div class="text-xs text-gray-600 dark:text-gray-400">R$ '+Rt(u)+" de R$ "+Rt(f)+"</div>",se+="              </div>",se+="            </div>",se+='            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">',se+='              <div class="h-2 rounded-full '+(Q>.7?"bg-red-500":"bg-green-500")+'" style="width: '+Math.min(100*Q,100)+'%"></div>',se+="            </div>",se+="          </div>",se+="          \x3c!-- M√©tricas Compactas --\x3e",se+='          <div class="grid grid-cols-3 gap-3 mb-4 draggable-card" data-card-type="metrics">',se+='            <div class="drag-handle"></div>',se+='            <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">',se+='              <div class="text-lg mb-1">üíö</div>',se+='              <div class="text-lg font-bold text-green-600 dark:text-green-400">R$ '+Rt(p)+"</div>",se+='              <div class="text-xs text-gray-600 dark:text-gray-400">Receitas</div>',se+="            </div>",se+='            <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">',se+='              <div class="text-lg mb-1">üí∏</div>',se+='              <div class="text-lg font-bold text-red-600 dark:text-red-400">R$ '+Rt(u)+"</div>",se+='              <div class="text-xs text-gray-600 dark:text-gray-400">Despesas</div>',se+="            </div>",se+='            <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">',se+='              <div class="text-lg mb-1">üí∞</div>',se+='              <div class="text-lg font-bold '+(b>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+'">R$ '+Rt(b)+"</div>",se+='              <div class="text-xs text-gray-600 dark:text-gray-400">Saldo</div>',se+="            </div>",se+="          </div>",se+="          \x3c!-- Resumo Financeiro Compacto --\x3e",se+='          <div class="bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border border-gray-200 dark:border-gray-600 draggable-card" data-card-type="summary">',se+='            <div class="drag-handle"></div>',se+='            <h5 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-1">',se+="              <span>üìà</span>",se+="              Resumo Financeiro",se+="            </h5>",se+='            <div class="space-y-2">',se+='              <div class="flex justify-between text-xs bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 p-3 rounded-lg border-l-4 border-blue-500 shadow-sm mb-2">',se+='                <span class="text-blue-800 dark:text-blue-300 font-semibold flex items-center gap-1"><span class="text-base">üí°</span> Meta Di√°ria (Or√ßamento):</span>',se+='                <span class="font-bold text-blue-600 dark:text-blue-400 text-sm">R$ '+Rt(V)+"/dia</span>",se+="              </div>",se+='              <div class="flex justify-between text-xs bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 p-3 rounded-lg border-l-4 border-green-500 shadow-sm mb-2">',se+='                <span class="text-green-800 dark:text-green-300 font-semibold flex items-center gap-1"><span class="text-base">üí∞</span> Meta Di√°ria (100% Receitas):</span>',se+='                <span class="font-bold '+(X>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+' text-sm">R$ '+Rt(X)+"/dia</span>",se+="              </div>",se+='              <div class="flex justify-between text-xs bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/30 dark:to-orange-900/30 p-3 rounded-lg border-l-4 border-yellow-500 shadow-sm mb-2">',se+='                <span class="text-yellow-800 dark:text-yellow-300 font-semibold flex items-center gap-1"><span class="text-base">‚ö†Ô∏è</span> Meta Di√°ria (Conservadora):</span>',se+='                <span class="font-bold '+(H>0?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400")+' text-sm">R$ '+Rt(H)+"/dia</span>",se+="              </div>",E>0&&(se+='              <div class="flex justify-between text-xs cursor-pointer bg-gradient-to-r from-red-50 to-orange-50 dark:from-red-900/30 dark:to-orange-900/30 hover:from-red-100 hover:to-orange-100 dark:hover:from-red-900/40 dark:hover:to-orange-900/40 p-3 rounded-lg transition-all duration-200 border-l-4 border-red-500 shadow-md hover:shadow-lg animate-pulse" id="alertas-categorias-btn" title="Clique para ver categorias em alerta">',se+='                <span class="text-red-700 dark:text-red-300 font-bold flex items-center gap-1"><span class="text-base">üö®</span> Alertas Importantes:</span>',se+='                <span class="font-bold text-red-600 dark:text-red-400 text-sm bg-red-100 dark:bg-red-900/50 px-3 py-1 rounded-full">'+E+" categoria(s)</span>",se+="              </div>"),f>0){if(se+='              <div class="border-t border-gray-200 dark:border-gray-600 pt-3 mt-3">',se+='                <div class="text-xs font-bold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-1"><span class="text-base">üí°</span> An√°lise e Recomenda√ß√µes:</div>',W.coberturaOrcamento>=100?se+='                <div class="text-xs text-green-700 dark:text-green-300 bg-green-50 dark:bg-green-900/20 p-2 rounded-lg border-l-4 border-green-500 mb-2 font-medium"><span class="text-base">‚úÖ</span> Receitas cobrem 100% do or√ßamento</div>':W.coberturaOrcamento>=80?se+='                <div class="text-xs text-yellow-700 dark:text-yellow-300 bg-yellow-50 dark:bg-yellow-900/20 p-2 rounded-lg border-l-4 border-yellow-500 mb-2 font-medium"><span class="text-base">‚ö†Ô∏è</span> Receitas cobrem '+W.coberturaOrcamento.toFixed(0)+"% do or√ßamento</div>":se+='                <div class="text-xs text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border-l-4 border-red-500 mb-2 font-medium"><span class="text-base">‚ùå</span> Receitas cobrem apenas '+W.coberturaOrcamento.toFixed(0)+"% do or√ßamento</div>",W.deficitOrcamento>0&&(se+='                <div class="text-xs text-orange-700 dark:text-orange-300 bg-orange-50 dark:bg-orange-900/20 p-2 rounded-lg border-l-4 border-orange-500 mb-2 font-medium"><span class="text-base">üìä</span> Faltam receitas: R$ '+Rt(W.deficitOrcamento)+"</div>"),se+='                <div class="mt-2 p-2 bg-gray-50 dark:bg-gray-700 rounded text-xs">',se+='                  <div class="font-medium text-gray-700 dark:text-gray-300 mb-1">üéØ Recomenda√ß√µes:</div>',W.coberturaOrcamento<100){var ie=f;Math.max(0,ie-p)>0&&(se+='                  <div class="text-blue-600 dark:text-blue-400">‚Ä¢ üí° Considere reduzir limites de categorias ou aumentar receitas</div>')}W.coberturaOrcamento<80&&(se+='                  <div class="text-orange-600 dark:text-orange-400">‚Ä¢ Considere reduzir limites de categorias</div>'),W.receitasVsGastos<1&&(se+='                  <div class="text-red-600 dark:text-red-400">‚Ä¢ Controle gastos ou aumente receitas</div>'),se+=J.orcamentoMaiorQueReceitas?'                  <div class="text-orange-600 dark:text-orange-400">‚Ä¢ Meta or√ßamento √© R$ '+Rt(J.diferencaOrcamentoVsReceitas)+"/dia maior que receitas</div>":'                  <div class="text-green-600 dark:text-green-400">‚Ä¢ Meta or√ßamento est√° dentro das receitas</div>',se+='                  <div class="text-blue-700 dark:text-blue-300 text-xs mt-2 p-3 bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 rounded-lg border-l-4 border-blue-500 shadow-sm">',se+='                    <div class="font-bold flex items-center gap-1 mb-1"><span class="text-base">üîÑ</span> Rec√°lculo Din√¢mico:</div>',se+='                    <div class="font-medium">‚Ä¢ Dias restantes: <span class="text-blue-600 dark:text-blue-400 font-bold">'+q+" dias</span></div>",se+='                    <div class="font-medium">‚Ä¢ Gasto m√©dio atual: <span class="text-blue-600 dark:text-blue-400 font-bold">R$ '+Rt(u/(P-q+1))+"/dia</span></div>",se+="                  </div>",W.saldoPositivo&&W.coberturaOrcamento>=100&&(se+='                  <div class="text-green-700 dark:text-green-300 bg-green-50 dark:bg-green-900/20 p-2 rounded-lg mt-2 font-bold flex items-center gap-1"><span class="text-base">üéâ</span> Excelente controle financeiro!</div>'),se+="                </div>",se+="              </div>"}se+="            </div>",se+="          </div>",se+="        </div>",se+="      </div>";try{for(var de=window.appState&&window.appState.currentBudget&&window.appState.currentBudget.id,le=Object.create(null),ce=0;ce<g.length;ce++){var ge=g[ce];if("despesa"===(ge.tipo||"despesa"))if((ge.recorrenteId||ge.recorrenteNome)&&(!ge.budgetId||!de||ge.budgetId===de)){var pe=ge.recorrenteId||"nome:"+(ge.recorrenteNome||"Recorrente"),ue=Math.abs(At(null!==ge.valor&&void 0!==ge.valor?ge.valor:ge.amount));le[pe]||(le[pe]={nome:ge.recorrenteNome||"Recorrente",total:0,count:0,parcelaAtual:null,parcelasTotal:null,recId:ge.recorrenteId||null}),le[pe].total+=ue,le[pe].count+=1;try{if(null!==ge.parcelaAtual&&void 0!==ge.parcelaAtual){var me=Number(ge.parcelaAtual);!isNaN(me)&&me>0&&(le[pe].parcelaAtual=Math.max(le[pe].parcelaAtual||0,me))}if(null!==ge.parcelasTotal&&void 0!==ge.parcelasTotal){var ve=Number(ge.parcelasTotal);!isNaN(ve)&&ve>0&&(le[pe].parcelasTotal=ve)}if(!le[pe].parcelaAtual){var xe=["parcela","parcelaAtual","currentInstallment","installment","parcelaAtualNumero"];for(m=0;m<xe.length;m++){var ke=xe[m];if(null!==ge[ke]&&void 0!==ge[ke]){var Se=Number(ge[ke]);if(!isNaN(Se)&&Se>0){le[pe].parcelaAtual=Math.max(le[pe].parcelaAtual||0,Se);break}}}}if(!le[pe].parcelasTotal){var De=["totalParcelas","parcelasTotal","totalInstallments","installments","parcelasTotalNumero"];for(Z=0;Z<De.length;Z++){var Ae=De[Z];if(null!==ge[Ae]&&void 0!==ge[Ae]){var Re=Number(ge[Ae]);if(!isNaN(Re)&&Re>0){le[pe].parcelasTotal=Re;break}}}}!le[pe].parcelaAtual&&le[pe].count>0&&(le[pe].parcelaAtual=le[pe].count),!le[pe].parcelasTotal&&le[pe].parcelaAtual&&(1===le[pe].count?le[pe].parcelasTotal=1:le[pe].parcelasTotal=Math.max(2*le[pe].parcelaAtual,le[pe].count))}catch{}}}var Te=[];for(var Fe in le)Object.prototype.hasOwnProperty.call(le,Fe)&&(le[Fe].parcelaAtual||le[Fe].parcelasTotal,Te.push({key:Fe,nome:le[Fe].nome,total:le[Fe].total,count:le[Fe].count,parcelaAtual:le[Fe].parcelaAtual,parcelasTotal:le[Fe].parcelasTotal}));if(Te.sort(function(e,t){return t.total-e.total}),Te.length>5&&(Te=Te.slice(0,5)),se+='      <div class="mb-12 draggable-card" data-card-type="top-recorrentes">',se+='        <div class="drag-handle"></div>',se+='        <div class="flex items-center justify-between gap-2 mb-6">',se+='          <div class="flex items-center gap-2">',se+='            <div class="w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full"></div>',se+='            <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">‚ôªÔ∏è Top Recorrentes</h2>',se+="          </div>",se+='          <div class="text-sm text-gray-500 dark:text-gray-400">',se+='            <span class="font-medium">'+Te.length+"</span> itens",se+="          </div>",se+="        </div>",se+='        <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden">',Te.length){se+='          <div class="divide-y divide-gray-100 dark:divide-gray-800">';for(var Ee=0;Ee<Te.length;Ee++){var Ce="",Me="",$e="emerald",Ne="üîÑ",Le="Ativa";try{if(null!==Te[Ee].parcelaAtual&&void 0!==Te[Ee].parcelaAtual&&null!==Te[Ee].parcelasTotal&&void 0!==Te[Ee].parcelasTotal){var je=Number(Te[Ee].parcelaAtual),Oe=Number(Te[Ee].parcelasTotal),Ie=Oe-je,Pe=Math.round(je/Oe*100),Be="blue";Pe>=75&&(Be="yellow"),Pe>=90&&(Be="orange"),0===Ie&&(Be="green"),Ce='<span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-'+Be+"-100 text-"+Be+"-800 dark:bg-"+Be+"-900 dark:text-"+Be+"-200 ml-3 border border-"+Be+"-200 dark:border-"+Be+'-700">'+String(je)+"/"+String(Oe)+"</span>",Ie>0?(Pe>=90?($e="orange",Ne="‚ö°",Le="Quase Finalizada"):Pe>=75?($e="yellow",Ne="üìà",Le="Em Andamento"):($e="emerald",Ne="üîÑ",Le="Ativa"),Me='<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 overflow-hidden shadow-inner">',Me+='<div class="bg-gradient-to-r from-'+$e+"-400 to-"+$e+'-500 h-4 rounded-full transition-all duration-700 ease-out relative flex items-center justify-end pr-2" style="width: '+Pe+'%">',Me+='<div class="absolute inset-0 bg-white opacity-20 rounded-full"></div>',Me+='<span class="text-xs font-bold text-white relative z-10">'+Pe+"%</span>",Me+="</div>",Me+="</div>"):0===Ie&&($e="green",Ne="‚úÖ",Le="Finalizada",Me='<div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 overflow-hidden shadow-inner">',Me+='<div class="bg-gradient-to-r from-green-400 to-emerald-500 h-4 rounded-full relative flex items-center justify-end pr-2">',Me+='<div class="absolute inset-0 bg-white opacity-20 rounded-full"></div>',Me+='<span class="text-xs font-bold text-white relative z-10">100%</span>',Me+="</div>",Me+="</div>")}}catch{}se+='            <div class="p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200 border-b border-gray-100 dark:border-gray-800 last:border-b-0">',se+='              <div class="flex items-center justify-between gap-4">',se+='                <div class="flex items-center gap-3 flex-1 min-w-0">',se+='                  <div class="w-10 h-10 rounded-lg flex items-center justify-center text-lg bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-800 dark:to-gray-700 border border-blue-200 dark:border-gray-600">',se+="                    "+Ne,se+="                  </div>",se+='                  <div class="flex-1 min-w-0">',se+='                    <div class="flex items-center gap-2 mb-1">',se+='                      <h3 class="font-semibold text-gray-900 dark:text-gray-100 truncate">'+(Te[Ee].nome||"Recorrente")+"</h3>",se+="                      "+Ce,se+="                    </div>",se+='                    <div class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400">',se+='                      <span class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded-full">'+String(Te[Ee].count)+" transa√ß√µes</span>",se+='                      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-'+$e+"-100 text-"+$e+"-800 dark:bg-"+$e+"-900 dark:text-"+$e+'-200">',se+="                        "+Le,se+="                      </span>",se+="                    </div>",se+="                  </div>",se+="                </div>",se+='                <div class="text-right">',se+='                  <div class="text-lg font-bold text-gray-900 dark:text-gray-100">R$ '+Number(Te[Ee].total||0).toFixed(2)+"</div>",se+='                  <div class="text-xs text-gray-500 dark:text-gray-400">total</div>',se+="                </div>",se+="              </div>",se+="              "+(Me?'<div class="mt-3">'+Me+"</div>":""),se+="            </div>"}se+="          </div>"}else se+='          <div class="empty-state p-12 text-center">',se+='            <div class="empty-icon text-6xl mb-6">‚ôªÔ∏è</div>',se+='            <div class="empty-text text-xl font-bold mb-3 text-gray-900 dark:text-gray-100">Sem recorrentes neste per√≠odo</div>',se+='            <div class="empty-description text-gray-500 dark:text-gray-400 mb-6">Despesas recorrentes cadastradas aparecer√£o aqui</div>',se+='            <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2 mx-auto">',se+='              <span class="text-lg">‚ûï</span>',se+="              <span>Nova Recorrente</span>",se+="            </button>",se+="          </div>";se+="        </div>",se+="      </div>"}catch{}try{for(var _e=[],ze=0;ze<c.length;ze++){var qe=c[ze];if(qe){for(var Ue=qe.id,Ve=At(qe.limite),Ge=qe.tipo||"despesa",Xe=0,Ye=0;Ye<g.length;Ye++){var He=g[Ye],Je=(He.categoriaId||He.categoryId)===Ue,We="despesa"===(He.tipo||"despesa");Je&&We&&(Xe+=Math.abs(At(null!==He.valor&&void 0!==He.valor?He.valor:He.amount)))}_e.push({id:Ue,nome:qe.nome||"Categoria",cor:qe.cor||"#4F46E5",tipo:Ge,limite:Ve,gasto:Xe})}}M=_e.filter(function(e){return(e.limite||0)>0&&"despesa"===(e.tipo||"despesa")}).map(function(e){var t=Number(e.limite||0),a=t>0?e.gasto/t*100:0;return{...e,porcentagem:a,temLimite:!0}}).sort(function(e,t){var a=e.gasto>e.limite,r=t.gasto>t.limite;return a&&!r?-1:!a&&r?1:t.porcentagem-e.porcentagem});var Qe=_e.filter(function(e){return e.gasto>0&&"despesa"===(e.tipo||"despesa")}).map(function(e){return{...e,temLimite:!1}}).sort(function(e,t){return t.gasto-e.gasto}),Ke=[],Ze=new Set;for(m=0;m<Math.min(4,M.length);m++)Ke.push(M[m]),Ze.add(M[m].id);for(Z=0;Z<Qe.length&&Ke.length<6;Z++)if(!Ze.has(Qe[Z].id)){var et=Qe[Z];if((et.limite||0)>0){var tt=Number(et.limite||0),at=tt>0?et.gasto/tt*100:0;et={...et,porcentagem:at,temLimite:!0}}Ke.push(et),Ze.add(et.id)}if(se+='      <div class="mb-12 draggable-card" data-card-type="categorias-inteligentes">',se+='        <div class="drag-handle"></div>',se+='        <div class="flex items-center gap-2 mb-4">',se+='          <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-pink-500 rounded-full"></div>',se+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üìä Categorias Inteligentes</h2>',se+="        </div>",se+='        <div class="u-card overflow-hidden">',se+='          <div class="bg-gradient-to-r from-purple-50 via-blue-50 to-orange-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 p-4 border-b border-gray-200 dark:border-gray-700">',se+='            <div class="flex justify-between items-center gap-4">',se+="              <div>",se+='                <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">üéØ Vis√£o Inteligente</h3>',se+='                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Limites priorit√°rios + maiores gastos</p>',se+="              </div>",se+='              <button id="add-category-dashboard-btn" class="btn btn-primary btn-sm">+ Nova</button>',se+="            </div>",se+="          </div>",se+='          <div class="p-4">',0===Ke.length)se+='            <div class="empty-state">',se+='              <div class="empty-icon">üìÇ</div>',se+='              <div class="empty-text">Nenhuma categoria encontrada</div>',se+='              <div class="empty-description">Crie categorias e adicione gastos para ver o resumo</div>',se+="            </div>";else for(var rt=0;rt<Ke.length;rt++){var ot,nt,st,it=Ke[rt],dt=Number(it.limite||0),lt=dt>0?it.gasto/dt*100:0;if(it.temLimite)lt>=100?(ot="üö®",nt="bg-red-500",st="EXCEDEU"):lt>=90?(ot="‚ö†Ô∏è",nt="bg-red-400",st="CR√çTICO"):lt>=75?(ot="‚ö°",nt="bg-yellow-500",st="ALERTA"):lt>=50?(ot="üìä",nt="bg-orange-500",st="ATEN√á√ÉO"):(ot="‚úÖ",nt="bg-green-500",st="OK");else{var ct=rt+1;1===ct?(ot="ü•á",st="1¬∫ LUGAR"):2===ct?(ot="ü•à",st="2¬∫ LUGAR"):3===ct?(ot="ü•â",st="3¬∫ LUGAR"):(ot="üìà",st="TOP "+ct),nt="bg-blue-500"}if(se+='            <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-3 border border-gray-200 dark:border-gray-700'+(it.temLimite&&lt>=90?" ring-2 ring-red-200 dark:ring-red-800":"")+' mb-3">',se+='              <div class="flex items-center justify-between mb-2 gap-4">',se+='                <div class="flex items-center gap-2">',se+='                  <span class="text-lg">'+ot+"</span>",se+='                  <div class="w-3 h-3 rounded-full" style="background-color: '+it.cor+'"></div>',se+='                  <span class="font-medium text-sm text-gray-900 dark:text-gray-100">'+it.nome+"</span>",st)se+='                  <span class="text-xs px-2 py-1 rounded-full font-medium '+(it.temLimite&&lt>=90?"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300":"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300")+'">'+st+"</span>";if(se+="                </div>",se+='                <span class="font-bold text-sm '+(it.temLimite&&it.gasto>dt?"text-red-600":"text-gray-900 dark:text-gray-100")+'">R$ '+Rt(it.gasto)+"</span>",se+="              </div>",it.temLimite)se+='              <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">',se+="                <span>Limite: R$ "+Rt(dt)+"</span>",se+='                <span class="'+(lt>=100?"text-red-600 font-bold":lt>=90?"text-orange-600 font-medium":"")+'">'+lt.toFixed(1)+"%</span>",se+="              </div>",se+='              <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">',se+='                <div class="'+nt+' h-2 rounded-full transition-all duration-300" style="width: '+Math.min(lt,100)+'%"></div>',se+="              </div>",lt>=100&&(se+='              <div class="mt-2 text-xs text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 px-2 py-1 rounded">Excedeu em R$ '+Rt(it.gasto-dt)+"</div>");else se+='              <p class="text-xs text-gray-500 dark:text-gray-400">Sem limite definido ‚Ä¢ Posi√ß√£o por gasto</p>';se+="            </div>"}se+="          </div>",se+="        </div>",se+="      </div>"}catch{}try{var gt=g.slice().sort(function(e,t){var a=St(e)||new Date(0);return(St(t)||new Date(0))-a}).slice(0,5);if(se+='      <div class="mb-12 draggable-card" data-card-type="atividade-recente">',se+='        <div class="drag-handle"></div>',se+='        <div class="flex items-center justify-between gap-2 mb-6">',se+='          <div class="flex items-center gap-2">',se+='            <div class="w-1 h-6 bg-gradient-to-b from-green-500 to-blue-500 rounded-full"></div>',se+='            <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üí≥ Atividade Recente</h2>',se+="          </div>",se+='          <div class="text-sm text-gray-500 dark:text-gray-400">',se+='            <span class="font-medium">'+gt.length+"</span> transa√ß√µes",se+="          </div>",se+="        </div>",se+='        <div class="u-card overflow-hidden">',se+='          <div class="bg-gradient-to-r from-green-50 to-blue-50 dark:from-gray-800 dark:to-gray-800 p-4 border-b border-gray-200 dark:border-gray-700">',se+='            <div class="flex flex-wrap justify-between items-center gap-2">',se+='              <h3 class="text-lg md:text-xl font-bold text-gray-900 dark:text-gray-100">√öltimas Transa√ß√µes</h3>',se+='              <button onclick="window.showAddTransactionModal && window.showAddTransactionModal()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200 shadow-md hover:shadow-lg">',se+="                + Nova Transa√ß√£o",se+="              </button>",se+="            </div>",se+="          </div>",0===gt.length)se+='          <div class="empty-state p-8">',se+='            <div class="empty-icon text-4xl mb-4">üßæ</div>',se+='            <div class="empty-text text-lg font-medium mb-2">Sem transa√ß√µes neste per√≠odo</div>',se+='            <div class="empty-description text-sm text-gray-500 dark:text-gray-400 mb-4">Adicione transa√ß√µes para acompanhar seus gastos e receitas</div>',se+='            <button class="btn btn-primary" onclick="window.showAddTransactionModal && window.showAddTransactionModal()">Adicionar transa√ß√£o</button>',se+="          </div>";else{se+='          <div class="divide-y divide-gray-100 dark:divide-gray-800">';for(var pt=0;pt<gt.length;pt++){var ut=gt[pt],mt=c.find(function(e){return e.id===(ut.categoriaId||ut.categoryId)}),vt="receita"===(ut.tipo||"despesa")?"+":"-",xt=Math.abs(At(null!==ut.valor&&void 0!==ut.valor?ut.valor:ut.amount)),bt=St(ut),ft=bt?bt.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"",ht="receita"===(ut.tipo||"despesa"),yt="";try{if(ut.recorrenteId&&(ut.parcelaAtual||ut.parcelasTotal)){me=null!==ut.parcelaAtual&&void 0!==ut.parcelaAtual?ut.parcelaAtual:"",ve=null!==ut.parcelasTotal&&void 0!==ut.parcelasTotal?ut.parcelasTotal:"";(me||ve)&&(yt='<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 ml-2">'+(me||"?")+"/"+(ve||"?")+"</span>")}}catch{}var wt=ht?"üí∞":"üí∏";se+='            <div class="p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200">',se+='              <div class="flex items-start justify-between gap-4">',se+='                <div class="flex items-start gap-3 min-w-0 flex-1">',se+='                  <div class="flex-shrink-0 mt-1">',se+='                    <div class="w-10 h-10 rounded-full flex items-center justify-center text-lg" style="background-color: '+(mt&&mt.cor||"#6B7280")+"20; color: "+(mt&&mt.cor||"#6B7280")+'">',se+="                      "+wt,se+="                    </div>",se+="                  </div>",se+='                  <div class="min-w-0 flex-1">',se+='                    <div class="flex items-center gap-2 mb-1">',se+='                      <h4 class="font-semibold text-gray-900 dark:text-gray-100 truncate">'+(ut.descricao||ut.description||"Transa√ß√£o")+"</h4>",se+="                      "+yt,se+="                    </div>",se+='                    <div class="flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400">',se+='                      <span class="font-medium">'+(mt&&mt.nome||"Sem categoria")+"</span>",se+="                      <span>‚Ä¢</span>",se+="                      <span>"+ft+"</span>",se+="                    </div>",se+="                  </div>",se+="                </div>",se+='                <div class="text-right flex-shrink-0">',se+='                  <div class="text-lg font-bold '+(ht?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+'">'+vt+"R$ "+Rt(xt)+"</div>",se+='                  <div class="text-xs text-gray-500 dark:text-gray-400">'+(ht?"receita":"despesa")+"</div>",se+="                </div>",se+="              </div>",se+="            </div>"}se+="          </div>"}se+="        </div>",se+="      </div>"}catch{}se+="    </div>",se+="  </div>",se+="</div>",r.innerHTML=se;try{y("#dash-period-indicator")}catch{}try{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new fe}):new fe}catch{}try{window.showCategoriasAlertaModal=async function(){try{const o=new Date,s=window.appState&&window.appState.selectedYear||o.getFullYear(),d=window.appState&&window.appState.selectedMonth||o.getMonth()+1,l=String(s)+"-"+String(d).padStart(2,"0"),c=(Array.isArray(window.appState?.transactions)?window.appState.transactions:[]).filter(function(e){return Dt(St(e))===l}),g=(Array.isArray(window.appState?.categories)?window.appState.categories:[]).filter(function(e){return e&&"despesa"===(e.tipo||"despesa")&&At(e.limite)>0}).map(function(e){for(var t=0,a=0;a<c.length;a++){var r=c[a];if("despesa"===(r.tipo||"despesa"))(r.categoriaId||r.categoryId)===e.id&&(t+=Math.abs(At(null!==r.valor&&void 0!==r.valor?r.valor:r.amount)))}var o=At(e.limite),n=o>0?t/o*100:0;return{id:e.id,nome:e.nome||"Categoria",cor:e.cor||"#4F46E5",limite:o,gasto:t,pct:n}}).filter(function(e){return e.pct>=70}).sort(function(e,t){return t.pct-e.pct});let p='<div class="mb-3 text-xs text-gray-600 dark:text-gray-300">Mostrando categorias com uso do limite ‚â• 70% em '+i+" "+n+".</div>";if(g.length){p+='<div class="space-y-3">';for(var e=0;e<g.length;e++){var a=g[e],r=a.pct>=100?"bg-red-500":a.pct>=90?"bg-red-400":a.pct>=75?"bg-yellow-500":"bg-orange-500";p+='              <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700">                <div class="flex items-center justify-between mb-2">                  <div class="flex items-center gap-2">                    <div class="w-3 h-3 rounded-full" style="background-color:'+a.cor+'"></div>                    <span class="font-medium text-sm text-gray-900 dark:text-gray-100">'+a.nome+'</span>                  </div>                  <span class="font-bold text-sm '+(a.pct>=100?"text-red-600":a.pct>=90?"text-orange-600":"text-gray-900 dark:text-gray-100")+'">R$ '+Rt(a.gasto)+'</span>                </div>                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">                  <span>Limite: R$ '+Rt(a.limite)+"</span>                  <span>"+a.pct.toFixed(1)+'%</span>                </div>                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">                  <div class="'+r+' h-2 rounded-full" style="width:'+Math.min(a.pct,100).toFixed(1)+'%"></div>                </div>                <div class="mt-1 text-[11px] text-gray-500 dark:text-gray-400">Restante: R$ '+Rt(Math.max(a.limite-a.gasto,0))+"</div>              </div>"}p+="</div>"}else p+='<div class="text-center py-6">            <div class="text-3xl mb-2">‚úÖ</div>            <div class="text-gray-700 dark:text-gray-200">Nenhuma categoria em alerta</div>          </div>';const{Modal:u}=await t(async()=>{const{Modal:e}=await import("./main-OjaIp7EQ.js").then(e=>e.a8);return{Modal:e}},__vite__mapDeps([0,1,2])),m=u({title:"Categorias em alerta",content:p,onClose:function(){try{document.getElementById("app-modal")?.remove()}catch{}}});document.body.appendChild(m)}catch(o){try{alert("Erro ao abrir modal: "+(o?.message||o))}catch{}}}}catch{}be(),setTimeout(()=>{const e=document.getElementById("add-category-dashboard-btn");e&&e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),window.showAddCategoryModal?window.showAddCategoryModal():alert("Fun√ß√£o de adicionar categoria n√£o est√° dispon√≠vel")})},100)}function kt(e){try{if(!e)return null;if(e&&"function"==typeof e.toDate)return e.toDate();if(e&&e.seconds)return new Date(1e3*e.seconds);var t=new Date(e);return isNaN(t)?null:t}catch{return null}}function St(e){if(!e)return null;for(var t=[e.createdAt,e.data,e.date,e.dataTransacao,e.updatedAt],a=0;a<t.length;a++){var r=kt(t[a]);if(r)return r}return null}function Dt(e){return e?e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0"):""}function At(e){try{if(null==e)return 0;if("number"==typeof e)return e;var t=String(e).trim();t=(t=(t=t.replace(/[^0-9,.-]/g,"")).replace(/\.(?=\d{3}(?:\D|$))/g,"")).replace(",",".");var a=parseFloat(t);return isNaN(a)?0:a}catch{return 0}}function Rt(e){try{return Number(e||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}catch{return Number(e||0).toFixed(2)}}}function ke(){try{if(!window.appState||!window.appState.transactions)return void(window.Snackbar?window.Snackbar({message:"Nenhum dado dispon√≠vel para exportar.",type:"warning"}):alert("Nenhum dado dispon√≠vel para exportar."));const e={transactions:window.appState.transactions,categories:window.appState.categories,budgets:window.appState.budgets,recorrentes:window.appState.recorrentes},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download="financeiro-backup.json",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),window.Snackbar&&window.Snackbar({message:"‚úÖ Backup JSON exportado com sucesso!",type:"success"})}catch(e){window.Snackbar?window.Snackbar({message:"Erro ao exportar backup: "+e.message,type:"error"}):alert("Erro ao exportar backup: "+e.message)}}async function Se(){try{if(void 0===window.XLSX&&await t(()=>import("https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"),[]),!window.appState||!window.appState.transactions)return void(window.Snackbar?window.Snackbar({message:"Nenhum dado dispon√≠vel para exportar.",type:"warning"}):alert("Nenhum dado dispon√≠vel para exportar."));const e=window.XLSX.utils.book_new(),a=window.appState.transactions.map(e=>({"Descri√ß√£o":e.descricao,Valor:e.valor,Tipo:e.tipo,Categoria:window.appState.categories.find(t=>t.id===e.categoriaId)?.nome||"",Data:e.createdAt&&e.createdAt.toDate?e.createdAt.toDate().toLocaleDateString():""}));window.XLSX.utils.book_append_sheet(e,window.XLSX.utils.json_to_sheet(a),"Transa√ß√µes");const r=window.appState.categories.map(e=>({Nome:e.nome,Tipo:e.tipo,Limite:e.limite,Cor:e.cor}));window.XLSX.utils.book_append_sheet(e,window.XLSX.utils.json_to_sheet(r),"Categorias");const o=window.appState.budgets.map(e=>({Nome:e.nome,"Descri√ß√£o":e.descricao,ID:e.id}));window.XLSX.utils.book_append_sheet(e,window.XLSX.utils.json_to_sheet(o),"Or√ßamentos"),window.XLSX.writeFile(e,"financeiro-dados.xlsx"),window.Snackbar&&window.Snackbar({message:"‚úÖ Arquivo Excel exportado com sucesso!",type:"success"})}catch(e){window.Snackbar?window.Snackbar({message:"Erro ao exportar Excel: "+e.message,type:"error"}):alert("Erro ao exportar Excel: "+e.message)}}async function De(){try{if(void 0===window.jspdf&&await t(()=>import("https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"),[]),!window.appState||!window.appState.transactions)return void(window.Snackbar?window.Snackbar({message:"Nenhum dado dispon√≠vel para exportar.",type:"warning"}):alert("Nenhum dado dispon√≠vel para exportar."));const{jsPDF:e}=window.jspdf,a=new e;let r=10;a.setFontSize(20),a.setFont("helvetica","bold"),a.text("üìä Relat√≥rio Financeiro",10,r),r+=15;const o=window.appState.currentBudget;o&&(a.setFontSize(14),a.setFont("helvetica","bold"),a.text(`Or√ßamento: ${o.nome}`,10,r),r+=8,a.setFontSize(10),a.setFont("helvetica","normal"),a.text(`ID: ${o.id}`,10,r),r+=10);const n=window.appState.transactions.filter(e=>"receita"===e.tipo).reduce((e,t)=>e+parseFloat(t.valor),0),s=window.appState.transactions.filter(e=>"despesa"===e.tipo).reduce((e,t)=>e+parseFloat(t.valor),0),i=n-s;a.setFontSize(12),a.setFont("helvetica","bold"),a.text("Resumo Geral:",10,r),r+=8,a.setFontSize(10),a.setFont("helvetica","normal"),a.text(`Total Receitas: R$ ${n.toFixed(2)}`,12,r),r+=6,a.text(`Total Despesas: R$ ${s.toFixed(2)}`,12,r),r+=6,a.setFont("helvetica","bold"),a.text(`Saldo: R$ ${i.toFixed(2)}`,12,r),a.setFontSize(12),a.setFont("helvetica","bold"),a.text("Transa√ß√µes Recentes:",10,r),r+=8,a.setFontSize(9),a.setFont("helvetica","normal"),window.appState.transactions.sort((e,t)=>new Date(t.createdAt?.toDate?.()||t.createdAt)-new Date(e.createdAt?.toDate?.()||e.createdAt)).slice(0,15).forEach(e=>{const t=window.appState.categories.find(t=>t.id===e.categoriaId)?.nome||"Sem categoria",o=`${e.createdAt?.toDate?.()?e.createdAt.toDate().toLocaleDateString():"Data n√£o dispon√≠vel"} - ${e.descricao} | R$ ${e.valor} | ${e.tipo} | ${t}`;r>270&&(a.addPage(),r=10),a.text(o,12,r),r+=6}),r+=5,a.setFontSize(12),a.setFont("helvetica","bold"),a.text("Gastos por Categoria:",10,r),r+=8,a.setFontSize(9),a.setFont("helvetica","normal"),window.appState.categories.forEach(e=>{const t=window.appState.transactions.filter(t=>t.categoriaId===e.id&&"despesa"===t.tipo).reduce((e,t)=>e+parseFloat(t.valor),0);if(t>0){const o=e.limite?` / R$ ${e.limite}`:"",n=e.limite?` (${(t/e.limite*100).toFixed(1)}%)`:"";r>270&&(a.addPage(),r=10),a.text(`${e.nome}: R$ ${t.toFixed(2)}${o}${n}`,12,r),r+=6}}),a.save("relatorio-financeiro.pdf"),window.Snackbar&&window.Snackbar({message:"‚úÖ Relat√≥rio PDF exportado com sucesso!",type:"success"})}catch(e){window.Snackbar?window.Snackbar({message:"Erro ao exportar PDF: "+e.message,type:"error"}):alert("Erro ao exportar PDF: "+e.message)}}function Ae(){try{let e=function(e,t,r,o=170){return a.splitTextToSize(e,o).forEach(e=>{r>270&&(a.addPage(),r=10),a.text(e,t,r),r+=6}),r};if(void 0===window.jspdf)return void(window.Snackbar?window.Snackbar({message:"Erro: Biblioteca jsPDF n√£o est√° carregada. Tente recarregar a p√°gina.",type:"error"}):alert("Erro: Biblioteca jsPDF n√£o est√° carregada. Tente recarregar a p√°gina."));const{jsPDF:t}=window.jspdf,a=new t;let r=10;a.setFontSize(24),a.setFont("helvetica","bold"),a.setFillColor(79,70,229),a.rect(0,0,210,40,"F"),a.setTextColor(255,255,255),a.text("Controle Financeiro",20,25),a.setFontSize(14),a.text("Guia Completo de Uso",20,35),r=50,a.setFontSize(12),a.setFont("helvetica","bold"),a.setTextColor(0,0,0),r=e("üéØ Como Usar o Aplicativo",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e("1. Fa√ßa login com sua conta Google",25,r),r=e("2. Crie categorias para organizar suas despesas e receitas",25,r),r=e("3. Adicione transa√ß√µes usando o bot√£o + ou comandos de voz",25,r),r=e("4. Configure despesas recorrentes para pagamentos fixos",25,r),r=e("5. Monitore seu saldo e gastos no dashboard",25,r),r+=10,a.setFontSize(12),a.setFont("helvetica","bold"),r=e("üé§ Comandos de Voz Dispon√≠veis",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e('‚Ä¢ "gastei 50 reais no supermercado em alimenta√ß√£o"',25,r),r=e('‚Ä¢ "recebi 2000 de sal√°rio em rendimentos"',25,r),r=e('‚Ä¢ "criar categoria alimenta√ß√£o despesa 500"',25,r),r=e('‚Ä¢ "qual meu saldo"',25,r),r=e('‚Ä¢ "mostrar transa√ß√µes"',25,r),r+=10,a.setFontSize(12),a.setFont("helvetica","bold"),r=e("üìä Funcionalidades Principais",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e("‚Ä¢ Dashboard com resumo financeiro",25,r),r=e("‚Ä¢ Gest√£o de transa√ß√µes e categorias",25,r),r=e("‚Ä¢ Sistema de despesas recorrentes",25,r),r=e("‚Ä¢ Alertas de limite de categoria",25,r),r=e("‚Ä¢ Backup e exporta√ß√£o de dados",25,r),r=e("‚Ä¢ Interface responsiva para mobile",25,r),r+=10,a.setFontSize(12),a.setFont("helvetica","bold"),r=e("üíæ Backup e Exporta√ß√£o",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e("‚Ä¢ Exporta√ß√£o em JSON para backup completo",25,r),r=e("‚Ä¢ Exporta√ß√£o em Excel para relat√≥rios",25,r),r=e("‚Ä¢ Exporta√ß√£o em PDF para documenta√ß√£o",25,r),r=e("‚Ä¢ Restaura√ß√£o de dados de backup",25,r),r+=10,a.setFontSize(12),a.setFont("helvetica","bold"),r=e("üîß Suporte e Contato",20,r),a.setFontSize(10),a.setFont("helvetica","normal"),r=e("Para d√∫vidas ou problemas:",25,r),r=e("‚Ä¢ Verifique os logs do console (F12)",30,r),r=e("‚Ä¢ Teste em diferentes navegadores",30,r),r=e("‚Ä¢ Consulte a documenta√ß√£o t√©cnica",30,r),a.save("guia-servo-tech-financas.pdf"),window.Snackbar&&window.Snackbar({message:"‚úÖ Guia PDF exportado com sucesso!",type:"success"})}catch(e){window.Snackbar?window.Snackbar({message:"Erro ao exportar guia PDF: "+e.message,type:"error"}):alert("Erro ao exportar guia PDF: "+e.message)}}function Re(){t(async()=>{const{Modal:e}=await import("./index-CoZHK14T.js").then(e=>e.i);return{Modal:e}},__vite__mapDeps([3,0,1,2,4])).then(({Modal:e})=>{e({title:"üì§ Op√ß√µes de Exporta√ß√£o",content:'\n        <div class="space-y-4">\n          <button onclick="window.downloadBackup && window.downloadBackup()" class="w-full btn btn-primary btn-sm">\n            <span class="icon-standard">üíæ</span>\n            Backup JSON Completo\n          </button>\n          <button onclick="window.exportToExcel && window.exportToExcel()" class="w-full btn btn-outline btn-sm">\n            <span class="icon-standard">üìä</span>\n            Exportar para Excel\n          </button>\n          <button onclick="window.exportToPDF && window.exportToPDF()" class="w-full btn btn-outline btn-sm">\n            <span class="icon-standard">üìÑ</span>\n            Exportar para PDF\n          </button>\n          <button onclick="window.exportReadmePDF && window.exportReadmePDF()" class="w-full btn btn-outline btn-sm">\n            <span class="icon-standard">üìñ</span>\n            Guia de Uso (PDF)\n          </button>\n        </div>\n      '})}).catch(()=>{alert("Abra as op√ß√µes de exporta√ß√£o nas configura√ß√µes.")})}function Te(){try{"scrollRestoration"in history&&(history.scrollRestoration="manual")}catch{}const e=["/dashboard","/transactions","/categories","/analytics","/recorrentes","/notifications","/settings"];function t(t){const a=e.indexOf((e=>{const t=(e||"").split("?")[0];return t&&t.startsWith("/")?t:"/dashboard"})(window.location.hash.slice(1)));if(-1===a)return;let r;r="next"===t?(a+1)%e.length:0===a?e.length-1:a-1;const o=e[r];window.location.hash=o,function(e){const t={"/dashboard":"Dashboard","/transactions":"Transa√ß√µes","/categories":"Categorias","/analytics":"An√°lises","/recorrentes":"Recorrentes","/notifications":"Notifica√ß√µes","/settings":"Configura√ß√µes"}[e]||"Dashboard";document.title=`Financeiro - ${t}`}(o)}document.addEventListener("keydown",e=>{if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName)switch(e.key){case"ArrowLeft":e.preventDefault(),t("prev");break;case"ArrowRight":e.preventDefault(),t("next")}})}async function Fe(){try{if(window.appState?.isInitialized)return;if(window.appState?.currentUser){await async function(){try{const e=window.appState?.currentUser?.uid;if(!e)return;const{loadUserBudgets:a}=await t(async()=>{const{loadUserBudgets:e}=await import("./main-OjaIp7EQ.js").then(e=>e.ae);return{loadUserBudgets:e}},__vite__mapDeps([0,1,2]));await a(e);const{selectDefaultBudget:r}=await t(async()=>{const{selectDefaultBudget:e}=await import("./main-OjaIp7EQ.js").then(e=>e.ae);return{selectDefaultBudget:e}},__vite__mapDeps([0,1,2]));await r(e),"function"==typeof window.loadTransactions&&await window.loadTransactions(),"function"==typeof window.loadCategories&&await window.loadCategories(),"function"==typeof window.loadRecorrentes&&await window.loadRecorrentes(),"function"==typeof window.loadNotifications&&await window.loadNotifications(),"function"==typeof window.listenNotifications&&await window.listenNotifications(),window.appState.currentBudget?.id&&"function"==typeof window.startAllListeners&&await window.startAllListeners(window.appState.currentBudget.id)}catch(e){}}();try{const a=new Date,r=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,o=localStorage.getItem("recorrentes:lastAutoApplied");if(1===a.getDate()&&o!==r){const a=window.appState?.currentUser?.uid,o=window.appState?.currentBudget?.id;if(a&&o){const{aplicarRecorrentesDoMes:n,loadRecorrentes:s}=await t(async()=>{const{aplicarRecorrentesDoMes:e,loadRecorrentes:t}=await import("./main-OjaIp7EQ.js").then(e=>e.a7);return{aplicarRecorrentesDoMes:e,loadRecorrentes:t}},__vite__mapDeps([0,1,2])),i=await n(a,o,!0);"function"==typeof window.loadTransactions&&await window.loadTransactions(),await s();try{e.emit("transactions:updated")}catch{}try{e.emit("categories:updated")}catch{}try{e.emit("recorrentes:updated")}catch{}localStorage.setItem("recorrentes:lastAutoApplied",r),i?.aplicadas>0&&window.Snackbar&&window.Snackbar({message:`Recorrentes do m√™s aplicadas automaticamente (${i.aplicadas}).`,type:"info"})}}}catch(a){}Ee()}}catch(r){}}function Ee(){e.on("transaction:added",Ce),e.on("transaction:updated",Me),e.on("transaction:deleted",$e),e.on("category:added",Ne),e.on("category:updated",Le),e.on("category:deleted",je),e.on("budget:changed",Oe)}function Ce(e){}function Me(e){}function $e(e){}function Ne(e){}function Le(e){}function je(e){}function Oe(e){}function Ie(e,t="BRL"){if(null==e||isNaN(e))return"R$ 0,00";try{return new Intl.NumberFormat("pt-BR",{style:"currency",currency:t}).format(e)}catch(a){return`R$ ${e.toFixed(2).replace(".",",")}`}}function Pe(e,t={}){if(!e)return"";try{const a={year:"numeric",month:"2-digit",day:"2-digit",...t},r=new Date(e);return isNaN(r.getTime())?"":new Intl.DateTimeFormat("pt-BR",a).format(r)}catch(a){return""}}function Be(e,t){return t&&0!==t?Math.round(e/t*100):0}function _e(e){return e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():""}function ze(e,t){let a;return function(...r){clearTimeout(a),a=setTimeout(()=>{clearTimeout(a),e(...r)},t)}}function qe(e,t){let a;return function(){const r=arguments,o=this;a||(e.apply(o,r),a=!0,setTimeout(()=>a=!1,t))}}function Ue(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function Ve(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Ge(e){return e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():""}function Xe(e,t=50){return!e||e.length<=t?e:e.substring(0,t)+"..."}function Ye(e){return!isNaN(parseFloat(e))&&isFinite(e)}function He(e){return Math.round(100*(e+Number.EPSILON))/100}function Je(e){const t=[];if(e.descricao&&0!==e.descricao.trim().length?e.descricao.trim().length<3&&t.push("Descri√ß√£o deve ter pelo menos 3 caracteres"):t.push("Descri√ß√£o √© obrigat√≥ria"),!e.valor||isNaN(e.valor)?t.push("Valor deve ser um n√∫mero v√°lido"):e.valor<=0&&t.push("Valor deve ser maior que zero"),e.tipo&&["receita","despesa"].includes(e.tipo)||t.push('Tipo deve ser "receita" ou "despesa"'),e.categoriaId||t.push("Categoria √© obrigat√≥ria"),e.data){const a=new Date(e.data);isNaN(a.getTime())&&t.push("Data deve ser v√°lida")}return{isValid:0===t.length,errors:t}}function We(e){const t=[];return e.nome&&0!==e.nome.trim().length?e.nome.trim().length<2&&t.push("Nome da categoria deve ter pelo menos 2 caracteres"):t.push("Nome da categoria √© obrigat√≥rio"),e.tipo&&["receita","despesa"].includes(e.tipo)||t.push('Tipo deve ser "receita" ou "despesa"'),void 0!==e.limite&&null!==e.limite&&(isNaN(e.limite)?t.push("Limite deve ser um n√∫mero v√°lido"):e.limite<0&&t.push("Limite n√£o pode ser negativo")),e.cor&&!function(e){const t=(new Option).style;return t.color=e,""!==t.color}(e.cor)&&t.push("Cor deve ser um c√≥digo de cor v√°lido"),{isValid:0===t.length,errors:t}}function Qe(e){const t=[];return e.nome&&0!==e.nome.trim().length?e.nome.trim().length<3&&t.push("Nome do or√ßamento deve ter pelo menos 3 caracteres"):t.push("Nome do or√ßamento √© obrigat√≥rio"),!e.valorTotal||isNaN(e.valorTotal)?t.push("Valor total deve ser um n√∫mero v√°lido"):e.valorTotal<=0&&t.push("Valor total deve ser maior que zero"),e.periodo&&!["mensal","semanal","anual"].includes(e.periodo)&&t.push('Per√≠odo deve ser "mensal", "semanal" ou "anual"'),{isValid:0===t.length,errors:t}}function Ke(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Ze(e){const t=[];return(!e||e.length<6)&&t.push("Senha deve ter pelo menos 6 caracteres"),/[A-Z]/.test(e)||t.push("Senha deve conter pelo menos uma letra mai√∫scula"),/[a-z]/.test(e)||t.push("Senha deve conter pelo menos uma letra min√∫scula"),/\d/.test(e)||t.push("Senha deve conter pelo menos um n√∫mero"),{isValid:0===t.length,errors:t}}function et(e){if(11!==(e=e.replace(/[^\d]/g,"")).length)return!1;if(/^(\d)\1{10}$/.test(e))return!1;let t=0;for(let n=0;n<9;n++)t+=parseInt(e.charAt(n))*(10-n);let a=t%11,r=a<2?0:11-a;t=0;for(let n=0;n<10;n++)t+=parseInt(e.charAt(n))*(11-n);a=t%11;let o=a<2?0:11-a;return parseInt(e.charAt(9))===r&&parseInt(e.charAt(10))===o}function tt(e){return(e=e.replace(/[^\d]/g,"")).length>=10&&e.length<=11}function at(e){try{const t=window.appState.budgets.find(t=>t.id===e);if(!t)return{receitas:0,despesas:0,saldo:0};const a=window.appState.transactions.filter(t=>t.budgetId===e),r=a.filter(e=>"receita"===e.tipo).reduce((e,t)=>e+(t.valor||0),0),o=a.filter(e=>"despesa"===e.tipo).reduce((e,t)=>e+(t.valor||0),0),n=r-o;return{receitas:it(r),despesas:it(o),saldo:it(n),orcado:t.valorTotal||0}}catch(t){return{receitas:0,despesas:0,saldo:0,orcado:0}}}function rt(e,t=null){try{let a=window.appState.transactions.filter(t=>t.budgetId===e);if(t){const e=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0");a=a.filter(t=>(t.data?new Date(t.data).getFullYear()+"-"+String(new Date(t.data).getMonth()+1).padStart(2,"0"):(new Date).getFullYear()+"-"+String((new Date).getMonth()+1).padStart(2,"0"))===e)}const r={};return a.forEach(e=>{const t=e.categoriaId,a=window.appState.categories.find(e=>e.id===t);a&&(r[t]||(r[t]={id:t,nome:a.nome,cor:a.cor,tipo:a.tipo,receitas:0,despesas:0,total:0}),"receita"===e.tipo?r[t].receitas+=e.valor||0:r[t].despesas+=e.valor||0,r[t].total=r[t].receitas-r[t].despesas)}),Object.values(r).map(e=>({...e,receitas:it(e.receitas),despesas:it(e.despesas),total:it(e.total)})).sort((e,t)=>Math.abs(t.total)-Math.abs(e.total))}catch(a){return[]}}function ot(e,t=6){try{const a=[],r=new Date;for(let o=0;o<t;o++){const t=new Date(r.getFullYear(),r.getMonth()-o,1),n=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0"),s=t.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),i=window.appState.transactions.filter(t=>{if(t.budgetId!==e)return!1;if(!t.data)return!1;const a=new Date(t.data);return a.getFullYear()+"-"+String(a.getMonth()+1).padStart(2,"0")===n}),d=i.filter(e=>"receita"===e.tipo).reduce((e,t)=>e+(t.valor||0),0),l=i.filter(e=>"despesa"===e.tipo).reduce((e,t)=>e+(t.valor||0),0),c=d-l;a.push({month:n,monthName:s,receitas:it(d),despesas:it(l),saldo:it(c),transactionCount:i.length})}return a.reverse()}catch(a){return[]}}function nt(e,t=3){try{const a=ot(e,t);if(a.length<2)return{trend:"estavel",percentage:0};const r=a[a.length-1],o=a[a.length-2];if(0===o.saldo)return{trend:"estavel",percentage:0};const n=(r.saldo-o.saldo)/Math.abs(o.saldo)*100;let s="estavel";return n>5?s="crescimento":n<-5&&(s="declinio"),{trend:s,percentage:it(n),change:it(r.saldo-o.saldo)}}catch(a){return{trend:"estavel",percentage:0}}}function st(e,t=3){try{const a=ot(e,t);if(a.length<2)return null;const r=[];for(let e=1;e<a.length;e++){const t=a[e].saldo-a[e-1].saldo;r.push(t)}const o=r.reduce((e,t)=>e+t,0)/r.length,n=a[a.length-1].saldo,s=[];for(let e=1;e<=t;e++){const t=n+o*e;s.push({month:e,projectedSaldo:it(t),confidence:Math.max(0,100-20*e)})}return s}catch(a){return null}}function it(e){return Math.round(100*(e+Number.EPSILON))/100}export{a as addTransactionWithNotifications,r as applyCompactMode,o as applyCurrentTheme,n as applyTheme,s as applyThemeSettings,w as calcularNumeroParcela,at as calculateBudgetBalance,rt as calculateCategoryTotals,ot as calculateMonthlyStats,Be as calculatePercentage,st as calculateProjections,nt as calculateTrends,Ge as capitalizeFirst,de as checkAuthState,G as closeVoiceModal,k as collapseAllDays,ze as debounce,i as deleteTransactionWithNotifications,ke as downloadBackup,S as expandAllDays,Ae as exportReadmePDF,Se as exportToExcel,De as exportToPDF,Ie as formatCurrency,Pe as formatDate,D as formatTransactionDisplayDate,Ue as generateId,A as getCollapsedDays,d as getCurrentCompactMode,l as getCurrentTheme,R as getTransactionDate,T as getTransactionYearMonth,X as getVoiceSystem,Fe as initializeApp,F as isDayCollapsed,Ye as isNumeric,Ve as isValidEmail,c as leaveSharedBudget,E as loadAllOlderMonths,C as loadMonthSection,le as logout,Y as normalizarTexto,_e as normalizeText,H as openVoiceModal,J as parseNumeroPorExtenso,W as processCategoryVoice,Q as processTransactionVoice,K as processVoiceCommand,g as removeUserFromBudget,_ as renderAllCategories,M as renderAllTransactions,ee as renderBottomNav,z as renderCategories,we as renderDashboard,te as renderFAB,q as renderFilteredCategories,$ as renderFilteredTransactions,N as renderMonthSectionHTML,U as renderNotifications,L as renderOlderMonthsControl,V as renderRecorrentes,j as renderTransactionItemHTML,O as renderTransactions,I as renderTransactionsGroupedByDay,ae as resetScrollPosition,He as roundToTwoDecimals,P as saveCollapsedDays,p as sendCategoryChangeNotification,u as sendTransactionDeletedNotification,m as sendTransactionNotification,v as sendTransactionUpdatedNotification,re as setupCategoryButtons,oe as setupDashboardButtons,Ee as setupEventListeners,ne as setupHeaderButtons,ce as setupLoginButton,Te as setupNavigation,x as setupThemeToggle,se as setupTransactionButtons,Re as showExportOptions,ie as showLoading,Z as startVoiceRecognition,qe as throttle,b as toggleCompactMode,B as toggleDayGroup,ge as toggleLoginPage,f as toggleTheme,Xe as truncateText,h as updateTransactionWithNotifications,Qe as validateBudget,et as validateCPF,We as validateCategory,Ke as validateEmail,Ze as validatePassword,tt as validatePhone,Je as validateTransaction};

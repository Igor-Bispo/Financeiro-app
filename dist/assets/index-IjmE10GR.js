const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-B-XVfQ8M.js","assets/main-Cn8BSRqe.css","assets/index-CvbvzAkH.js","assets/PeriodIndicator-a2W_bjaH.js"])))=>i.map(i=>d[i]);
import{e as f,_ as z,i as he,D as st,E as Lt,F as jt,G as zt,H as Ot,I as qe,S as it,J as Ut}from"./main-B-XVfQ8M.js";import{K as qa,T as Ha,R as Ga,Q as Ja,X as Wa,N as Ka,W as Qa,V as Za,O as eo,U as to,P as ao,L as oo}from"./main-B-XVfQ8M.js";import{mountPeriodIndicator as lt}from"./PeriodIndicator-a2W_bjaH.js";import{calcularNumeroParcela as no,collapseAllDays as so,expandAllDays as io,formatTransactionDisplayDate as lo,getCollapsedDays as co,getTransactionDate as uo,getTransactionYearMonth as po,isDayCollapsed as go,loadAllOlderMonths as mo,loadMonthSection as vo,renderAllTransactions as fo,renderFilteredTransactions as wo,renderMonthSectionHTML as ho,renderOlderMonthsControl as bo,renderTransactionItemHTML as xo,renderTransactions as yo,renderTransactionsGroupedByDay as So,saveCollapsedDays as ko,toggleDayGroup as Ao}from"./TransactionsPage-CwVPq0Gj.js";import{renderAllCategories as To,renderCategories as Eo,renderFilteredCategories as No}from"./CategoriesPage-qPYCdC2c.js";import{renderNotifications as Do}from"./NotificationsPage-Crmk4UkV.js";import{leaveSharedBudget as Mo,removeUserFromBudget as Po,sendCategoryChangeNotification as $o,sendTransactionDeletedNotification as Io,sendTransactionNotification as _o,sendTransactionUpdatedNotification as Bo}from"./NotificationService-B-HO54SU.js";import{closeVoiceModal as jo,getVoiceSystem as zo,normalizarTexto as Oo,openVoiceModal as Uo,parseNumeroPorExtenso as Vo,processCategoryVoice as Xo,processTransactionVoice as Yo,processVoiceCommand as qo,startVoiceRecognition as Ho}from"./VoiceService-F1rMbtYP.js";import{b as Jo,r as Wo,d as Ko,a as Qo,f as Zo,e as er,s as tr,c as ar}from"./UIService-CkqgNauy.js";import"./perf-tobPnqr4.js";import"./NotificationModal-B569_tcv.js";import"./VoiceSystem-CEBe8orV.js";let dt=!1;function Vt(e){try{if(!e){const s=(window.location.hash||"").split("?")[0];if(s&&s!=="#/dashboard"&&s!=="#/")return}}catch{}var t=e||document.getElementById("app-content");if(!t)return;if(!dt)try{const s=()=>queueMicrotask(()=>Vt());f.on("transactions:updated",s),f.on("categories:updated",s),f.on("budget:changed",s),f.on("period:changed",s),f.on("summary:updated",s),f.on("app:ready",s),dt=!0}catch{}var a=new Date;window.appState||(window.appState={});var r=window.appState&&window.appState.selectedYear||a.getFullYear(),n=window.appState&&window.appState.selectedMonth||a.getMonth()+1,i=["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],d=i[Math.max(0,Math.min(11,n-1))]||"",l=String(r)+"-"+String(n).padStart(2,"0");function g(s){try{if(!s)return null;if(s&&typeof s.toDate=="function")return s.toDate();if(s&&s.seconds)return new Date(s.seconds*1e3);var c=new Date(s);return isNaN(c)?null:c}catch{return null}}function b(s){if(!s)return null;for(var c=[s.createdAt,s.data,s.date,s.dataTransacao,s.updatedAt],S=0;S<c.length;S++){var D=g(c[S]);if(D)return D}return null}function T(s){if(!s)return"";var c=s.getFullYear(),S=String(s.getMonth()+1).padStart(2,"0");return c+"-"+S}function h(s){try{if(s==null)return 0;if(typeof s=="number")return s;var c=String(s).trim();c=c.replace(/[^0-9,.-]/g,""),c=c.replace(/\.(?=\d{3}(?:\D|$))/g,""),c=c.replace(",",".");var S=parseFloat(c);return isNaN(S)?0:S}catch{return 0}}function p(s){try{return Number(s||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}catch{return Number(s||0).toFixed(2)}}for(var M=window.appState&&Array.isArray(window.appState.transactions)?window.appState.transactions:[],N=window.appState&&Array.isArray(window.appState.categories)?window.appState.categories:[],E=M.filter(function(s){return T(b(s))===l}),re=0,O=0,I=0;I<E.length;I++){var v=E[I],y=v.valor!==null&&v.valor!==void 0?v.valor:v.amount,R=h(y),U=v.tipo||v.type||(R>=0?"receita":"despesa");U==="receita"?re+=Math.abs(R):O+=Math.abs(R)}var A=re-O,_=E.length,V=0;try{var X=window.appState&&window.appState.currentBudget;if(X&&X.valorTotal)V=h(X.valorTotal);else for(var ne=0;ne<N.length;ne++){var B=N[ne];if(B){var me=h(B.limite),ut=B.tipo||"despesa";me>0&&ut==="despesa"&&(V+=me)}}}catch{}for(var xe=Object.create(null),ye=0;ye<E.length;ye++){var Y=E[ye];if((Y.tipo||"despesa")==="despesa"){var Se=Y.categoriaId||Y.categoryId;if(Se){var pt=Math.abs(h(Y.valor!==null&&Y.valor!==void 0?Y.valor:Y.amount));xe[Se]=(xe[Se]||0)+pt}}}for(var se=0,ke=0;ke<N.length;ke++){var Ae=N[ke];if(Ae){var Fe=h(Ae.limite);if(Fe>0){var gt=xe[Ae.id]||0,mt=Fe>0?gt/Fe:0,vt=localStorage.getItem("noti_limit_alerts")==="true";vt&&mt>=.7&&se++}}}for(var He=V>0?Math.min(Math.max(O/V,0),1):0,ie=Object.create(null),q=0;q<E.length;q++){var j=E[q];if((j.tipo||"despesa")==="despesa"){var H=j.categoriaId||j.categoryId||j.categoria&&j.categoria.id||"sem-categoria",ft=h(j.valor!==null&&j.valor!==void 0?j.valor:j.amount);ie[H]=(ie[H]||0)+Math.abs(ft)}}var de=[];for(var H in ie)if(Object.prototype.hasOwnProperty.call(ie,H)){for(var Ge="Outros",B=0;B<N.length;B++)if(N[B].id===H){Ge=N[B].nome||"Outros";break}de.push({id:H,nome:Ge,valor:ie[H]})}de.sort(function(s,c){return c.valor-s.valor}),de.length>5&&(de=de.slice(0,5));var o="";o+='<div class="tab-container">',o+='  <div class="tab-header">',o+='    <h2 class="tab-title-highlight">üìä Dashboard</h2>',o+='    <div id="dash-period-indicator"></div>',o+="  </div>",o+='  <div class="tab-content">',o+='    <div class="content-spacing">',o+='      <div class="mb-8">',o+='        <div class="flex items-center gap-2 mb-4">',o+='          <div class="w-1 h-6 bg-gradient-to-b from-blue-500 to-green-500 rounded-full"></div>',o+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üìà Resumo Financeiro</h2>',o+="        </div>",o+='        <div class="bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-700 rounded-2xl shadow-xl p-6 md:p-8 text-white">',o+='          <div class="flex items-center justify-between mb-6">',o+='            <div><h3 class="text-xl md:text-2xl font-bold">Vis√£o Geral</h3>',o+='            <p class="text-sm opacity-90">'+d+" "+r+" ‚Ä¢ "+String(_)+" transa√ß√µes</p></div>",o+='            <div class="text-right">',o+='              <div class="text-2xl md:text-3xl font-bold '+(A>=0?"text-green-200":"text-red-200")+'">R$ '+p(A)+"</div>",o+='              <p class="text-xs opacity-90">'+(A>=0?"‚úì Saldo Positivo":"‚ö†Ô∏è Saldo Negativo")+"</p>",o+="            </div>",o+="          </div>",o+='          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">',o+='            <div class="rounded-xl p-5 bg-white/15 backdrop-blur-sm flex items-center justify-between">',o+='              <div class="flex items-center gap-3"><span class="text-2xl">üíö</span><span class="text-sm opacity-90">Receitas</span></div>',o+='              <div class="text-2xl md:text-3xl font-bold text-green-200">R$ '+p(re)+"</div>",o+="            </div>",o+='            <div class="rounded-xl p-5 bg-white/15 backdrop-blur-sm flex items-center justify-between">',o+='              <div class="flex items-center gap-3"><span class="text-2xl">üí∏</span><span class="text-sm opacity-90">Despesas</span></div>',o+='              <div class="text-2xl md:text-3xl font-bold text-red-200">R$ '+p(O)+"</div>",o+="            </div>",o+="          </div>",o+='          <div class="mt-4 rounded-xl p-4 bg-white/10 backdrop-blur-sm">',o+='            <div class="flex items-center justify-between mb-2">',o+='              <div class="text-sm font-medium">Progresso do Or√ßamento</div>',o+='              <div class="text-sm font-bold">'+(He*100).toFixed(1)+"%</div>",o+="            </div>",o+='            <div class="w-full bg-white/20 rounded-full h-3 overflow-hidden">',o+='              <div class="bg-white h-3 rounded-full transition-all" style="width:'+Math.min(He*100,100).toFixed(1)+'%"></div>',o+="            </div>",o+='            <div class="flex items-center justify-between text-xs opacity-90 mt-2">',o+="              <span>Despesas: R$ "+p(O)+"</span>",o+="              <span>Or√ßado: R$ "+p(V)+"</span>",o+="            </div>",o+='            <div class="flex items-center justify-between text-xs opacity-90 mt-2">',o+='              <span class="'+(se>0?"cursor-pointer hover:underline bg-red-500/20 px-2 py-0.5 rounded-full":"")+'" '+(se>0?'onclick="window.showCategoriasAlertaModal && window.showCategoriasAlertaModal()"':"")+">"+(se>0?"‚ö†Ô∏è "+se+" alerta(s)":"‚úÖ Tudo OK")+"</span>",o+="              <span>"+(A>=0?"üìà Meta alcan√ßada":"üìâ Revisar gastos")+"</span>",o+="            </div>",o+="          </div>",o+="        </div>",o+="      </div>";try{for(var Je=window.appState&&window.appState.currentBudget&&window.appState.currentBudget.id,u=Object.create(null),Te=0;Te<E.length;Te++){var w=E[Te];if((w.tipo||"despesa")==="despesa"){var wt=w.recorrenteId||w.recorrenteNome;if(wt&&!(w.budgetId&&Je&&w.budgetId!==Je)){var m=w.recorrenteId||"nome:"+(w.recorrenteNome||"Recorrente"),ht=Math.abs(h(w.valor!==null&&w.valor!==void 0?w.valor:w.amount));u[m]||(u[m]={nome:w.recorrenteNome||"Recorrente",total:0,count:0,parcelaAtual:null,parcelasTotal:null,recId:w.recorrenteId||null}),u[m].total+=ht,u[m].count+=1;try{if(w.parcelaAtual!==null&&w.parcelaAtual!==void 0){var Q=Number(w.parcelaAtual);!isNaN(Q)&&Q>0&&(u[m].parcelaAtual=Math.max(u[m].parcelaAtual||0,Q))}if(w.parcelasTotal!==null&&w.parcelasTotal!==void 0){var Z=Number(w.parcelasTotal);!isNaN(Z)&&Z>0&&(u[m].parcelasTotal=Z)}if(!u[m].parcelaAtual)for(var We=["parcela","parcelaAtual","currentInstallment","installment","parcelaAtualNumero"],I=0;I<We.length;I++){var Ee=We[I];if(w[Ee]!==null&&w[Ee]!==void 0){var Ne=Number(w[Ee]);if(!isNaN(Ne)&&Ne>0){u[m].parcelaAtual=Math.max(u[m].parcelaAtual||0,Ne);break}}}if(!u[m].parcelasTotal)for(var Ke=["totalParcelas","parcelasTotal","totalInstallments","installments","parcelasTotalNumero"],q=0;q<Ke.length;q++){var Re=Ke[q];if(w[Re]!==null&&w[Re]!==void 0){var De=Number(w[Re]);if(!isNaN(De)&&De>0){u[m].parcelasTotal=De;break}}}!u[m].parcelaAtual&&u[m].count>0&&(u[m].parcelaAtual=u[m].count,console.log("üîß [Dashboard] Usando count como parcela atual para",u[m].nome,":",u[m].count)),!u[m].parcelasTotal&&u[m].parcelaAtual&&(u[m].count===1?(u[m].parcelasTotal=1,console.log("üîß [Dashboard] Assumindo parcela √∫nica para",u[m].nome)):(u[m].parcelasTotal=Math.max(u[m].parcelaAtual*2,u[m].count),console.log("üîß [Dashboard] Estimando total de parcelas para",u[m].nome,":",u[m].parcelasTotal)))}catch{}}}}var F=[];for(var C in u)Object.prototype.hasOwnProperty.call(u,C)&&((u[C].parcelaAtual||u[C].parcelasTotal)&&console.log("üîç [Dashboard] Recorrente com dados de parcela:",{nome:u[C].nome,parcelaAtual:u[C].parcelaAtual,parcelasTotal:u[C].parcelasTotal,count:u[C].count}),F.push({key:C,nome:u[C].nome,total:u[C].total,count:u[C].count,parcelaAtual:u[C].parcelaAtual,parcelasTotal:u[C].parcelasTotal}));if(F.sort(function(s,c){return c.total-s.total}),F.length>5&&(F=F.slice(0,5)),o+='      <div class="mb-8">',o+='        <div class="flex items-center gap-2 mb-4">',o+='          <div class="w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full"></div>',o+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">‚ôªÔ∏è Top Recorrentes</h2>',o+="        </div>",o+='        <div class="u-card p-4">',!F.length)o+=`          <div class="empty-state">
            <div class="empty-icon">‚ôªÔ∏è</div>
            <div class="empty-text">Sem recorrentes neste per√≠odo</div>
            <div class="empty-description">Despesas recorrentes cadastradas aparecer√£o aqui</div>
          </div>`;else for(var $=0;$<F.length;$++){var Qe="",Ce="";try{if(F[$].parcelaAtual!==null&&F[$].parcelaAtual!==void 0&&F[$].parcelasTotal!==null&&F[$].parcelasTotal!==void 0){var Me=Number(F[$].parcelaAtual),Pe=Number(F[$].parcelasTotal),ve=Pe-Me;if(Qe=' <span class="text-xs text-gray-500">‚Ä¢ '+String(Me)+"/"+String(Pe)+"</span>",ve>0){var Ze=Math.round(Me/Pe*100);Ce='<div class="mt-2"><div class="flex items-center justify-between text-xs text-gray-600 dark:text-gray-400 mb-1"><span>'+(ve===1?"1 parcela restante":ve+" parcelas restantes")+"</span><span>"+Ze+'%</span></div><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5"><div class="bg-emerald-500 h-1.5 rounded-full transition-all duration-300" style="width: '+Ze+'%"></div></div></div>'}else ve===0&&(Ce='<div class="mt-2"><div class="flex items-center justify-between text-xs text-orange-600 dark:text-orange-400 mb-1"><span>Finalizado</span><span>100%</span></div><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5"><div class="bg-orange-500 h-1.5 rounded-full"></div></div></div>')}}catch{}o+='          <div class="py-3 border-b border-gray-100 dark:border-gray-800 last:border-0">',o+='            <div class="flex items-center justify-between">',o+='              <div class="flex-1">',o+='                <div class="font-medium text-gray-900 dark:text-gray-100">'+(F[$].nome||"Recorrente")+' <span class="text-xs text-gray-500">('+String(F[$].count)+")</span>"+Qe+"</div>",o+="                "+Ce,o+="              </div>",o+='              <div class="text-sm font-semibold text-gray-600 dark:text-gray-300 ml-4">R$ '+Number(F[$].total||0).toFixed(2)+"</div>",o+="            </div>",o+="          </div>"}o+="        </div>",o+="      </div>"}catch{}try{for(var $e=[],Ie=0;Ie<N.length;Ie++){var ee=N[Ie];if(ee){for(var et=ee.id,bt=h(ee.limite),xt=ee.tipo||"despesa",tt=0,_e=0;_e<E.length;_e++){var G=E[_e],yt=(G.categoriaId||G.categoryId)===et,St=(G.tipo||"despesa")==="despesa";yt&&St&&(tt+=Math.abs(h(G.valor!==null&&G.valor!==void 0?G.valor:G.amount)))}$e.push({id:et,nome:ee.nome||"Categoria",cor:ee.cor||"#4F46E5",tipo:xt,limite:bt,gasto:tt})}}var Be=$e.filter(function(s){return s.gasto>0&&(s.tipo||"despesa")==="despesa"});Be.sort(function(s,c){return c.gasto-s.gasto});var kt=$e.filter(function(s){return(s.limite||0)>0&&(s.tipo||"despesa")==="despesa"}).map(function(s){var c=Number(s.limite||0),S=c>0?s.gasto/c*100:0;return{...s,porcentagem:S}}).sort(function(s,c){var S=s.gasto>s.limite,D=c.gasto>c.limite;return S&&!D?-1:!S&&D?1:c.gasto-s.gasto});if(o+='      <div class="mb-8">',o+='        <div class="flex items-center gap-2 mb-4">',o+='          <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-pink-500 rounded-full"></div>',o+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üìä Categorias & Limites</h2>',o+="        </div>",o+='        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">',o+='          <div class="u-card overflow-hidden">',o+='            <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-gray-800 dark:to-gray-800 p-4 border-b border-gray-200 dark:border-gray-700">',o+='              <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">üèÜ Top 5 Categorias</h3>',o+='              <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Categorias com maiores gastos</p>',o+="            </div>",o+='            <div class="p-4">',Be.length===0)o+=`              <div class="empty-state">
                <div class="empty-icon">üìÇ</div>
                <div class="empty-text">Nenhuma categoria com gastos</div>
                <div class="empty-description">Suas categorias com despesas aparecer√£o aqui</div>
              </div>`;else for(var At=["ü•á","ü•à","ü•â","4Ô∏è‚É£","5Ô∏è‚É£"],at=Be.slice(0,5),fe=0;fe<at.length;fe++){var te=at[fe],ae=Number(te.limite||0),oe=ae>0?Math.min(te.gasto/ae*100,100):0,le="bg-green-500";oe>=100?le="bg-red-500":oe>=90?le="bg-red-400":oe>=75?le="bg-yellow-500":oe>=50&&(le="bg-orange-500"),o+='              <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-3 border border-gray-200 dark:border-gray-700 mb-3">',o+='                <div class="flex items-center justify-between mb-2">',o+='                  <div class="flex items-center gap-2">',o+='                    <span class="text-lg">'+At[fe]+"</span>",o+='                    <div class="w-3 h-3 rounded-full" style="background-color: '+te.cor+'"></div>',o+='                    <span class="font-medium text-sm text-gray-900 dark:text-gray-100">'+te.nome+"</span>",o+="                  </div>",o+='                  <span class="font-bold text-sm '+(ae>0&&te.gasto>ae?"text-red-600":"text-gray-900 dark:text-gray-100")+'">R$ '+p(te.gasto)+"</span>",o+="                </div>",ae>0?(o+='                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">',o+="                  <span>Limite: R$ "+p(ae)+"</span>",o+="                  <span>"+oe.toFixed(1)+"%</span>",o+="                </div>",o+='                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">',o+='                  <div class="'+le+' h-2 rounded-full transition-all duration-300" style="width: '+oe+'%"></div>',o+="                </div>"):o+='                <p class="text-xs text-gray-500 dark:text-gray-400">Sem limite definido</p>',o+="              </div>"}o+="            </div>",o+="          </div>",o+='          <div class="u-card overflow-hidden">',o+='            <div class="bg-gradient-to-r from-red-50 to-orange-50 dark:from-gray-800 dark:to-gray-800 p-4 border-b border-gray-200 dark:border-gray-700">',o+='              <div class="flex justify-between items-center">',o+="                <div>",o+='                  <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">‚ö†Ô∏è Controle de Limites</h3>',o+='                  <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Categorias com limites definidos</p>',o+="                </div>",o+='                <button onclick="window.showAddCategoryModal && window.showAddCategoryModal()" class="u-btn u-btn--primary mobile-btn">+ Nova</button>',o+="              </div>",o+="            </div>",o+='            <div class="p-4">';var Le=kt;if(!Le.length)o+='              <div class="text-center py-6">',o+='                <div class="text-3xl mb-2">üéØ</div>',o+='                <p class="text-gray-500 dark:text-gray-400 text-sm">Nenhuma categoria com limite definido</p>',o+='                <button onclick="window.showAddCategoryModal && window.showAddCategoryModal()" class="u-btn u-btn--outline mt-2">+ Definir primeiro limite</button>',o+="              </div>";else for(var Ft=Math.min(6,Le.length),je=0;je<Ft;je++){var J=Le[je],ce=Number(J.limite||0),L=ce>0?J.gasto/ce*100:0,ue="bg-green-500",pe="‚úÖ";L>=100?(ue="bg-red-500",pe="üö®"):L>=90?(ue="bg-red-400",pe="‚ö†Ô∏è"):L>=75?(ue="bg-yellow-500",pe="‚ö°"):L>=50&&(ue="bg-orange-500",pe="üìä");var Tt=L>=90?" ring-2 ring-red-200 dark:ring-red-800":"";o+='              <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-3 border border-gray-200 dark:border-gray-700'+Tt+' mb-3">',o+='                <div class="flex items-center justify-between mb-2">',o+='                  <div class="flex items-center gap-2">',o+='                    <span class="text-sm">'+pe+"</span>",o+='                    <div class="w-3 h-3 rounded-full" style="background-color: '+J.cor+'"></div>',o+='                    <span class="font-medium text-sm text-gray-900 dark:text-gray-100">'+J.nome+"</span>",o+="                  </div>",o+='                  <span class="font-bold text-sm '+(J.gasto>ce?"text-red-600":"text-gray-900 dark:text-gray-100")+'">R$ '+p(J.gasto)+"</span>",o+="                </div>",o+='                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">',o+="                  <span>Limite: R$ "+p(ce)+"</span>";var Et=L>=100?"text-red-600 font-bold":L>=90?"text-orange-600 font-medium":"";o+='                  <span class="'+Et+'">'+L.toFixed(1)+"%</span>",o+="                </div>",o+='                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">',o+='                  <div class="'+ue+' h-2 rounded-full transition-all duration-300" style="width: '+Math.min(L,100)+'%"></div>',o+="                </div>",L>=100&&(o+='                <div class="mt-2 text-xs text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 px-2 py-1 rounded">Excedeu em R$ '+p(J.gasto-ce)+"</div>"),o+="              </div>"}o+="            </div>",o+="          </div>",o+="        </div>",o+="      </div>"}catch{}try{var ze=E.slice().sort(function(s,c){var S=b(s)||new Date(0),D=b(c)||new Date(0);return D-S}).slice(0,5);if(o+='      <div class="mb-8">',o+='        <div class="flex items-center gap-2 mb-4">',o+='          <div class="w-1 h-6 bg-gradient-to-b from-green-500 to-blue-500 rounded-full"></div>',o+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üí≥ Atividade Recente</h2>',o+="        </div>",o+='        <div class="u-card overflow-hidden">',o+='          <div class="p-4">',o+='            <div class="flex items-center justify-between mb-4">',o+='              <div class="text-sm font-medium text-gray-700 dark:text-gray-300">√öltimas Transa√ß√µes</div>',o+='              <button onclick="window.showAddTransactionModal && window.showAddTransactionModal()" class="u-btn u-btn--primary mobile-btn">+ Nova Transa√ß√£o</button>',o+="            </div>",ze.length===0)o+=`            <div class="empty-state">
              <div class="empty-icon">üßæ</div>
              <div class="empty-text">Sem transa√ß√µes neste per√≠odo</div>
              <div class="mt-2"><button class="u-btn u-btn--primary" onclick="window.showAddTransactionModal && window.showAddTransactionModal()">Adicionar transa√ß√£o</button></div>
            </div>`;else for(var Oe=0;Oe<ze.length;Oe++){var x=ze[Oe],we=N.find(function(s){return s.id===(x.categoriaId||x.categoryId)}),Nt=(x.tipo||"despesa")==="receita"?"+":"-",Rt=Math.abs(h(x.valor!==null&&x.valor!==void 0?x.valor:x.amount)),ot=b(x),Dt=ot?ot.toLocaleDateString():"",rt="";try{if(x.recorrenteId&&(x.parcelaAtual||x.parcelasTotal)){var Q=x.parcelaAtual!==null&&x.parcelaAtual!==void 0?x.parcelaAtual:"",Z=x.parcelasTotal!==null&&x.parcelasTotal!==void 0?x.parcelasTotal:"";(Q||Z)&&(rt=" ‚Ä¢ "+(Q||"?")+"/"+(Z||"?"))}}catch{}o+='            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-xl mb-2">',o+='              <div class="flex items-center gap-3 min-w-0">',o+='                <div class="w-3 h-3 rounded-full" style="background-color: '+(we&&we.cor||"#6B7280")+'"></div>',o+='                <div class="min-w-0">',o+='                  <div class="font-medium text-gray-900 dark:text-gray-100 truncate">'+(x.descricao||x.description||"Transa√ß√£o")+"</div>",o+='                  <div class="text-xs text-gray-500 dark:text-gray-400">'+(we&&we.nome||"Sem categoria")+" ‚Ä¢ "+Dt+rt+"</div>",o+="                </div>",o+="              </div>",o+='              <div class="font-bold '+((x.tipo||"despesa")==="receita"?"text-green-600":"text-red-600")+'">'+Nt+"R$ "+p(Rt)+"</div>",o+="            </div>"}o+="          </div>",o+="        </div>",o+="      </div>"}catch{}o+="    </div>",o+="  </div>",o+="</div>",t.innerHTML=o;try{lt("#dash-period-indicator")}catch{}try{window.showCategoriasAlertaModal=async function(){try{const D=new Date,Ct=window.appState&&window.appState.selectedYear||D.getFullYear(),Mt=window.appState&&window.appState.selectedMonth||D.getMonth()+1,Pt=String(Ct)+"-"+String(Mt).padStart(2,"0"),nt=(Array.isArray(window.appState?.transactions)?window.appState.transactions:[]).filter(function(k){return T(b(k))===Pt}),Ue=(Array.isArray(window.appState?.categories)?window.appState.categories:[]).filter(function(k){return k&&(k.tipo||"despesa")==="despesa"&&h(k.limite)>0}).map(function(k){for(var W=0,Ve=0;Ve<nt.length;Ve++){var K=nt[Ve];if((K.tipo||"despesa")==="despesa"){var _t=K.categoriaId||K.categoryId;_t===k.id&&(W+=Math.abs(h(K.valor!==null&&K.valor!==void 0?K.valor:K.amount)))}}var Xe=h(k.limite),Bt=Xe>0?W/Xe*100:0;return{id:k.id,nome:k.nome||"Categoria",cor:k.cor||"#4F46E5",limite:Xe,gasto:W,pct:Bt}}).filter(function(k){return k.pct>=70}).sort(function(k,W){return W.pct-k.pct});let ge='<div class="mb-3 text-xs text-gray-600 dark:text-gray-300">Mostrando categorias com uso do limite ‚â• 70% em '+d+" "+r+".</div>";if(!Ue.length)ge+='<div class="text-center py-6">            <div class="text-3xl mb-2">‚úÖ</div>            <div class="text-gray-700 dark:text-gray-200">Nenhuma categoria em alerta</div>          </div>';else{ge+='<div class="space-y-3">';for(var s=0;s<Ue.length;s++){var c=Ue[s],S=c.pct>=100?"bg-red-500":c.pct>=90?"bg-red-400":c.pct>=75?"bg-yellow-500":"bg-orange-500";ge+='              <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700">                <div class="flex items-center justify-between mb-2">                  <div class="flex items-center gap-2">                    <div class="w-3 h-3 rounded-full" style="background-color:'+c.cor+'"></div>                    <span class="font-medium text-sm text-gray-900 dark:text-gray-100">'+c.nome+'</span>                  </div>                  <span class="font-bold text-sm '+(c.pct>=100?"text-red-600":c.pct>=90?"text-orange-600":"text-gray-900 dark:text-gray-100")+'">R$ '+p(c.gasto)+'</span>                </div>                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">                  <span>Limite: R$ '+p(c.limite)+"</span>                  <span>"+c.pct.toFixed(1)+'%</span>                </div>                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">                  <div class="'+S+' h-2 rounded-full" style="width:'+Math.min(c.pct,100).toFixed(1)+'%"></div>                </div>                <div class="mt-1 text-[11px] text-gray-500 dark:text-gray-400">Restante: R$ '+p(Math.max(c.limite-c.gasto,0))+"</div>              </div>"}ge+="</div>"}const{Modal:$t}=await z(async()=>{const{Modal:k}=await import("./main-B-XVfQ8M.js").then(W=>W.a5);return{Modal:k}},__vite__mapDeps([0,1])),It=$t({title:"Categorias em alerta",content:ge,onClose:function(){try{document.getElementById("app-modal")?.remove()}catch{}}});document.body.appendChild(It)}catch(D){console.error("Falha ao abrir modal de categorias em alerta",D);try{alert("Erro ao abrir modal: "+(D?.message||D))}catch{}}}}catch{}}async function ca(e){const t=document.createElement("div");t.className="recorrentes-page";const a=document.createElement("div");a.className="tab-header mb-6",a.innerHTML='<h2 class="tab-title-highlight">‚ôªÔ∏è Recorrentes</h2>',t.appendChild(a);const r=document.createElement("div");r.className="recorrentes-content",r.innerHTML=`
    <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-6">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-lg font-bold text-gray-900 dark:text-white">üîÅ Gerenciar Recorrentes</h3>
  <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="u-btn u-btn--primary mobile-btn">
          ‚ûï Nova Recorrente
        </button>
      </div>
      <div class="text-center py-8">
        <div class="text-4xl mb-4">‚ôªÔ∏è</div>
        <p class="text-gray-600 dark:text-gray-400">P√°gina de recorrentes em desenvolvimento</p>
        <p class="text-sm text-gray-500 dark:text-gray-500 mt-2">Carregando recorrentes...</p>
      </div>
    </div>
  `,t.appendChild(r),e&&(e.innerHTML="",e.appendChild(t)),await be()}async function be(){try{if((window.location.hash||"").split("?")[0]!=="#/recorrentes")return;const t=Date.now();if(window.__lastRecorrentesRender&&t-window.__lastRecorrentesRender<300)return;window.__lastRecorrentesRender=t,await he();const a=document.getElementById("app-content"),{year:r,month:n}=Xt(),i=window.appState?.currentBudget?.id;let d=window.appState.recorrentes||[];i&&(d=d.filter(v=>v.budgetId===i||!v.budgetId)),d=d.slice().sort((v,y)=>String(v.descricao||v.nome||"").localeCompare(String(y.descricao||y.nome||"")));const l=window.appState.transactions||[],b=["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][n-1]||"";let T=d.length,h=0,p=0,M=0,N=0,E=0;for(const v of d){const y=v.ativa!==!1,R=Number(v.valor??0),U=st(v,l,r,n),A=!!U?.foiEfetivadaEsteMes,_=!U?.aposUltimaParcela&&!U?.antesDaPrimeiraParcela;if(A){M+=R,h++,N+=R;continue}y&&_&&(M+=R,p++,E+=R)}const re=h+p,O=typeof window<"u"&&window.innerWidth<=480?"recorrentes-compact":"";a.innerHTML=`
      <div class="tab-container ${O}">
        <div class="tab-header flex items-center justify-between">
          <h2 class="tab-title-highlight">‚ôªÔ∏è Recorrentes</h2>
          <div id="rec-period-indicator"></div>
        </div>
        <div class="tab-content">
          <div class="content-spacing">
            <!-- ========== SE√á√ÉO 1: RESUMO ========== -->
            <div class="mb-8">
              <div class="flex items-center gap-2 mb-4">
                <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-green-500 rounded-full"></div>
                <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üí° Resumo</h2>
              </div>
              <div class="bg-gradient-to-br from-purple-500 via-green-500 to-teal-600 rounded-2xl shadow-xl p-6 md:p-8 text-white mb-6 summary-card">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h3 class="text-xl md:text-2xl font-bold">Vis√£o Geral</h3>
                    <p class="text-xs opacity-90 mt-1">Per√≠odo: ${String(n).padStart(2,"0")}/${r}</p>
                    <button id="rec-summary-toggle" class="text-[11px] underline opacity-90 mt-1 hover:opacity-100 focus:outline-none">Mostrar detalhes</button>
                  </div>
                  <div class="text-right">
                    <div class="text-2xl md:text-3xl font-bold summary-value">R$ ${M.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
                    <p class="text-xs opacity-90">Valor mensal potencial (ativas)</p>
                  </div>
                </div>
                <div id="rec-summary-details" class="hidden text-[12px] md:text-xs opacity-90 bg-white bg-opacity-10 rounded-lg p-3 mb-4">
                  <div class="flex flex-col gap-1">
                    <div>Total de recorrentes cadastradas: <strong>${T}</strong></div>
                    <div class="opacity-90">Dica: use as setas no topo para navegar entre meses.</div>
                  </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div class="bg-white bg-opacity-15 backdrop-blur-sm rounded-xl p-4 text-center">
                    <div class="text-2xl mb-2">‚úÖ</div>
                    <div class="text-2xl md:text-3xl font-bold summary-value">${h}</div>
                    <div class="text-sm opacity-90">Aplicadas no m√™s</div>
                    <div class="text-xs opacity-90 mt-1">R$ ${N.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
                  </div>
                  <div class="bg-white bg-opacity-15 backdrop-blur-sm rounded-xl p-4 text-center">
                    <div class="text-2xl mb-2">‚è≥</div>
                    <div class="text-2xl md:text-3xl font-bold summary-value">${p}</div>
                    <div class="text-sm opacity-90">Pendentes neste m√™s</div>
                    <div class="text-xs opacity-90 mt-1">R$ ${E.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
                  </div>
                  <div class="bg-white bg-opacity-15 backdrop-blur-sm rounded-xl p-4 text-center">
                    <div class="text-2xl mb-2">üü¢</div>
                    <div class="text-2xl md:text-3xl font-bold summary-value">${re}</div>
                    <div class="text-sm opacity-90">Ativas neste m√™s</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="mb-8">
              <div class="flex items-center gap-2 mb-4">
                <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-green-500 rounded-full"></div>
                <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üîß A√ß√µes & Filtros</h2>
              </div>
              <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-4 flex flex-col md:flex-row gap-3 md:gap-4 md:items-center md:justify-between">
                <div class="text-sm text-gray-600 dark:text-gray-400">Per√≠odo selecionado: <strong>${b}/${r}</strong></div>
                <div class="flex gap-2">
                  <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="u-btn u-btn--primary mobile-btn">‚ûï Nova Recorrente</button>
                  <button ${p===0?"disabled":""} onclick="window.efetivarRecorrentesMesAtual && window.efetivarRecorrentesMesAtual()" class="u-btn u-btn--outline mobile-btn" ${p===0?"disabled":""}>
                    ‚ö° Efetivar Pendentes (${p})
                  </button>
                </div>
              </div>
            </div>

            <div class="mb-8">
              <div class="flex items-center gap-2 mb-4">
                <div class="w-1 h-6 bg-gradient-to-b from-green-500 to-teal-500 rounded-full"></div>
                <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üìã Lista de Recorrentes</h2>
              </div>
              <div id="rec-list" class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-4"></div>
            </div>
            </div>
          </div>
        </div>
      </div>
    `;try{const v=a.querySelector(".tab-container"),y="__recResizeHandler";window[y]&&window.removeEventListener("resize",window[y]);const R=()=>{v&&(window.innerWidth<=480?v.classList.add("recorrentes-compact"):v.classList.remove("recorrentes-compact"))};window[y]=R,R(),window.addEventListener("resize",R,{passive:!0})}catch{}try{lt("#rec-period-indicator")}catch{}const I=document.getElementById("rec-list");try{const v=document.getElementById("rec-summary-toggle"),y=document.getElementById("rec-summary-details");v&&y&&v.addEventListener("click",()=>{y.classList.contains("hidden")?(y.classList.remove("hidden"),v.textContent="Ocultar detalhes"):(y.classList.add("hidden"),v.textContent="Mostrar detalhes")})}catch{}if(!d.length)I.innerHTML='<div class="empty-state"><div class="empty-icon">‚ôªÔ∏è</div><div class="empty-text">Nenhuma recorrente cadastrada</div><div class="empty-description">Crie sua primeira recorrente para automatizar lan√ßamentos</div><div class="mt-2"><button class="u-btn u-btn--primary mobile-btn w-full" onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()">‚ûï Nova Recorrente</button></div></div>';else{const v=r,y=n,U=d.map(A=>{const _=st(A,l,v,y);if(_?.aposUltimaParcela||_?.antesDaPrimeiraParcela)return null;const V=A.descricao||A.nome||A.name||A.id,X=A.ativa!==!1,ne=_?.temParcelas?`<span class="ml-2 text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-800">${_.parcelaAtual}/${_.totalParcelas}</span>`:"",B=_?.foiEfetivadaEsteMes?'<span class="text-xs text-green-600 ml-2">aplicada</span>':"",me=Number(A.valor??0).toLocaleString("pt-BR",{minimumFractionDigits:2});return`
          <div class="p-3 rounded border border-gray-200 dark:border-gray-700 flex justify-between items-center mb-2">
            <div class="truncate">
              <div class="font-medium ${X?"":"line-through opacity-70"}">${V}${ne}${B}</div>
              <div class="text-sm text-gray-500">R$ ${me}</div>
            </div>
            <div class="flex items-center gap-2">
              <div class="text-xs ${X?"text-green-600":"text-gray-400"}">${X?"Ativa":"Inativa"}</div>
              <button
                class="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-300 hover:text-gray-900"
                title="Editar"
                onclick="window.editRecorrente && window.editRecorrente('${A.id}')"
                aria-label="Editar recorrente"
              >‚úèÔ∏è</button>
              <button
                class="p-1 rounded hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700"
                title="Apagar"
                onclick="window.deleteRecorrente && window.deleteRecorrente('${A.id}')"
                aria-label="Apagar recorrente"
              >üóëÔ∏è</button>
            </div>
          </div>
        `}).filter(Boolean).join("");I.innerHTML=U||'<div class="empty-state"><div class="empty-icon">üóìÔ∏è</div><div class="empty-text">Nenhuma recorrente neste per√≠odo</div><div class="empty-description">Altere o per√≠odo ou crie uma recorrente v√°lida para este m√™s</div></div>'}}catch(e){console.error("Erro ao renderizar recorrentes:",e)}}function Xt(){try{if(window?.appState?.selectedYear&&window?.appState?.selectedMonth)return{year:window.appState.selectedYear,month:window.appState.selectedMonth}}catch{}const e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1}}try{const e=async()=>{if((window.location.hash||"").split("?")[0]==="#/recorrentes"){try{await he()}catch{}return be()}};f.on("period:changed",()=>queueMicrotask(()=>e())),f.on("budget:changed",()=>queueMicrotask(()=>e())),f.on("transactions:updated",()=>queueMicrotask(()=>e())),f.on("transaction:added",()=>queueMicrotask(()=>e())),f.on("transaction:updated",()=>queueMicrotask(()=>e())),f.on("transaction:deleted",()=>queueMicrotask(()=>e()))}catch{}typeof window<"u"&&(window.efetivarRecorrentesMesAtual=async function(){try{const e=window.appState?.currentUser?.uid,t=window.appState?.currentBudget?.id;if(!e||!t){window.Snackbar?window.Snackbar({message:"Usu√°rio ou or√ßamento n√£o encontrado",type:"error"}):alert("Usu√°rio ou or√ßamento n√£o encontrado");return}const a=new Date,r=window.appState?.selectedYear||a.getFullYear(),n=window.appState?.selectedMonth||a.getMonth()+1,i=await Lt(e,t,!0,r,n);typeof window.loadTransactions=="function"&&await window.loadTransactions(),await he(),window.Snackbar&&(i?.aplicadas>0?window.Snackbar({message:`Efetivadas ${i.aplicadas} recorrentes. ${i.pendentes} pendentes.`,type:"success"}):window.Snackbar({message:"Nenhuma recorrente para efetivar neste m√™s.",type:"info"}));try{const d=window.appState?.currentBudget?.id;f.emit("transactions:updated",{budgetId:d,transactions:window.appState?.transactions||[]})}catch{}try{const d=window.appState?.currentBudget?.id;f.emit("categories:updated",{budgetId:d,categories:window.appState?.categories||[]})}catch{}try{f.emit("recorrentes:updated")}catch{}try{window.renderDashboard&&window.renderDashboard()}catch{}await be()}catch(e){console.error("Erro ao efetivar recorrentes:",e),window.Snackbar?window.Snackbar({message:"Erro ao efetivar recorrentes",type:"error"}):alert("Erro ao efetivar recorrentes")}},window.editRecorrente=function(e){try{const t=(window.appState?.recorrentes||[]).find(a=>a.id===e);if(!t){window.Snackbar?window.Snackbar({message:"Recorrente n√£o encontrada",type:"error"}):alert("Recorrente n√£o encontrada");return}typeof window.showAddRecorrenteModal=="function"&&window.showAddRecorrenteModal(t)}catch(t){console.error("Erro ao editar recorrente:",t)}},window.deleteRecorrente=async function(e){const t=window.appState?.currentUser?.uid;if(!t){window.Snackbar?window.Snackbar({message:"Usu√°rio n√£o autenticado",type:"error"}):alert("Usu√°rio n√£o autenticado");return}if(typeof window.confirm!="function"||window.confirm("Excluir esta recorrente?"))try{await jt(t,e),await he();try{typeof window.loadTransactions=="function"&&await window.loadTransactions()}catch{}window.Snackbar&&window.Snackbar({message:"Recorrente apagada",type:"success"}),await be();try{f.emit("recorrentes:updated")}catch{}}catch(r){console.error("Erro ao excluir recorrente:",r),window.Snackbar?window.Snackbar({message:"Erro ao excluir recorrente",type:"error"}):alert("Erro ao excluir recorrente")}});function ua(){try{if(!window.appState||!window.appState.transactions){window.Snackbar?window.Snackbar({message:"Nenhum dado dispon√≠vel para exportar.",type:"warning"}):alert("Nenhum dado dispon√≠vel para exportar.");return}const e={transactions:window.appState.transactions,categories:window.appState.categories,budgets:window.appState.budgets,recorrentes:window.appState.recorrentes},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download="financeiro-backup.json",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),window.Snackbar&&window.Snackbar({message:"‚úÖ Backup JSON exportado com sucesso!",type:"success"})}catch(e){console.error("‚ùå Erro ao exportar backup:",e),window.Snackbar?window.Snackbar({message:"Erro ao exportar backup: "+e.message,type:"error"}):alert("Erro ao exportar backup: "+e.message)}}async function pa(){try{if(typeof window.XLSX>"u"&&await z(()=>import("https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"),[]),!window.appState||!window.appState.transactions){window.Snackbar?window.Snackbar({message:"Nenhum dado dispon√≠vel para exportar.",type:"warning"}):alert("Nenhum dado dispon√≠vel para exportar.");return}const e=window.XLSX.utils.book_new(),t=window.appState.transactions.map(n=>({Descri√ß√£o:n.descricao,Valor:n.valor,Tipo:n.tipo,Categoria:window.appState.categories.find(i=>i.id===n.categoriaId)?.nome||"",Data:n.createdAt&&n.createdAt.toDate?n.createdAt.toDate().toLocaleDateString():""}));window.XLSX.utils.book_append_sheet(e,window.XLSX.utils.json_to_sheet(t),"Transa√ß√µes");const a=window.appState.categories.map(n=>({Nome:n.nome,Tipo:n.tipo,Limite:n.limite,Cor:n.cor}));window.XLSX.utils.book_append_sheet(e,window.XLSX.utils.json_to_sheet(a),"Categorias");const r=window.appState.budgets.map(n=>({Nome:n.nome,Descri√ß√£o:n.descricao,ID:n.id}));window.XLSX.utils.book_append_sheet(e,window.XLSX.utils.json_to_sheet(r),"Or√ßamentos"),window.XLSX.writeFile(e,"financeiro-dados.xlsx"),window.Snackbar&&window.Snackbar({message:"‚úÖ Arquivo Excel exportado com sucesso!",type:"success"})}catch(e){console.error("‚ùå Erro ao exportar Excel:",e),window.Snackbar?window.Snackbar({message:"Erro ao exportar Excel: "+e.message,type:"error"}):alert("Erro ao exportar Excel: "+e.message)}}async function ga(){try{if(typeof window.jspdf>"u"&&await z(()=>import("https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"),[]),!window.appState||!window.appState.transactions){window.Snackbar?window.Snackbar({message:"Nenhum dado dispon√≠vel para exportar.",type:"warning"}):alert("Nenhum dado dispon√≠vel para exportar.");return}const{jsPDF:e}=window.jspdf,t=new e;let a=10;t.setFontSize(20),t.setFont("helvetica","bold"),t.text("üìä Relat√≥rio Financeiro",10,a),a+=15;const r=window.appState.currentBudget;r&&(t.setFontSize(14),t.setFont("helvetica","bold"),t.text(`Or√ßamento: ${r.nome}`,10,a),a+=8,t.setFontSize(10),t.setFont("helvetica","normal"),t.text(`ID: ${r.id}`,10,a),a+=10);const n=window.appState.transactions.filter(l=>l.tipo==="receita").reduce((l,g)=>l+parseFloat(g.valor),0),i=window.appState.transactions.filter(l=>l.tipo==="despesa").reduce((l,g)=>l+parseFloat(g.valor),0),d=n-i;t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Resumo Geral:",10,a),a+=8,t.setFontSize(10),t.setFont("helvetica","normal"),t.text(`Total Receitas: R$ ${n.toFixed(2)}`,12,a),a+=6,t.text(`Total Despesas: R$ ${i.toFixed(2)}`,12,a),a+=6,t.setFont("helvetica","bold"),t.text(`Saldo: R$ ${d.toFixed(2)}`,12,a),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Transa√ß√µes Recentes:",10,a),a+=8,t.setFontSize(9),t.setFont("helvetica","normal"),window.appState.transactions.sort((l,g)=>new Date(g.createdAt?.toDate?.()||g.createdAt)-new Date(l.createdAt?.toDate?.()||l.createdAt)).slice(0,15).forEach(l=>{const g=window.appState.categories.find(h=>h.id===l.categoriaId)?.nome||"Sem categoria",T=`${l.createdAt?.toDate?.()?l.createdAt.toDate().toLocaleDateString():"Data n√£o dispon√≠vel"} - ${l.descricao} | R$ ${l.valor} | ${l.tipo} | ${g}`;a>270&&(t.addPage(),a=10),t.text(T,12,a),a+=6}),a+=5,t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Gastos por Categoria:",10,a),a+=8,t.setFontSize(9),t.setFont("helvetica","normal"),window.appState.categories.forEach(l=>{const g=window.appState.transactions.filter(b=>b.categoriaId===l.id&&b.tipo==="despesa").reduce((b,T)=>b+parseFloat(T.valor),0);if(g>0){const b=l.limite?` / R$ ${l.limite}`:"",T=l.limite?` (${(g/l.limite*100).toFixed(1)}%)`:"";a>270&&(t.addPage(),a=10),t.text(`${l.nome}: R$ ${g.toFixed(2)}${b}${T}`,12,a),a+=6}}),t.save("relatorio-financeiro.pdf"),window.Snackbar&&window.Snackbar({message:"‚úÖ Relat√≥rio PDF exportado com sucesso!",type:"success"})}catch(e){console.error("‚ùå Erro ao exportar PDF:",e),window.Snackbar?window.Snackbar({message:"Erro ao exportar PDF: "+e.message,type:"error"}):alert("Erro ao exportar PDF: "+e.message)}}function ma(){try{let r=function(n,i,d,l=170){return t.splitTextToSize(n,l).forEach(b=>{d>270&&(t.addPage(),d=10),t.text(b,i,d),d+=6}),d};if(typeof window.jspdf>"u"){console.error("‚ùå Biblioteca jsPDF n√£o est√° dispon√≠vel"),window.Snackbar?window.Snackbar({message:"Erro: Biblioteca jsPDF n√£o est√° carregada. Tente recarregar a p√°gina.",type:"error"}):alert("Erro: Biblioteca jsPDF n√£o est√° carregada. Tente recarregar a p√°gina.");return}const{jsPDF:e}=window.jspdf,t=new e;let a=10;t.setFontSize(24),t.setFont("helvetica","bold"),t.setFillColor(79,70,229),t.rect(0,0,210,40,"F"),t.setTextColor(255,255,255),t.text("Controle Financeiro",20,25),t.setFontSize(14),t.text("Guia Completo de Uso",20,35),a=50,t.setFontSize(12),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),a=r("üéØ Como Usar o Aplicativo",20,a),t.setFontSize(10),t.setFont("helvetica","normal"),a=r("1. Fa√ßa login com sua conta Google",25,a),a=r("2. Crie categorias para organizar suas despesas e receitas",25,a),a=r("3. Adicione transa√ß√µes usando o bot√£o + ou comandos de voz",25,a),a=r("4. Configure despesas recorrentes para pagamentos fixos",25,a),a=r("5. Monitore seu saldo e gastos no dashboard",25,a),a+=10,t.setFontSize(12),t.setFont("helvetica","bold"),a=r("üé§ Comandos de Voz Dispon√≠veis",20,a),t.setFontSize(10),t.setFont("helvetica","normal"),a=r('‚Ä¢ "gastei 50 reais no supermercado em alimenta√ß√£o"',25,a),a=r('‚Ä¢ "recebi 2000 de sal√°rio em rendimentos"',25,a),a=r('‚Ä¢ "criar categoria alimenta√ß√£o despesa 500"',25,a),a=r('‚Ä¢ "qual meu saldo"',25,a),a=r('‚Ä¢ "mostrar transa√ß√µes"',25,a),a+=10,t.setFontSize(12),t.setFont("helvetica","bold"),a=r("üìä Funcionalidades Principais",20,a),t.setFontSize(10),t.setFont("helvetica","normal"),a=r("‚Ä¢ Dashboard com resumo financeiro",25,a),a=r("‚Ä¢ Gest√£o de transa√ß√µes e categorias",25,a),a=r("‚Ä¢ Sistema de despesas recorrentes",25,a),a=r("‚Ä¢ Alertas de limite de categoria",25,a),a=r("‚Ä¢ Backup e exporta√ß√£o de dados",25,a),a=r("‚Ä¢ Interface responsiva para mobile",25,a),a+=10,t.setFontSize(12),t.setFont("helvetica","bold"),a=r("üíæ Backup e Exporta√ß√£o",20,a),t.setFontSize(10),t.setFont("helvetica","normal"),a=r("‚Ä¢ Exporta√ß√£o em JSON para backup completo",25,a),a=r("‚Ä¢ Exporta√ß√£o em Excel para relat√≥rios",25,a),a=r("‚Ä¢ Exporta√ß√£o em PDF para documenta√ß√£o",25,a),a=r("‚Ä¢ Restaura√ß√£o de dados de backup",25,a),a+=10,t.setFontSize(12),t.setFont("helvetica","bold"),a=r("üîß Suporte e Contato",20,a),t.setFontSize(10),t.setFont("helvetica","normal"),a=r("Para d√∫vidas ou problemas:",25,a),a=r("‚Ä¢ Verifique os logs do console (F12)",30,a),a=r("‚Ä¢ Teste em diferentes navegadores",30,a),a=r("‚Ä¢ Consulte a documenta√ß√£o t√©cnica",30,a),t.save("guia-servo-tech-financas.pdf"),window.Snackbar&&window.Snackbar({message:"‚úÖ Guia PDF exportado com sucesso!",type:"success"})}catch(e){console.error("‚ùå Erro ao exportar guia PDF:",e),window.Snackbar?window.Snackbar({message:"Erro ao exportar guia PDF: "+e.message,type:"error"}):alert("Erro ao exportar guia PDF: "+e.message)}}function va(){console.log("üîç showExportOptions chamada"),z(async()=>{const{Modal:e}=await import("./index-CvbvzAkH.js").then(t=>t.i);return{Modal:e}},__vite__mapDeps([2,0,1,3])).then(({Modal:e})=>{e({title:"üì§ Op√ß√µes de Exporta√ß√£o",content:`
        <div class="space-y-4">
          <button onclick="window.downloadBackup && window.downloadBackup()" class="w-full u-btn u-btn--primary">
            <span class="icon-standard">üíæ</span>
            Backup JSON Completo
          </button>
          <button onclick="window.exportToExcel && window.exportToExcel()" class="w-full u-btn u-btn--outline">
            <span class="icon-standard">üìä</span>
            Exportar para Excel
          </button>
          <button onclick="window.exportToPDF && window.exportToPDF()" class="w-full u-btn u-btn--outline">
            <span class="icon-standard">üìÑ</span>
            Exportar para PDF
          </button>
          <button onclick="window.exportReadmePDF && window.exportReadmePDF()" class="w-full u-btn u-btn--outline">
            <span class="icon-standard">üìñ</span>
            Guia de Uso (PDF)
          </button>
        </div>
      `})}).catch(()=>{alert("Abra as op√ß√µes de exporta√ß√£o nas configura√ß√µes.")})}function fa(){try{"scrollRestoration"in history&&(history.scrollRestoration="manual")}catch{}const e=n=>{const i=(n||"").split("?")[0];return i&&i.startsWith("/")?i:"/dashboard"},t=["/dashboard","/transactions","/categories","/analytics","/recorrentes","/notifications","/settings"];document.addEventListener("keydown",n=>{if(!(n.target.tagName==="INPUT"||n.target.tagName==="TEXTAREA"))switch(n.key){case"ArrowLeft":n.preventDefault(),a("prev");break;case"ArrowRight":n.preventDefault(),a("next");break}});function a(n){const i=t.indexOf(e(window.location.hash.slice(1)));if(i===-1)return;let d;n==="next"?d=(i+1)%t.length:d=i===0?t.length-1:i-1;const l=t[d];window.location.hash=l,r(l)}function r(n){const d={"/dashboard":"Dashboard","/transactions":"Transa√ß√µes","/categories":"Categorias","/analytics":"An√°lises","/recorrentes":"Recorrentes","/notifications":"Notifica√ß√µes","/settings":"Configura√ß√µes"}[n]||"Dashboard";document.title=`Financeiro - ${d}`}}async function Yt(){try{const e=new zt;return(await Ot(qe,e)).user}catch(e){throw e.code==="auth/cancelled-popup-request"?it({message:"Login cancelado. Tente novamente.",type:"info"}):it({message:"Erro ao fazer login: "+e.message,type:"error"}),e}}function wa(){const e=document.getElementById("btn-entrar");if(e){if(e.dataset.bound==="1")return;e.dataset.bound="1",e.style.pointerEvents="auto",e.disabled=!1,e.tabIndex=0,console.log("üîê Bot√£o de login pronto para clique"),e.addEventListener("click",async()=>{console.log("üîê Clique no bot√£o de login detectado");try{typeof window.showLoading=="function"&&window.showLoading(!0);const t=await Yt();if(t){try{const{ensureUserProfile:a}=await z(async()=>{const{ensureUserProfile:r}=await import("./main-B-XVfQ8M.js").then(n=>n.a6);return{ensureUserProfile:r}},__vite__mapDeps([0,1]));await a(t)}catch{}window.appState.currentUser=t,Ye(!1);try{console.log("üìä Carregando dados do usu√°rio ap√≥s login..."),await Ut(t),console.log("‚úÖ Dados carregados com sucesso ap√≥s login")}catch(a){console.error("‚ùå Erro ao carregar dados ap√≥s login:",a)}try{const{renderPage:a}=await z(async()=>{const{renderPage:r}=await import("./main-B-XVfQ8M.js").then(n=>n.a9);return{renderPage:r}},__vite__mapDeps([0,1]));window.location.hash="#/dashboard",await a("/dashboard")}catch{console.warn("‚ö†Ô∏è Router n√£o dispon√≠vel, usando fallback"),window.location.hash="#/dashboard"}}}catch(t){console.error("Erro no login:",t),typeof window.showLoading=="function"&&window.showLoading(!1)}})}}function ha(){return new Promise(e=>{let t=!0;qe.onAuthStateChanged(a=>{a?(console.log("‚úÖ Usu√°rio autenticado:",a.email),window.appState.currentUser=a,Ye(!1),t&&(t=!1,e(!0))):(console.log("‚ùå Usu√°rio n√£o autenticado"),window.appState.currentUser=null,typeof window.stopAllListeners=="function"&&window.stopAllListeners(),window.appState&&(window.appState.currentBudget=null,window.appState.transactions=[],window.appState.categories=[],window.appState.recorrentes=[],window.appState.notifications=[]),Ye(!0),t&&(t=!1,e(!1)))})})}async function ba(){try{await qe.signOut(),console.log("‚úÖ Logout realizado com sucesso")}catch(e){console.error("‚ùå Erro ao fazer logout:",e)}}function Ye(e){const t=document.getElementById("login-page"),a=document.getElementById("app-content");t&&a&&(e?(t.style.display="flex",a.style.display="none"):(t.style.display="none",a.style.display="block"))}async function xa(){console.log("üöÄ Inicializando aplica√ß√£o...");try{if(window.appState?.isInitialized){console.log("‚úÖ Aplica√ß√£o j√° inicializada");return}if(window.appState?.currentUser){console.log("‚úÖ Usu√°rio j√° autenticado, configurando aplica√ß√£o..."),await qt();try{const e=new Date,t=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`,a=localStorage.getItem("recorrentes:lastAutoApplied");if(e.getDate()===1&&a!==t){const n=window.appState?.currentUser?.uid,i=window.appState?.currentBudget?.id;if(n&&i){const{aplicarRecorrentesDoMes:d,loadRecorrentes:l}=await z(async()=>{const{aplicarRecorrentesDoMes:b,loadRecorrentes:T}=await import("./main-B-XVfQ8M.js").then(h=>h.a3);return{aplicarRecorrentesDoMes:b,loadRecorrentes:T}},__vite__mapDeps([0,1])),g=await d(n,i,!0);typeof window.loadTransactions=="function"&&await window.loadTransactions(),await l();try{f.emit("transactions:updated")}catch{}try{f.emit("categories:updated")}catch{}try{f.emit("recorrentes:updated")}catch{}localStorage.setItem("recorrentes:lastAutoApplied",t),g?.aplicadas>0&&window.Snackbar&&window.Snackbar({message:`Recorrentes do m√™s aplicadas automaticamente (${g.aplicadas}).`,type:"info"})}}}catch(e){console.warn("Falha ao auto-aplicar recorrentes:",e)}Ht(),console.log("‚úÖ Aplica√ß√£o inicializada com sucesso")}else console.log("‚è≥ Aguardando autentica√ß√£o do usu√°rio...")}catch(e){console.error("‚ùå Erro ao inicializar aplica√ß√£o:",e)}}async function qt(){try{console.log("üìä Carregando dados iniciais...");const e=window.appState?.currentUser?.uid;if(!e){console.warn("‚ö†Ô∏è Usu√°rio n√£o autenticado, pulando carregamento de dados");return}const{loadUserBudgets:t}=await z(async()=>{const{loadUserBudgets:r}=await import("./main-B-XVfQ8M.js").then(n=>n.a8);return{loadUserBudgets:r}},__vite__mapDeps([0,1]));await t(e);const{selectDefaultBudget:a}=await z(async()=>{const{selectDefaultBudget:r}=await import("./main-B-XVfQ8M.js").then(n=>n.a8);return{selectDefaultBudget:r}},__vite__mapDeps([0,1]));await a(e),typeof window.loadTransactions=="function"&&await window.loadTransactions(),typeof window.loadCategories=="function"&&await window.loadCategories(),typeof window.loadRecorrentes=="function"&&await window.loadRecorrentes(),typeof window.loadNotifications=="function"&&await window.loadNotifications(),typeof window.listenNotifications=="function"&&await window.listenNotifications(),window.appState.currentBudget?.id&&typeof window.startAllListeners=="function"&&await window.startAllListeners(window.appState.currentBudget.id),console.log("‚úÖ Dados iniciais carregados com sucesso")}catch(e){console.error("‚ùå Erro ao carregar dados iniciais:",e)}}function Ht(){console.log("üîß Configurando event listeners..."),f.on("transaction:added",Gt),f.on("transaction:updated",Jt),f.on("transaction:deleted",Wt),f.on("category:added",Kt),f.on("category:updated",Qt),f.on("category:deleted",Zt),f.on("budget:changed",ea),console.log("‚úÖ Event listeners configurados")}function Gt(e){console.log("üìù Nova transa√ß√£o adicionada:",e)}function Jt(e){console.log("üìù Transa√ß√£o atualizada:",e)}function Wt(e){console.log("üóëÔ∏è Transa√ß√£o deletada:",e)}function Kt(e){console.log("üìÇ Nova categoria adicionada:",e)}function Qt(e){console.log("üìÇ Categoria atualizada:",e)}function Zt(e){console.log("üóëÔ∏è Categoria deletada:",e)}function ea(e){console.log("üí∞ Or√ßamento alterado:",e)}function ya(e,t="BRL"){if(e==null||isNaN(e))return"R$ 0,00";try{return new Intl.NumberFormat("pt-BR",{style:"currency",currency:t}).format(e)}catch(a){return console.error("‚ùå Erro ao formatar moeda:",a),`R$ ${e.toFixed(2).replace(".",",")}`}}function Sa(e,t={}){if(!e)return"";try{const a={year:"numeric",month:"2-digit",day:"2-digit",...t},r=new Date(e);return isNaN(r.getTime())?"":new Intl.DateTimeFormat("pt-BR",a).format(r)}catch(a){return console.error("‚ùå Erro ao formatar data:",a),""}}function ka(e,t){return!t||t===0?0:Math.round(e/t*100)}function Aa(e){return e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():""}function Fa(e,t){let a;return function(...n){const i=()=>{clearTimeout(a),e(...n)};clearTimeout(a),a=setTimeout(i,t)}}function Ta(e,t){let a;return function(){const r=arguments,n=this;a||(e.apply(n,r),a=!0,setTimeout(()=>a=!1,t))}}function Ea(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function Na(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Ra(e){return e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():""}function Da(e,t=50){return!e||e.length<=t?e:e.substring(0,t)+"..."}function Ca(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Ma(e){return Math.round((e+Number.EPSILON)*100)/100}function Pa(e){const t=[];if(!e.descricao||e.descricao.trim().length===0?t.push("Descri√ß√£o √© obrigat√≥ria"):e.descricao.trim().length<3&&t.push("Descri√ß√£o deve ter pelo menos 3 caracteres"),!e.valor||isNaN(e.valor)?t.push("Valor deve ser um n√∫mero v√°lido"):e.valor<=0&&t.push("Valor deve ser maior que zero"),(!e.tipo||!["receita","despesa"].includes(e.tipo))&&t.push('Tipo deve ser "receita" ou "despesa"'),e.categoriaId||t.push("Categoria √© obrigat√≥ria"),e.data){const a=new Date(e.data);isNaN(a.getTime())&&t.push("Data deve ser v√°lida")}return{isValid:t.length===0,errors:t}}function $a(e){const t=[];return!e.nome||e.nome.trim().length===0?t.push("Nome da categoria √© obrigat√≥rio"):e.nome.trim().length<2&&t.push("Nome da categoria deve ter pelo menos 2 caracteres"),(!e.tipo||!["receita","despesa"].includes(e.tipo))&&t.push('Tipo deve ser "receita" ou "despesa"'),e.limite!==void 0&&e.limite!==null&&(isNaN(e.limite)?t.push("Limite deve ser um n√∫mero v√°lido"):e.limite<0&&t.push("Limite n√£o pode ser negativo")),e.cor&&!ta(e.cor)&&t.push("Cor deve ser um c√≥digo de cor v√°lido"),{isValid:t.length===0,errors:t}}function Ia(e){const t=[];return!e.nome||e.nome.trim().length===0?t.push("Nome do or√ßamento √© obrigat√≥rio"):e.nome.trim().length<3&&t.push("Nome do or√ßamento deve ter pelo menos 3 caracteres"),!e.valorTotal||isNaN(e.valorTotal)?t.push("Valor total deve ser um n√∫mero v√°lido"):e.valorTotal<=0&&t.push("Valor total deve ser maior que zero"),e.periodo&&!["mensal","semanal","anual"].includes(e.periodo)&&t.push('Per√≠odo deve ser "mensal", "semanal" ou "anual"'),{isValid:t.length===0,errors:t}}function _a(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Ba(e){const t=[];return(!e||e.length<6)&&t.push("Senha deve ter pelo menos 6 caracteres"),/[A-Z]/.test(e)||t.push("Senha deve conter pelo menos uma letra mai√∫scula"),/[a-z]/.test(e)||t.push("Senha deve conter pelo menos uma letra min√∫scula"),/\d/.test(e)||t.push("Senha deve conter pelo menos um n√∫mero"),{isValid:t.length===0,errors:t}}function La(e){if(e=e.replace(/[^\d]/g,""),e.length!==11||/^(\d)\1{10}$/.test(e))return!1;let t=0;for(let i=0;i<9;i++)t+=parseInt(e.charAt(i))*(10-i);let a=t%11,r=a<2?0:11-a;t=0;for(let i=0;i<10;i++)t+=parseInt(e.charAt(i))*(11-i);a=t%11;let n=a<2?0:11-a;return parseInt(e.charAt(9))===r&&parseInt(e.charAt(10))===n}function ta(e){const t=new Option().style;return t.color=e,t.color!==""}function ja(e){return e=e.replace(/[^\d]/g,""),e.length>=10&&e.length<=11}function za(e){try{const t=window.appState.budgets.find(d=>d.id===e);if(!t)return{receitas:0,despesas:0,saldo:0};const a=window.appState.transactions.filter(d=>d.budgetId===e),r=a.filter(d=>d.tipo==="receita").reduce((d,l)=>d+(l.valor||0),0),n=a.filter(d=>d.tipo==="despesa").reduce((d,l)=>d+(l.valor||0),0),i=r-n;return{receitas:P(r),despesas:P(n),saldo:P(i),orcado:t.valorTotal||0}}catch(t){return console.error("‚ùå Erro ao calcular saldo do or√ßamento:",t),{receitas:0,despesas:0,saldo:0,orcado:0}}}function Oa(e,t=null){try{let a=window.appState.transactions.filter(n=>n.budgetId===e);if(t){const n=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0");a=a.filter(i=>(i.data?new Date(i.data).getFullYear()+"-"+String(new Date(i.data).getMonth()+1).padStart(2,"0"):new Date().getFullYear()+"-"+String(new Date().getMonth()+1).padStart(2,"0"))===n)}const r={};return a.forEach(n=>{const i=n.categoriaId,d=window.appState.categories.find(l=>l.id===i);d&&(r[i]||(r[i]={id:i,nome:d.nome,cor:d.cor,tipo:d.tipo,receitas:0,despesas:0,total:0}),n.tipo==="receita"?r[i].receitas+=n.valor||0:r[i].despesas+=n.valor||0,r[i].total=r[i].receitas-r[i].despesas)}),Object.values(r).map(n=>({...n,receitas:P(n.receitas),despesas:P(n.despesas),total:P(n.total)})).sort((n,i)=>Math.abs(i.total)-Math.abs(n.total))}catch(a){return console.error("‚ùå Erro ao calcular totais por categoria:",a),[]}}function ct(e,t=6){try{const a=[],r=new Date;for(let n=0;n<t;n++){const i=new Date(r.getFullYear(),r.getMonth()-n,1),d=i.getFullYear()+"-"+String(i.getMonth()+1).padStart(2,"0"),l=i.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),g=window.appState.transactions.filter(p=>{if(p.budgetId!==e||!p.data)return!1;const M=new Date(p.data);return M.getFullYear()+"-"+String(M.getMonth()+1).padStart(2,"0")===d}),b=g.filter(p=>p.tipo==="receita").reduce((p,M)=>p+(M.valor||0),0),T=g.filter(p=>p.tipo==="despesa").reduce((p,M)=>p+(M.valor||0),0),h=b-T;a.push({month:d,monthName:l,receitas:P(b),despesas:P(T),saldo:P(h),transactionCount:g.length})}return a.reverse()}catch(a){return console.error("‚ùå Erro ao calcular estat√≠sticas mensais:",a),[]}}function Ua(e,t=3){try{const a=ct(e,t);if(a.length<2)return{trend:"estavel",percentage:0};const r=a[a.length-1],n=a[a.length-2];if(n.saldo===0)return{trend:"estavel",percentage:0};const i=(r.saldo-n.saldo)/Math.abs(n.saldo)*100;let d="estavel";return i>5?d="crescimento":i<-5&&(d="declinio"),{trend:d,percentage:P(i),change:P(r.saldo-n.saldo)}}catch(a){return console.error("‚ùå Erro ao calcular tend√™ncias:",a),{trend:"estavel",percentage:0}}}function Va(e,t=3){try{const a=ct(e,t);if(a.length<2)return null;const r=[];for(let l=1;l<a.length;l++){const g=a[l].saldo-a[l-1].saldo;r.push(g)}const n=r.reduce((l,g)=>l+g,0)/r.length,i=a[a.length-1].saldo,d=[];for(let l=1;l<=t;l++){const g=i+n*l;d.push({month:l,projectedSaldo:P(g),confidence:Math.max(0,100-l*20)})}return d}catch(a){return console.error("‚ùå Erro ao calcular proje√ß√µes:",a),null}}function P(e){return Math.round((e+Number.EPSILON)*100)/100}export{qa as addTransactionWithNotifications,Ha as applyCompactMode,Ga as applyCurrentTheme,Ja as applyTheme,Wa as applyThemeSettings,no as calcularNumeroParcela,za as calculateBudgetBalance,Oa as calculateCategoryTotals,ct as calculateMonthlyStats,ka as calculatePercentage,Va as calculateProjections,Ua as calculateTrends,Ra as capitalizeFirst,ha as checkAuthState,jo as closeVoiceModal,so as collapseAllDays,Fa as debounce,Ka as deleteTransactionWithNotifications,ua as downloadBackup,io as expandAllDays,ma as exportReadmePDF,pa as exportToExcel,ga as exportToPDF,ya as formatCurrency,Sa as formatDate,lo as formatTransactionDisplayDate,Ea as generateId,co as getCollapsedDays,Qa as getCurrentCompactMode,Za as getCurrentTheme,uo as getTransactionDate,po as getTransactionYearMonth,zo as getVoiceSystem,xa as initializeApp,go as isDayCollapsed,Ca as isNumeric,Na as isValidEmail,Mo as leaveSharedBudget,mo as loadAllOlderMonths,vo as loadMonthSection,ba as logout,Oo as normalizarTexto,Aa as normalizeText,Uo as openVoiceModal,Vo as parseNumeroPorExtenso,Xo as processCategoryVoice,Yo as processTransactionVoice,qo as processVoiceCommand,Po as removeUserFromBudget,To as renderAllCategories,fo as renderAllTransactions,Jo as renderBottomNav,Eo as renderCategories,Vt as renderDashboard,Wo as renderFAB,No as renderFilteredCategories,wo as renderFilteredTransactions,ho as renderMonthSectionHTML,Do as renderNotifications,bo as renderOlderMonthsControl,ca as renderRecorrentes,xo as renderTransactionItemHTML,yo as renderTransactions,So as renderTransactionsGroupedByDay,Ko as resetScrollPosition,Ma as roundToTwoDecimals,ko as saveCollapsedDays,$o as sendCategoryChangeNotification,Io as sendTransactionDeletedNotification,_o as sendTransactionNotification,Bo as sendTransactionUpdatedNotification,Qo as setupCategoryButtons,Zo as setupDashboardButtons,Ht as setupEventListeners,er as setupHeaderButtons,wa as setupLoginButton,fa as setupNavigation,eo as setupThemeToggle,tr as setupTransactionButtons,va as showExportOptions,ar as showLoading,Ho as startVoiceRecognition,Ta as throttle,to as toggleCompactMode,Ao as toggleDayGroup,Ye as toggleLoginPage,ao as toggleTheme,Da as truncateText,oo as updateTransactionWithNotifications,Ia as validateBudget,La as validateCPF,$a as validateCategory,_a as validateEmail,Ba as validatePassword,ja as validatePhone,Pa as validateTransaction};

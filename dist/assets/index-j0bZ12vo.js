const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main--Xl17bQY.js","assets/main-CDeWMlCH.css","assets/index-CBMCDw62.js","assets/PeriodIndicator-BqYBhOIH.js"])))=>i.map(i=>d[i]);
import{e as b,_ as re,i as De,H as yt,I as Zt,J as ea}from"./main--Xl17bQY.js";import{K as or,T as sr,R as nr,Q as ir,X as dr,N as lr,W as cr,V as ur,O as pr,U as gr,P as mr,L as vr}from"./main--Xl17bQY.js";import{mountPeriodIndicator as Et}from"./PeriodIndicator-BqYBhOIH.js";import{calcularNumeroParcela as xr,collapseAllDays as br,expandAllDays as hr,formatTransactionDisplayDate as wr,getCollapsedDays as yr,getTransactionDate as Sr,getTransactionYearMonth as kr,isDayCollapsed as Er,loadAllOlderMonths as Rr,loadMonthSection as Ar,renderAllTransactions as Fr,renderFilteredTransactions as Dr,renderMonthSectionHTML as Tr,renderOlderMonthsControl as Mr,renderTransactionItemHTML as Cr,renderTransactions as Nr,renderTransactionsGroupedByDay as $r,saveCollapsedDays as Lr,toggleDayGroup as Or}from"./TransactionsPage-Di8kc16t.js";import{renderAllCategories as Ir,renderCategories as jr,renderFilteredCategories as _r}from"./CategoriesPage-10yRyAmn.js";import{renderNotifications as Br}from"./NotificationsPage-D-L_LBoE.js";import{leaveSharedBudget as Xr,removeUserFromBudget as Hr,sendCategoryChangeNotification as qr,sendTransactionDeletedNotification as Gr,sendTransactionNotification as Yr,sendTransactionUpdatedNotification as Ur}from"./NotificationService-BIbVydGr.js";import{closeVoiceModal as Wr,getVoiceSystem as Kr,normalizarTexto as Qr,openVoiceModal as Zr,parseNumeroPorExtenso as eo,processCategoryVoice as to,processTransactionVoice as ao,processVoiceCommand as ro,startVoiceRecognition as oo}from"./VoiceService-F1rMbtYP.js";import{b as no,r as io,d as lo,a as co,f as uo,e as po,s as go,c as mo}from"./UIService-CAdhZLUq.js";import{checkAuthState as fo,logout as xo,setupLoginButton as bo,toggleLoginPage as ho}from"./AuthService-DcKGgsih.js";import"./perf-tobPnqr4.js";import"./NotificationModal-D7OVBJPQ.js";import"./VoiceSystem-CEBe8orV.js";function ta(){const r=window.categoriasEmAlerta||[];if(r.length===0){aa();return}ra(r)}function aa(){document.body.insertAdjacentHTML("beforeend",`
    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden">
        <!-- Header -->
        <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-4 text-white">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                <span class="text-xl">‚úÖ</span>
              </div>
              <div>
                <h3 class="text-lg font-bold">Nenhum Alerta</h3>
                <p class="text-green-100 text-sm">Todas as categorias est√£o dentro dos limites</p>
              </div>
            </div>
            <button class="close-modal-btn text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors">
              <span class="text-xl">√ó</span>
            </button>
          </div>
        </div>
        
        <!-- Content -->
        <div class="p-6">
          <div class="text-center">
            <div class="w-16 h-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-3xl">üéâ</span>
            </div>
            <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-2">
              Parab√©ns!
            </h4>
            <p class="text-gray-600 dark:text-gray-400 text-sm">
              Todas as suas categorias est√£o dentro dos limites estabelecidos. 
              Continue controlando seus gastos!
            </p>
          </div>
        </div>
        
        <!-- Footer -->
        <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4">
          <button class="close-modal-btn w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors">
            Fechar
          </button>
        </div>
      </div>
    </div>
  `),Rt()}function ra(r){r.sort((o,s)=>s.percentual-o.percentual);const e=r.map(o=>{const s=o.percentual>=1,n=s?"red":"orange",i=s?"üö®":"‚ö†Ô∏è",d=s?"Limite ultrapassado":"Pr√≥ximo do limite";return`
      <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-${n}-100 dark:bg-${n}-900 rounded-full flex items-center justify-center">
              <span class="text-sm">${i}</span>
            </div>
            <div>
              <h5 class="font-semibold text-gray-800 dark:text-gray-200">${o.nome}</h5>
              <p class="text-xs text-${n}-600 dark:text-${n}-400">${d}</p>
            </div>
          </div>
          <div class="text-right">
            <div class="text-lg font-bold text-${n}-600 dark:text-${n}-400">
              ${o.percentualFormatado}
            </div>
          </div>
        </div>
        
        <!-- Barra de progresso -->
        <div class="mb-3">
          <div class="flex justify-between text-xs text-gray-600 dark:text-gray-400 mb-1">
            <span>Gasto: R$ ${o.gasto.toFixed(2)}</span>
            <span>Limite: R$ ${o.limite.toFixed(2)}</span>
          </div>
          <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
            <div class="bg-${n}-500 h-2 rounded-full transition-all duration-300" 
                 style="width: ${Math.min(o.percentual*100,100)}%"></div>
          </div>
        </div>
        
        <!-- Informa√ß√µes adicionais -->
        <div class="text-xs text-gray-500 dark:text-gray-400">
          ${s?`Ultrapassou o limite em R$ ${(o.gasto-o.limite).toFixed(2)}`:`Restam R$ ${(o.limite-o.gasto).toFixed(2)} do limite`}
        </div>
      </div>
    `}).join(""),a=`
    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-hidden">
        <!-- Header -->
        <div class="bg-gradient-to-r from-red-500 to-orange-600 p-4 text-white">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                <span class="text-xl">üö®</span>
              </div>
              <div>
                <h3 class="text-lg font-bold">Categorias em Alerta</h3>
                <p class="text-red-100 text-sm">${r.length} categoria(s) precisam de aten√ß√£o</p>
              </div>
            </div>
            <button class="close-modal-btn text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors">
              <span class="text-xl">√ó</span>
            </button>
          </div>
        </div>
        
        <!-- Content -->
        <div class="p-6 overflow-y-auto max-h-[60vh]">
          <div class="space-y-4">
            ${e}
          </div>
          
          <!-- Dica -->
          <div class="mt-6 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4">
            <div class="flex items-start gap-3">
              <span class="text-blue-600 dark:text-blue-400 text-lg">üí°</span>
              <div>
                <h5 class="font-semibold text-blue-800 dark:text-blue-200 text-sm mb-1">
                  Dica
                </h5>
                <p class="text-blue-700 dark:text-blue-300 text-xs">
                  Categorias com mais de 70% do limite gasto s√£o consideradas em alerta. 
                  Revise seus gastos para evitar ultrapassar os limites.
                </p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Footer -->
        <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4">
          <button class="close-modal-btn w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors">
            Fechar
          </button>
        </div>
      </div>
    </div>
  `;document.body.insertAdjacentHTML("beforeend",a),Rt()}function Rt(){document.querySelectorAll(".close-modal-btn").forEach(o=>{o.addEventListener("click",et)});const e=document.querySelector(".fixed.inset-0");e&&e.addEventListener("click",o=>{o.target===e&&et()});const a=o=>{o.key==="Escape"&&et()};document.addEventListener("keydown",a),window.currentModalEscHandler=a}function et(){const r=document.querySelector(".fixed.inset-0");r&&r.remove(),window.currentModalEscHandler&&(document.removeEventListener("keydown",window.currentModalEscHandler),window.currentModalEscHandler=null)}function tt(){document.addEventListener("click",r=>{const e=r.target;(e.id==="alertas-categorias-btn"||e.closest("#alertas-categorias-btn"))&&(r.preventDefault(),r.stopPropagation(),console.log("üîç [Dashboard] Clique no bot√£o de alertas de categorias"),ta())})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",tt):tt();class St{constructor(){this.draggedElement=null,this.dragOverElement=null,this.cardOrder=this.loadCardOrder(),this.init()}init(){this.setupDragAndDrop(),this.setupExportButtons(),this.setupResetButton()}setupDragAndDrop(){document.querySelectorAll(".draggable-card").forEach(a=>{a.draggable=!0,a.addEventListener("dragstart",o=>{this.draggedElement=a,a.classList.add("dragging"),o.dataTransfer.effectAllowed="move",o.dataTransfer.setData("text/html",a.outerHTML)}),a.addEventListener("dragend",o=>{a.classList.remove("dragging"),this.draggedElement=null,this.dragOverElement=null,document.querySelectorAll(".draggable-card").forEach(s=>{s.classList.remove("drag-over")})}),a.addEventListener("dragover",o=>{o.preventDefault(),o.dataTransfer.dropEffect="move",this.draggedElement&&this.draggedElement!==a&&(this.dragOverElement=a,a.classList.add("drag-over"))}),a.addEventListener("dragleave",o=>{a.contains(o.relatedTarget)||a.classList.remove("drag-over")}),a.addEventListener("drop",o=>{o.preventDefault(),a.classList.remove("drag-over"),this.draggedElement&&this.draggedElement!==a&&this.swapCards(this.draggedElement,a)})})}swapCards(e,a){const o=e.parentNode,s=Array.from(o.children).indexOf(e),n=Array.from(o.children).indexOf(a);s<n?o.insertBefore(e,a.nextSibling):o.insertBefore(e,a),this.saveCardOrder(),this.showNotification("Layout atualizado!","success")}saveCardOrder(){const e=document.querySelectorAll(".draggable-card"),a=Array.from(e).map(o=>o.dataset.cardType);localStorage.setItem("dashboard-card-order",JSON.stringify(a))}loadCardOrder(){const e=localStorage.getItem("dashboard-card-order");return e?JSON.parse(e):["progress","metrics","summary","top-recorrentes","categorias-inteligentes","atividade-recente"]}resetCardOrder(){localStorage.removeItem("dashboard-card-order"),this.showNotification("Layout resetado!","info"),setTimeout(()=>{window.location.reload()},1e3)}setupResetButton(){const e=document.getElementById("reset-layout-btn");e&&e.addEventListener("click",()=>{this.resetCardOrder()})}setupExportButtons(){const e=document.getElementById("export-dashboard-btn");e&&e.addEventListener("click",()=>{this.showExportModal()})}showExportModal(){const e=document.createElement("div");e.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",e.innerHTML=`
      <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">
          üì§ Exportar Resumo
        </h3>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
          Escolha o formato do resumo:
        </p>
        <div class="space-y-3">
          <button id="select-pdf" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2">
            <span>üìÑ</span>
            PDF
          </button>
          <button id="select-excel" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2">
            <span>üìä</span>
            Excel
          </button>
        </div>
        <div class="mt-4 flex justify-end">
          <button id="close-export-modal" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">
            Cancelar
          </button>
        </div>
      </div>
    `,document.body.appendChild(e),e.querySelector("#select-pdf").addEventListener("click",()=>{document.body.removeChild(e),this.showActionModal("PDF")}),e.querySelector("#select-excel").addEventListener("click",()=>{document.body.removeChild(e),this.showActionModal("Excel")}),e.querySelector("#close-export-modal").addEventListener("click",()=>{document.body.removeChild(e)}),e.addEventListener("click",a=>{a.target===e&&document.body.removeChild(e)})}showActionModal(e){const a=document.createElement("div");a.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",a.innerHTML=`
      <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">
          üì§ ${e} - Escolha a a√ß√£o
        </h3>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
          O que deseja fazer com o arquivo ${e}?
        </p>
        <div class="space-y-3">
          <button id="download-file" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2">
            <span>üíæ</span>
            Baixar Arquivo
          </button>
          <button id="share-whatsapp" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2">
            <span>üì±</span>
            Enviar para WhatsApp
          </button>
        </div>
        <div class="mt-4 flex justify-end">
          <button id="close-action-modal" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">
            Voltar
          </button>
        </div>
      </div>
    `,document.body.appendChild(a),a.querySelector("#download-file").addEventListener("click",()=>{document.body.removeChild(a),e==="PDF"?this.exportToPDF():this.exportToExcel()}),a.querySelector("#share-whatsapp").addEventListener("click",()=>{document.body.removeChild(a),this.shareToWhatsApp(e)}),a.querySelector("#close-action-modal").addEventListener("click",()=>{document.body.removeChild(a),this.showExportModal()}),a.addEventListener("click",o=>{o.target===a&&(document.body.removeChild(a),this.showExportModal())})}async exportToPDF(){this.showNotification("Gerando PDF...","info");try{typeof window.jsPDF>"u"&&await this.loadScript("https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js");const e=this.gatherDashboardData(),{jsPDF:a}=window.jspdf,o=new a,s=o.internal.pageSize.getWidth(),n=20;let i=n;o.setFontSize(20),o.setFont("helvetica","bold"),o.text("üìä RESUMO FINANCEIRO",s/2,i,{align:"center"}),i+=15,o.setFontSize(14),o.setFont("helvetica","normal"),o.text(e.period,s/2,i,{align:"center"}),i+=20,o.setLineWidth(.5),o.line(n,i,s-n,i),i+=15,o.setFontSize(16),o.setFont("helvetica","bold"),o.text("üìà PROGRESSO DO OR√áAMENTO",n,i),i+=10,o.setFontSize(12),o.setFont("helvetica","normal"),e.progress.split(`
`).forEach(g=>{g.trim()&&(o.text(g.trim(),n+10,i),i+=7)}),i+=10,o.setFontSize(16),o.setFont("helvetica","bold"),o.text("üí∞ M√âTRICAS FINANCEIRAS",n,i),i+=10,o.setFontSize(12),o.setFont("helvetica","normal"),e.metrics.forEach(g=>{g.trim()&&(o.text(`‚Ä¢ ${g.trim()}`,n+10,i),i+=7)}),i+=10,o.setFontSize(16),o.setFont("helvetica","bold"),o.text("üìä RESUMO DETALHADO",n,i),i+=10,o.setFontSize(12),o.setFont("helvetica","normal"),e.summary.split(`
`).forEach(g=>{g.trim()&&(o.text(g.trim(),n+10,i),i+=7)}),i+=15,o.setFontSize(10),o.setFont("helvetica","italic"),o.text(`Gerado em: ${e.exportDate}`,n,i),o.text("Sistema de Controle Financeiro",s-n,i,{align:"right"});const x=`resumo-financeiro-${e.period.replace("/","-")}.pdf`;o.save(x),this.showNotification("PDF gerado com sucesso!","success")}catch(e){console.error("Erro ao gerar PDF:",e),this.showNotification("Erro ao gerar PDF","error")}}async exportToExcel(){this.showNotification("Gerando Excel...","info");try{typeof window.XLSX>"u"&&await this.loadScript("https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js");const e=this.gatherDashboardData(),a=XLSX.utils.book_new(),o=[["üìä RESUMO FINANCEIRO",""],["Per√≠odo",e.period],["Data de Exporta√ß√£o",e.exportDate],[""],["üìà PROGRESSO DO OR√áAMENTO",""],...e.progress.split(`
`).filter(g=>g.trim()).map(g=>["",g.trim()]),[""],["üí∞ M√âTRICAS FINANCEIRAS",""],...e.metrics.filter(g=>g.trim()).map(g=>["",g.trim()]),[""],["üìä RESUMO DETALHADO",""],...e.summary.split(`
`).filter(g=>g.trim()).map(g=>["",g.trim()])],s=XLSX.utils.aoa_to_sheet(o);s["!cols"]=[{width:30},{width:50}],XLSX.utils.book_append_sheet(a,s,"Resumo Executivo");const n=[["CATEGORIA","VALOR","TIPO","STATUS"],["Receitas",this.extractValue(e.metrics[0]),"Receita","Positivo"],["Despesas",this.extractValue(e.metrics[1]),"Despesa","Negativo"],["Saldo",this.extractValue(e.metrics[2]),"Saldo",this.extractValue(e.metrics[2])>=0?"Positivo":"Negativo"],[""],["M√âTRICAS DE PROGRESSO","","",""],["Progresso do Or√ßamento",this.extractPercentage(e.progress),"%",this.extractPercentage(e.progress)>70?"Aten√ß√£o":"Normal"]],i=XLSX.utils.aoa_to_sheet(n);i["!cols"]=[{width:25},{width:15},{width:15},{width:15}],XLSX.utils.book_append_sheet(a,i,"An√°lise Detalhada");const d=[["META DI√ÅRIA","VALOR","TIPO","RECOMENDA√á√ÉO"],["Meta Or√ßamento",this.extractMetaValue(e.summary,"Or√ßamento"),"Conservadora","Baseada no or√ßamento total"],["Meta 100% Receitas",this.extractMetaValue(e.summary,"100% Receitas"),"Moderada","Baseada nas receitas atuais"],["Meta Conservadora",this.extractMetaValue(e.summary,"Conservadora"),"Conservadora","80% das receitas atuais"]],m=XLSX.utils.aoa_to_sheet(d);m["!cols"]=[{width:25},{width:20},{width:15},{width:30}],XLSX.utils.book_append_sheet(a,m,"Metas Di√°rias");const x=`resumo-financeiro-${e.period.replace("/","-")}.xlsx`;XLSX.writeFile(a,x),this.showNotification("Excel gerado com sucesso!","success")}catch(e){console.error("Erro ao gerar Excel:",e),this.showNotification("Erro ao gerar Excel","error")}}shareToWhatsApp(e="PDF"){this.showNotification("Preparando para compartilhar...","info");const a=this.gatherDashboardData(),o=this.generateWhatsAppMessage(a,e),n=`https://wa.me/?text=${encodeURIComponent(o)}`;window.open(n,"_blank"),this.showNotification("WhatsApp aberto para compartilhamento!","success")}loadScript(e){return new Promise((a,o)=>{const s=document.createElement("script");s.src=e,s.onload=a,s.onerror=o,document.head.appendChild(s)})}extractValue(e){const a=e.match(/R\$\s*([\d.,]+)/);return a?a[1]:"0,00"}extractPercentage(e){const a=e.match(/(\d+\.?\d*)%/);return a?parseFloat(a[1]):0}extractMetaValue(e,a){const o=e.split(`
`);for(const s of o)if(s.includes(a)){const n=s.match(/R\$\s*([\d.,]+)/);return n?n[1]:"0,00"}return"0,00"}gatherDashboardData(){const e=new Date,a=["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],o=window.appState&&window.appState.selectedMonth||e.getMonth()+1,s=window.appState&&window.appState.selectedYear||e.getFullYear(),n=a[Math.max(0,Math.min(11,o-1))]||"",i=document.querySelector('[data-card-type="progress"]'),d=document.querySelectorAll('[data-card-type="metrics"] .bg-white');return{period:`${n}/${s}`,progress:i?i.textContent.trim():"",metrics:Array.from(d).map(m=>m.textContent.trim()),summary:document.querySelector('[data-card-type="summary"]')?.textContent.trim()||"",exportDate:new Date().toLocaleString("pt-BR")}}generatePDFContent(e){return`
RESUMO FINANCEIRO - ${e.period}
Exportado em: ${e.exportDate}

PROGRESSO DO OR√áAMENTO:
${e.progress}

M√âTRICAS:
${e.metrics.join(`
`)}

RESUMO FINANCEIRO:
${e.summary}

---
Gerado pelo Sistema de Controle Financeiro
    `.trim()}generateCSVContent(e){return["Categoria,Valor,Descri√ß√£o",`Per√≠odo,${e.period},Resumo Financeiro`,`Data Exporta√ß√£o,${e.exportDate},`,"","PROGRESSO DO OR√áAMENTO",`Progresso,${e.progress},`,"","M√âTRICAS",...e.metrics.map(o=>`M√©trica,${o},`),"","RESUMO FINANCEIRO",`Resumo,${e.summary},`].join(`
`)}generateWhatsAppMessage(e,a="PDF"){return`üìä *RESUMO FINANCEIRO - ${e.period}*

${e.progress}

üìà *M√©tricas:*
${e.metrics.map(o=>`‚Ä¢ ${o}`).join(`
`)}

üí∞ *Resumo:*
${e.summary}

üìÖ Exportado em: ${e.exportDate}
üìÑ Formato: ${a}

---
üí° Gerado pelo Sistema de Controle Financeiro`}showNotification(e,a="info"){const o=document.createElement("div");o.className=`fixed top-4 right-4 px-4 py-2 rounded-lg text-white z-50 ${a==="success"?"bg-green-500":a==="error"?"bg-red-500":"bg-blue-500"}`,o.textContent=e,document.body.appendChild(o),setTimeout(()=>{document.body.contains(o)&&document.body.removeChild(o)},3e3)}}function oa(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new St}):new St}let kt=!1;function sa(r){try{if(!r){const l=(window.location.hash||"").split("?")[0];if(l&&l!=="#/dashboard"&&l!=="#/")return}}catch{}var e=r||document.getElementById("app-content");if(!e)return;if(!kt)try{const l=()=>queueMicrotask(()=>sa());b.on("transactions:updated",l),b.on("categories:updated",l),b.on("budget:changed",l),b.on("period:changed",l),b.on("summary:updated",l),b.on("app:ready",l),kt=!0}catch{}var a=new Date;window.appState||(window.appState={});var o=window.appState&&window.appState.selectedYear||a.getFullYear(),s=window.appState&&window.appState.selectedMonth||a.getMonth()+1,n=["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],i=n[Math.max(0,Math.min(11,s-1))]||"",d=String(o)+"-"+String(s).padStart(2,"0");function m(l){try{if(!l)return null;if(l&&typeof l.toDate=="function")return l.toDate();if(l&&l.seconds)return new Date(l.seconds*1e3);var c=new Date(l);return isNaN(c)?null:c}catch{return null}}function x(l){if(!l)return null;for(var c=[l.createdAt,l.data,l.date,l.dataTransacao,l.updatedAt],S=0;S<c.length;S++){var D=m(c[S]);if(D)return D}return null}function g(l){if(!l)return"";var c=l.getFullYear(),S=String(l.getMonth()+1).padStart(2,"0");return c+"-"+S}function w(l){try{if(l==null)return 0;if(typeof l=="number")return l;var c=String(l).trim();c=c.replace(/[^0-9,.-]/g,""),c=c.replace(/\.(?=\d{3}(?:\D|$))/g,""),c=c.replace(",",".");var S=parseFloat(c);return isNaN(S)?0:S}catch{return 0}}function p(l){try{return Number(l||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}catch{return Number(l||0).toFixed(2)}}for(var N=window.appState&&Array.isArray(window.appState.transactions)?window.appState.transactions:[],C=window.appState&&Array.isArray(window.appState.categories)?window.appState.categories:[],T=N.filter(function(l){return g(x(l))===d}),X=0,O=0,M=0;M<T.length;M++){var f=T[M],E=f.valor!==null&&f.valor!==void 0?f.valor:f.amount,$=w(E),Y=f.tipo||f.type||"despesa";Y==="receita"?X+=Math.abs($):O+=Math.abs($)}var R=X-O;T.length;var y=0;try{var ce=window.appState&&window.appState.currentBudget;if(ce&&ce.valorTotal)y=w(ce.valorTotal);else for(var U=0;U<C.length;U++){var H=C[U];if(H){var be=w(H.limite),ue=H.tipo||"despesa";be>0&&ue==="despesa"&&(y+=be)}}}catch{}for(var Me=Object.create(null),Ce=0;Ce<T.length;Ce++){var J=T[Ce];if((J.tipo||"despesa")==="despesa"){var Ne=J.categoriaId||J.categoryId;if(Ne){var Ft=Math.abs(w(J.valor!==null&&J.valor!==void 0?J.valor:J.amount));Me[Ne]=(Me[Ne]||0)+Ft}}}for(var he=0,at=[],rt=0,pe=0,$e=0;$e<C.length;$e++){var W=C[$e];if(W){var oe=w(W.limite);if(oe>0){var we=Me[W.id]||0,ye=oe>0?we/oe:0,ue=W.tipo||"despesa";if(ue==="despesa"){var Dt=oe-we;rt+=Dt,pe++}ye>=.7&&(he++,at.push({id:W.id,nome:W.nome,gasto:we,limite:oe,percentual:ye,percentualFormatado:(ye*100).toFixed(1)+"%"}),console.log("üö® [Dashboard] Categoria em alerta:",{nome:W.nome,gasto:we,limite:oe,percentual:(ye*100).toFixed(1)+"%"}))}}}var ot=new Date(o,s,0).getDate(),Tt=new Date().getDate(),ge=Math.max(1,ot-Tt+1),st=rt,Le=st>0?st/ge:0,Oe=X-O,Se=Oe>0?Oe/ge:0,nt=Oe*.8,it=nt>0?nt/ge:0,dt={diferencaOrcamentoVsReceitas:Le-Se,orcamentoMaiorQueReceitas:Le>Se},_={receitasVsGastos:O>0?X/O:0,coberturaOrcamento:y>0?Math.min(X/y*100,100):0,deficitOrcamento:Math.max(0,y-X),saldoPositivo:R>0};window.categoriasEmAlerta=at,console.log("üîç [Dashboard] Total de alertas calculado:",he);for(var se=y>0?Math.min(Math.max(O/y,0),1):0,me=Object.create(null),P=0;P<T.length;P++){var G=T[P];if((G.tipo||"despesa")==="despesa"){var K=G.categoriaId||G.categoryId||G.categoria&&G.categoria.id||"sem-categoria",Mt=w(G.valor!==null&&G.valor!==void 0?G.valor:G.amount);me[K]=(me[K]||0)+Math.abs(Mt)}}var ve=[];for(var K in me)if(Object.prototype.hasOwnProperty.call(me,K)){for(var lt="Outros",H=0;H<C.length;H++)if(C[H].id===K){lt=C[H].nome||"Outros";break}ve.push({id:K,nome:lt,valor:me[K]})}ve.sort(function(l,c){return c.valor-l.valor}),ve.length>5&&(ve=ve.slice(0,5));var t="";if(t+='<div class="tab-container">',t+='  <div class="tab-header">',t+='    <div class="bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-600">',t+='      <div class="flex items-center justify-between w-full gap-4">',t+="        <!-- T√≠tulo com √≠cone e badge -->",t+='        <div class="flex items-center gap-3">',t+='          <div class="flex items-center gap-2">',t+='            <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">',t+='              <span class="text-white text-sm">üìä</span>',t+="            </div>",t+="            <div>",t+='              <h2 class="text-gray-800 dark:text-white font-semibold text-base">Dashboard</h2>',t+='              <div class="flex items-center gap-1">',t+='                <span class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span>',t+='                <span class="text-green-600 dark:text-green-400 text-xs">Tempo Real</span>',t+="              </div>",t+="            </div>",t+="          </div>",t+="        </div>",t+="        <!-- Seletor de per√≠odo integrado -->",t+='        <div id="dash-period-indicator"></div>',t+="      </div>",t+="    </div>",t+="  </div>",t+='  <div class="tab-content">',t+='    <div class="content-spacing">',t+='      <div class="mb-12">',t+='        <div class="flex items-center gap-2 mb-4">',t+='          <div class="w-1 h-6 bg-gradient-to-b from-blue-500 to-green-500 rounded-full"></div>',t+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üìä Resumo</h2>',t+="        </div>",t+='        <div class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-2xl shadow-lg border border-blue-200 dark:border-gray-600 p-4 mb-6">',t+="          <!-- Header Compacto -->",t+='          <div class="flex items-center justify-between mb-4 gap-4">',t+="            <div>",t+='              <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 flex items-center gap-2">',t+='                <span class="text-xl">üìä</span>',t+="                Dashboard Financeiro",t+="              </h3>",t+='              <p class="text-sm text-gray-600 dark:text-gray-400">'+i+"/"+o+"</p>",t+="            </div>",t+='            <div class="flex gap-2">',t+='              <button id="export-dashboard-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1">',t+="                <span>üì§</span>",t+="                Exportar Resumo",t+="              </button>",t+='              <button id="reset-layout-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1">',t+="                <span>üîÑ</span>",t+="                Resetar Layout",t+="              </button>",t+="            </div>",t+="          </div>",t+="          <!-- Card de Progresso do Or√ßamento -->",t+='          <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-600 mb-4 draggable-card" data-card-type="progress">',t+='            <div class="drag-handle"></div>',t+='            <div class="flex items-center justify-between mb-2">',t+='              <div class="flex items-center gap-2">',t+='                <span class="text-lg">üìä</span>',t+='                <span class="text-sm font-semibold text-gray-700 dark:text-gray-300">Progresso do Or√ßamento</span>',t+="              </div>",t+='              <div class="text-right">',t+='                <div class="text-lg font-bold '+(se>.7?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400")+'">'+(se*100).toFixed(1)+"%</div>",t+='                <div class="text-xs text-gray-600 dark:text-gray-400">R$ '+p(O)+" de R$ "+p(y)+"</div>",t+="              </div>",t+="            </div>",t+='            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">',t+='              <div class="h-2 rounded-full '+(se>.7?"bg-red-500":"bg-green-500")+'" style="width: '+Math.min(se*100,100)+'%"></div>',t+="            </div>",t+="          </div>",t+="          <!-- M√©tricas Compactas -->",t+='          <div class="grid grid-cols-3 gap-3 mb-4 draggable-card" data-card-type="metrics">',t+='            <div class="drag-handle"></div>',t+='            <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">',t+='              <div class="text-lg mb-1">üíö</div>',t+='              <div class="text-lg font-bold text-green-600 dark:text-green-400">R$ '+p(X)+"</div>",t+='              <div class="text-xs text-gray-600 dark:text-gray-400">Receitas</div>',t+="            </div>",t+='            <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">',t+='              <div class="text-lg mb-1">üí∏</div>',t+='              <div class="text-lg font-bold text-red-600 dark:text-red-400">R$ '+p(O)+"</div>",t+='              <div class="text-xs text-gray-600 dark:text-gray-400">Despesas</div>',t+="            </div>",t+='            <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">',t+='              <div class="text-lg mb-1">üí∞</div>',t+='              <div class="text-lg font-bold '+(R>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+'">R$ '+p(Math.abs(R))+"</div>",t+='              <div class="text-xs text-gray-600 dark:text-gray-400">Saldo</div>',t+="            </div>",t+="          </div>",t+="          <!-- Resumo Financeiro Compacto -->",t+='          <div class="bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border border-gray-200 dark:border-gray-600 draggable-card" data-card-type="summary">',t+='            <div class="drag-handle"></div>',t+='            <h5 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-1">',t+="              <span>üìà</span>",t+="              Resumo Financeiro",t+="            </h5>",t+='            <div class="space-y-2">',t+='              <div class="flex justify-between text-sm border-b border-gray-200 dark:border-gray-600 pb-2">',t+='                <span class="text-gray-600 dark:text-gray-400 font-medium">üí∞ Saldo do M√™s:</span>',t+='                <span class="font-bold text-lg '+(R>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+'">R$ '+p(R)+"</span>",t+="              </div>",t+='              <div class="flex justify-between text-xs bg-blue-50 dark:bg-blue-900/20 p-2 rounded-lg border border-blue-200 dark:border-blue-800 mb-2">',t+='                <span class="text-gray-600 dark:text-gray-400 font-medium">üí° Meta Di√°ria (Or√ßamento):</span>',t+='                <span class="font-bold text-blue-600 dark:text-blue-400">R$ '+p(Le)+"/dia</span>",t+="              </div>",t+='              <div class="flex justify-between text-xs bg-green-50 dark:bg-green-900/20 p-2 rounded-lg border border-green-200 dark:border-green-800 mb-2">',t+='                <span class="text-gray-600 dark:text-gray-400 font-medium">üí∞ Meta Di√°ria (100% Receitas):</span>',t+='                <span class="font-bold '+(Se>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+'">R$ '+p(Se)+"/dia</span>",t+="              </div>",t+='              <div class="flex justify-between text-xs bg-yellow-50 dark:bg-yellow-900/20 p-2 rounded-lg border border-yellow-200 dark:border-yellow-800 mb-2">',t+='                <span class="text-gray-600 dark:text-gray-400 font-medium">‚ö†Ô∏è Meta Di√°ria (Conservadora):</span>',t+='                <span class="font-bold '+(it>0?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400")+'">R$ '+p(it)+"/dia</span>",t+="              </div>",y>0){const l=y-O;t+='              <div class="flex justify-between text-xs mb-1">',t+='                <span class="text-gray-600 dark:text-gray-400">üìä Or√ßamento Total:</span>',t+='                <span class="font-medium text-blue-600 dark:text-blue-400">R$ '+p(y)+"</span>",t+="              </div>",t+='              <div class="flex justify-between text-xs mb-1">',t+='                <span class="text-gray-600 dark:text-gray-400">üí∞ Pode Gastar:</span>',t+='                <span class="font-medium '+(l>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")+'">R$ '+p(Math.abs(l))+"</span>",t+="              </div>",t+='              <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mb-2">',t+='                <div class="h-1.5 rounded-full '+(se>.7?"bg-red-500":"bg-green-500")+'" style="width: '+Math.min(se*100,100)+'%"></div>',t+="              </div>"}if(he>0&&(t+='              <div class="flex justify-between text-xs cursor-pointer hover:bg-red-50 dark:hover:bg-red-900/20 p-1 rounded transition-colors border border-red-200 dark:border-red-800" id="alertas-categorias-btn" title="Clique para ver categorias em alerta">',t+='                <span class="text-red-600 dark:text-red-400 font-medium">üö® Alertas:</span>',t+='                <span class="font-bold text-red-600 dark:text-red-400">'+he+" categoria(s)</span>",t+="              </div>"),y>0){if(t+='              <div class="border-t border-gray-200 dark:border-gray-600 pt-2 mt-2">',t+='                <div class="text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">üí° An√°lise e Recomenda√ß√µes:</div>',_.coberturaOrcamento>=100?t+='                <div class="text-xs text-green-600 dark:text-green-400">‚úÖ Receitas cobrem 100% do or√ßamento</div>':_.coberturaOrcamento>=80?t+='                <div class="text-xs text-yellow-600 dark:text-yellow-400">‚ö†Ô∏è Receitas cobrem '+_.coberturaOrcamento.toFixed(0)+"% do or√ßamento</div>":t+='                <div class="text-xs text-red-600 dark:text-red-400">‚ùå Receitas cobrem apenas '+_.coberturaOrcamento.toFixed(0)+"% do or√ßamento</div>",_.deficitOrcamento>0&&(t+='                <div class="text-xs text-orange-600 dark:text-orange-400">üìä Faltam receitas: R$ '+p(_.deficitOrcamento)+"</div>"),t+='                <div class="mt-2 p-2 bg-gray-50 dark:bg-gray-700 rounded text-xs">',t+='                  <div class="font-medium text-gray-700 dark:text-gray-300 mb-1">üéØ Recomenda√ß√µes:</div>',_.coberturaOrcamento<100){var Ct=y,Nt=Math.max(0,Ct-X);Nt>0&&(t+='                  <div class="text-blue-600 dark:text-blue-400">‚Ä¢ üí° Considere reduzir limites de categorias ou aumentar receitas</div>')}_.coberturaOrcamento<80&&(t+='                  <div class="text-orange-600 dark:text-orange-400">‚Ä¢ Considere reduzir limites de categorias</div>'),_.receitasVsGastos<1&&(t+='                  <div class="text-red-600 dark:text-red-400">‚Ä¢ Controle gastos ou aumente receitas</div>'),dt.orcamentoMaiorQueReceitas?t+='                  <div class="text-orange-600 dark:text-orange-400">‚Ä¢ Meta or√ßamento √© R$ '+p(dt.diferencaOrcamentoVsReceitas)+"/dia maior que receitas</div>":t+='                  <div class="text-green-600 dark:text-green-400">‚Ä¢ Meta or√ßamento est√° dentro das receitas</div>',t+='                  <div class="text-blue-600 dark:text-blue-400 text-xs mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded">',t+='                    <div class="font-medium">üîÑ Rec√°lculo Din√¢mico:</div>',t+="                    <div>‚Ä¢ Dias restantes: "+ge+" dias</div>",t+="                    <div>‚Ä¢ Gasto m√©dio atual: R$ "+p(O/(ot-ge+1))+"/dia</div>",t+="                  </div>",_.saldoPositivo&&_.coberturaOrcamento>=100&&(t+='                  <div class="text-green-600 dark:text-green-400">‚Ä¢ Excelente controle financeiro!</div>'),t+="                </div>",t+="              </div>"}t+="            </div>",t+="          </div>",t+="        </div>",t+="      </div>";try{for(var ct=window.appState&&window.appState.currentBudget&&window.appState.currentBudget.id,u=Object.create(null),Pe=0;Pe<T.length;Pe++){var h=T[Pe];if((h.tipo||"despesa")==="despesa"){var $t=h.recorrenteId||h.recorrenteNome;if($t&&!(h.budgetId&&ct&&h.budgetId!==ct)){var v=h.recorrenteId||"nome:"+(h.recorrenteNome||"Recorrente"),Lt=Math.abs(w(h.valor!==null&&h.valor!==void 0?h.valor:h.amount));u[v]||(u[v]={nome:h.recorrenteNome||"Recorrente",total:0,count:0,parcelaAtual:null,parcelasTotal:null,recId:h.recorrenteId||null}),u[v].total+=Lt,u[v].count+=1;try{if(h.parcelaAtual!==null&&h.parcelaAtual!==void 0){var ne=Number(h.parcelaAtual);!isNaN(ne)&&ne>0&&(u[v].parcelaAtual=Math.max(u[v].parcelaAtual||0,ne))}if(h.parcelasTotal!==null&&h.parcelasTotal!==void 0){var ie=Number(h.parcelasTotal);!isNaN(ie)&&ie>0&&(u[v].parcelasTotal=ie)}if(!u[v].parcelaAtual)for(var ut=["parcela","parcelaAtual","currentInstallment","installment","parcelaAtualNumero"],M=0;M<ut.length;M++){var Ie=ut[M];if(h[Ie]!==null&&h[Ie]!==void 0){var je=Number(h[Ie]);if(!isNaN(je)&&je>0){u[v].parcelaAtual=Math.max(u[v].parcelaAtual||0,je);break}}}if(!u[v].parcelasTotal)for(var pt=["totalParcelas","parcelasTotal","totalInstallments","installments","parcelasTotalNumero"],P=0;P<pt.length;P++){var _e=pt[P];if(h[_e]!==null&&h[_e]!==void 0){var ze=Number(h[_e]);if(!isNaN(ze)&&ze>0){u[v].parcelasTotal=ze;break}}}!u[v].parcelaAtual&&u[v].count>0&&(u[v].parcelaAtual=u[v].count,console.log("üîß [Dashboard] Usando count como parcela atual para",u[v].nome,":",u[v].count)),!u[v].parcelasTotal&&u[v].parcelaAtual&&(u[v].count===1?(u[v].parcelasTotal=1,console.log("üîß [Dashboard] Assumindo parcela √∫nica para",u[v].nome)):(u[v].parcelasTotal=Math.max(u[v].parcelaAtual*2,u[v].count),console.log("üîß [Dashboard] Estimando total de parcelas para",u[v].nome,":",u[v].parcelasTotal)))}catch{}}}}var F=[];for(var L in u)Object.prototype.hasOwnProperty.call(u,L)&&((u[L].parcelaAtual||u[L].parcelasTotal)&&console.log("üîç [Dashboard] Recorrente com dados de parcela:",{nome:u[L].nome,parcelaAtual:u[L].parcelaAtual,parcelasTotal:u[L].parcelasTotal,count:u[L].count}),F.push({key:L,nome:u[L].nome,total:u[L].total,count:u[L].count,parcelaAtual:u[L].parcelaAtual,parcelasTotal:u[L].parcelasTotal}));if(F.sort(function(l,c){return c.total-l.total}),F.length>5&&(F=F.slice(0,5)),t+='      <div class="mb-12 draggable-card" data-card-type="top-recorrentes">',t+='        <div class="drag-handle"></div>',t+='        <div class="flex items-center gap-2 mb-4">',t+='          <div class="w-1 h-6 bg-gradient-to-b from-emerald-500 to-teal-500 rounded-full"></div>',t+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">‚ôªÔ∏è Top Recorrentes</h2>',t+="        </div>",t+='        <div class="u-card p-4">',!F.length)t+=`          <div class="empty-state">
            <div class="empty-icon">‚ôªÔ∏è</div>
            <div class="empty-text">Sem recorrentes neste per√≠odo</div>
            <div class="empty-description">Despesas recorrentes cadastradas aparecer√£o aqui</div>
          </div>`;else for(var z=0;z<F.length;z++){var gt="",Be="";try{if(F[z].parcelaAtual!==null&&F[z].parcelaAtual!==void 0&&F[z].parcelasTotal!==null&&F[z].parcelasTotal!==void 0){var Ve=Number(F[z].parcelaAtual),Xe=Number(F[z].parcelasTotal),ke=Xe-Ve;if(gt=' <span class="text-xs text-gray-500">‚Ä¢ '+String(Ve)+"/"+String(Xe)+"</span>",ke>0){var mt=Math.round(Ve/Xe*100);Be='<div class="mt-2"><div class="flex items-center justify-between text-xs text-gray-600 dark:text-gray-400 mb-1"><span>'+(ke===1?"1 parcela restante":ke+" parcelas restantes")+"</span><span>"+mt+'%</span></div><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5"><div class="bg-emerald-500 h-1.5 rounded-full transition-all duration-300" style="width: '+mt+'%"></div></div></div>'}else ke===0&&(Be='<div class="mt-2"><div class="flex items-center justify-between text-xs text-orange-600 dark:text-orange-400 mb-1"><span>Finalizado</span><span>100%</span></div><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5"><div class="bg-orange-500 h-1.5 rounded-full"></div></div></div>')}}catch{}t+='          <div class="py-3 border-b border-gray-100 dark:border-gray-800 last:border-0">',t+='            <div class="flex items-center justify-between gap-4">',t+='              <div class="flex-1">',t+='                <div class="font-medium text-gray-900 dark:text-gray-100">'+(F[z].nome||"Recorrente")+' <span class="text-xs text-gray-500">('+String(F[z].count)+")</span>"+gt+"</div>",t+="                "+Be,t+="              </div>",t+='              <div class="text-sm font-semibold text-gray-600 dark:text-gray-300 ml-4">R$ '+Number(F[z].total||0).toFixed(2)+"</div>",t+="            </div>",t+="          </div>"}t+="        </div>",t+="      </div>"}catch{}try{for(var He=[],qe=0;qe<C.length;qe++){var de=C[qe];if(de){for(var vt=de.id,Ot=w(de.limite),Pt=de.tipo||"despesa",ft=0,Ge=0;Ge<T.length;Ge++){var Q=T[Ge],It=(Q.categoriaId||Q.categoryId)===vt,jt=(Q.tipo||"despesa")==="despesa";It&&jt&&(ft+=Math.abs(w(Q.valor!==null&&Q.valor!==void 0?Q.valor:Q.amount)))}He.push({id:vt,nome:de.nome||"Categoria",cor:de.cor||"#4F46E5",tipo:Pt,limite:Ot,gasto:ft})}}for(var pe=He.filter(function(c){return(c.limite||0)>0&&(c.tipo||"despesa")==="despesa"}).map(function(c){var S=Number(c.limite||0),D=S>0?c.gasto/S*100:0;return{...c,porcentagem:D,temLimite:!0}}).sort(function(c,S){var D=c.gasto>c.limite,Fe=S.gasto>S.limite;return D&&!Fe?-1:!D&&Fe?1:S.porcentagem-c.porcentagem}),Ye=He.filter(function(c){return c.gasto>0&&(c.tipo||"despesa")==="despesa"}).map(function(c){return{...c,temLimite:!1}}).sort(function(c,S){return S.gasto-c.gasto}),le=[],Ue=new Set,M=0;M<Math.min(4,pe.length);M++)le.push(pe[M]),Ue.add(pe[M].id);for(var P=0;P<Ye.length&&le.length<6;P++)if(!Ue.has(Ye[P].id)){var Z=Ye[P],_t=(Z.limite||0)>0;if(_t){var xt=Number(Z.limite||0),zt=xt>0?Z.gasto/xt*100:0;Z={...Z,porcentagem:zt,temLimite:!0}}le.push(Z),Ue.add(Z.id)}if(t+='      <div class="mb-12 draggable-card" data-card-type="categorias-inteligentes">',t+='        <div class="drag-handle"></div>',t+='        <div class="flex items-center gap-2 mb-4">',t+='          <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-pink-500 rounded-full"></div>',t+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üìä Categorias Inteligentes</h2>',t+="        </div>",t+='        <div class="u-card overflow-hidden">',t+='          <div class="bg-gradient-to-r from-purple-50 via-blue-50 to-orange-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 p-4 border-b border-gray-200 dark:border-gray-700">',t+='            <div class="flex justify-between items-center gap-4">',t+="              <div>",t+='                <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">üéØ Vis√£o Inteligente</h3>',t+='                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Limites priorit√°rios + maiores gastos</p>',t+="              </div>",t+='              <button onclick="window.showAddCategoryModal && window.showAddCategoryModal()" class="btn btn-primary btn-sm">+ Nova</button>',t+="            </div>",t+="          </div>",t+='          <div class="p-4">',le.length===0)t+='            <div class="empty-state">',t+='              <div class="empty-icon">üìÇ</div>',t+='              <div class="empty-text">Nenhuma categoria encontrada</div>',t+='              <div class="empty-description">Crie categorias e adicione gastos para ver o resumo</div>',t+="            </div>";else for(var Ee=0;Ee<le.length;Ee++){var I=le[Ee],fe=Number(I.limite||0),B=fe>0?I.gasto/fe*100:0,q,ee,V;if(I.temLimite)B>=100?(q="üö®",ee="bg-red-500",V="EXCEDEU"):B>=90?(q="‚ö†Ô∏è",ee="bg-red-400",V="CR√çTICO"):B>=75?(q="‚ö°",ee="bg-yellow-500",V="ALERTA"):B>=50?(q="üìä",ee="bg-orange-500",V="ATEN√á√ÉO"):(q="‚úÖ",ee="bg-green-500",V="OK");else{var Re=Ee+1;Re===1?(q="ü•á",V="1¬∫ LUGAR"):Re===2?(q="ü•à",V="2¬∫ LUGAR"):Re===3?(q="ü•â",V="3¬∫ LUGAR"):(q="üìà",V="TOP "+Re),ee="bg-blue-500"}var Bt=I.temLimite&&B>=90?" ring-2 ring-red-200 dark:ring-red-800":"";if(t+='            <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-3 border border-gray-200 dark:border-gray-700'+Bt+' mb-3">',t+='              <div class="flex items-center justify-between mb-2 gap-4">',t+='                <div class="flex items-center gap-2">',t+='                  <span class="text-lg">'+q+"</span>",t+='                  <div class="w-3 h-3 rounded-full" style="background-color: '+I.cor+'"></div>',t+='                  <span class="font-medium text-sm text-gray-900 dark:text-gray-100">'+I.nome+"</span>",V){var Vt=I.temLimite&&B>=90?"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300":"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300";t+='                  <span class="text-xs px-2 py-1 rounded-full font-medium '+Vt+'">'+V+"</span>"}if(t+="                </div>",t+='                <span class="font-bold text-sm '+(I.temLimite&&I.gasto>fe?"text-red-600":"text-gray-900 dark:text-gray-100")+'">R$ '+p(I.gasto)+"</span>",t+="              </div>",I.temLimite){t+='              <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">',t+="                <span>Limite: R$ "+p(fe)+"</span>";var Xt=B>=100?"text-red-600 font-bold":B>=90?"text-orange-600 font-medium":"";t+='                <span class="'+Xt+'">'+B.toFixed(1)+"%</span>",t+="              </div>",t+='              <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">',t+='                <div class="'+ee+' h-2 rounded-full transition-all duration-300" style="width: '+Math.min(B,100)+'%"></div>',t+="              </div>",B>=100&&(t+='              <div class="mt-2 text-xs text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 px-2 py-1 rounded">Excedeu em R$ '+p(I.gasto-fe)+"</div>")}else t+='              <p class="text-xs text-gray-500 dark:text-gray-400">Sem limite definido ‚Ä¢ Posi√ß√£o por gasto</p>';t+="            </div>"}t+="          </div>",t+="        </div>",t+="      </div>"}catch{}try{var Je=T.slice().sort(function(l,c){var S=x(l)||new Date(0),D=x(c)||new Date(0);return D-S}).slice(0,5);if(t+='      <div class="mb-12 draggable-card" data-card-type="atividade-recente">',t+='        <div class="drag-handle"></div>',t+='        <div class="flex items-center gap-2 mb-4">',t+='          <div class="w-1 h-6 bg-gradient-to-b from-green-500 to-blue-500 rounded-full"></div>',t+='          <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üí≥ Atividade Recente</h2>',t+="        </div>",t+='        <div class="u-card overflow-hidden">',t+='          <div class="p-4">',t+='            <div class="flex items-center justify-between mb-4 gap-4">',t+='              <div class="text-sm font-medium text-gray-700 dark:text-gray-300">√öltimas Transa√ß√µes</div>',t+='              <button onclick="window.showAddTransactionModal && window.showAddTransactionModal()" class="btn btn-primary btn-sm">+ Nova Transa√ß√£o</button>',t+="            </div>",Je.length===0)t+=`            <div class="empty-state">
              <div class="empty-icon">üßæ</div>
              <div class="empty-text">Sem transa√ß√µes neste per√≠odo</div>
              <div class="mt-2"><button class="btn btn-primary btn-sm" onclick="window.showAddTransactionModal && window.showAddTransactionModal()">Adicionar transa√ß√£o</button></div>
            </div>`;else for(var We=0;We<Je.length;We++){var k=Je[We],Ae=C.find(function(l){return l.id===(k.categoriaId||k.categoryId)}),Ht=(k.tipo||"despesa")==="receita"?"+":"-",qt=Math.abs(w(k.valor!==null&&k.valor!==void 0?k.valor:k.amount)),bt=x(k),Gt=bt?bt.toLocaleDateString():"",ht="";try{if(k.recorrenteId&&(k.parcelaAtual||k.parcelasTotal)){var ne=k.parcelaAtual!==null&&k.parcelaAtual!==void 0?k.parcelaAtual:"",ie=k.parcelasTotal!==null&&k.parcelasTotal!==void 0?k.parcelasTotal:"";(ne||ie)&&(ht=" ‚Ä¢ "+(ne||"?")+"/"+(ie||"?"))}}catch{}t+='            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-xl mb-2 gap-4">',t+='              <div class="flex items-center gap-3 min-w-0">',t+='                <div class="w-3 h-3 rounded-full" style="background-color: '+(Ae&&Ae.cor||"#6B7280")+'"></div>',t+='                <div class="min-w-0">',t+='                  <div class="font-medium text-gray-900 dark:text-gray-100 truncate">'+(k.descricao||k.description||"Transa√ß√£o")+"</div>",t+='                  <div class="text-xs text-gray-500 dark:text-gray-400">'+(Ae&&Ae.nome||"Sem categoria")+" ‚Ä¢ "+Gt+ht+"</div>",t+="                </div>",t+="              </div>",t+='              <div class="font-bold '+((k.tipo||"despesa")==="receita"?"text-green-600":"text-red-600")+'">'+Ht+"R$ "+p(qt)+"</div>",t+="            </div>"}t+="          </div>",t+="        </div>",t+="      </div>"}catch{}t+="    </div>",t+="  </div>",t+="</div>",e.innerHTML=t;try{Et("#dash-period-indicator")}catch{}try{oa()}catch{}try{window.showCategoriasAlertaModal=async function(){try{const D=new Date,Fe=window.appState&&window.appState.selectedYear||D.getFullYear(),Yt=window.appState&&window.appState.selectedMonth||D.getMonth()+1,Ut=String(Fe)+"-"+String(Yt).padStart(2,"0"),wt=(Array.isArray(window.appState?.transactions)?window.appState.transactions:[]).filter(function(A){return g(x(A))===Ut}),Ke=(Array.isArray(window.appState?.categories)?window.appState.categories:[]).filter(function(A){return A&&(A.tipo||"despesa")==="despesa"&&w(A.limite)>0}).map(function(A){for(var te=0,Qe=0;Qe<wt.length;Qe++){var ae=wt[Qe];if((ae.tipo||"despesa")==="despesa"){var Kt=ae.categoriaId||ae.categoryId;Kt===A.id&&(te+=Math.abs(w(ae.valor!==null&&ae.valor!==void 0?ae.valor:ae.amount)))}}var Ze=w(A.limite),Qt=Ze>0?te/Ze*100:0;return{id:A.id,nome:A.nome||"Categoria",cor:A.cor||"#4F46E5",limite:Ze,gasto:te,pct:Qt}}).filter(function(A){return A.pct>=70}).sort(function(A,te){return te.pct-A.pct});let xe='<div class="mb-3 text-xs text-gray-600 dark:text-gray-300">Mostrando categorias com uso do limite ‚â• 70% em '+i+" "+o+".</div>";if(!Ke.length)xe+='<div class="text-center py-6">            <div class="text-3xl mb-2">‚úÖ</div>            <div class="text-gray-700 dark:text-gray-200">Nenhuma categoria em alerta</div>          </div>';else{xe+='<div class="space-y-3">';for(var l=0;l<Ke.length;l++){var c=Ke[l],S=c.pct>=100?"bg-red-500":c.pct>=90?"bg-red-400":c.pct>=75?"bg-yellow-500":"bg-orange-500";xe+='              <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700">                <div class="flex items-center justify-between mb-2">                  <div class="flex items-center gap-2">                    <div class="w-3 h-3 rounded-full" style="background-color:'+c.cor+'"></div>                    <span class="font-medium text-sm text-gray-900 dark:text-gray-100">'+c.nome+'</span>                  </div>                  <span class="font-bold text-sm '+(c.pct>=100?"text-red-600":c.pct>=90?"text-orange-600":"text-gray-900 dark:text-gray-100")+'">R$ '+p(c.gasto)+'</span>                </div>                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">                  <span>Limite: R$ '+p(c.limite)+"</span>                  <span>"+c.pct.toFixed(1)+'%</span>                </div>                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">                  <div class="'+S+' h-2 rounded-full" style="width:'+Math.min(c.pct,100).toFixed(1)+'%"></div>                </div>                <div class="mt-1 text-[11px] text-gray-500 dark:text-gray-400">Restante: R$ '+p(Math.max(c.limite-c.gasto,0))+"</div>              </div>"}xe+="</div>"}const{Modal:Jt}=await re(async()=>{const{Modal:A}=await import("./main--Xl17bQY.js").then(te=>te.a5);return{Modal:A}},__vite__mapDeps([0,1])),Wt=Jt({title:"Categorias em alerta",content:xe,onClose:function(){try{document.getElementById("app-modal")?.remove()}catch{}}});document.body.appendChild(Wt)}catch(D){console.error("Falha ao abrir modal de categorias em alerta",D);try{alert("Erro ao abrir modal: "+(D?.message||D))}catch{}}}}catch{}tt()}async function Ra(r){const e=document.createElement("div");e.className="recorrentes-page";const a=document.createElement("div");a.className="tab-header mb-6",a.innerHTML='<h1 class="text-2xl font-semibold text-gray-900 leading-tight">‚ôªÔ∏è Recorrentes</h1>',e.appendChild(a);const o=document.createElement("div");o.className="recorrentes-content",o.innerHTML=`
    <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-6">
      <div class="flex justify-between items-center mb-6 gap-4">
        <h3 class="text-lg font-bold text-gray-900 dark:text-white">üîÅ Gerenciar Recorrentes</h3>
  <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="btn btn-primary btn-sm">
          ‚ûï Nova Recorrente
        </button>
      </div>
      <div class="text-center py-8">
        <div class="text-4xl mb-4">‚ôªÔ∏è</div>
        <p class="text-gray-600 dark:text-gray-400">P√°gina de recorrentes em desenvolvimento</p>
        <p class="text-sm text-gray-500 dark:text-gray-500 mt-2">Carregando recorrentes...</p>
      </div>
    </div>
  `,e.appendChild(o),r&&(r.innerHTML="",r.appendChild(e)),await Te()}async function Te(){try{if((window.location.hash||"").split("?")[0]!=="#/recorrentes")return;const e=Date.now();if(window.__lastRecorrentesRender&&e-window.__lastRecorrentesRender<300)return;window.__lastRecorrentesRender=e,await De();const a=document.getElementById("app-content"),{year:o,month:s}=na(),n=window.appState?.currentBudget?.id;let i=window.appState.recorrentes||[];n&&(i=i.filter(f=>f.budgetId===n||!f.budgetId)),i=i.slice().sort((f,E)=>String(f.descricao||f.nome||"").localeCompare(String(E.descricao||E.nome||"")));const d=window.appState.transactions||[],x=["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][s-1]||"";let g=i.length,w=0,p=0,N=0,C=0,T=0;for(const f of i){const E=f.ativa!==!1,$=Number(f.valor??0),Y=yt(f,d,o,s),R=!!Y?.foiEfetivadaEsteMes,y=!Y?.aposUltimaParcela&&!Y?.antesDaPrimeiraParcela;if(R){N+=$,w++,C+=$;continue}E&&y&&(N+=$,p++,T+=$)}const X=w+p,O=typeof window<"u"&&window.innerWidth<=480?"recorrentes-compact":"";a.innerHTML=`
      <div class="tab-container ${O}">
        <div class="tab-header">
          <div class="bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-600">
            <div class="flex items-center justify-between w-full gap-4">
              <div class="flex items-center gap-3">
                <div class="flex items-center gap-2">
                  <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center">
                    <span class="text-white text-sm">‚ôªÔ∏è</span>
                  </div>
                  <div>
                    <h2 class="text-gray-800 dark:text-white font-semibold text-base">Recorrentes</h2>
                    <div class="flex items-center gap-1">
                      <span class="text-indigo-600 dark:text-indigo-400 text-xs">${i.length} ativos</span>
                    </div>
                  </div>
                </div>
              </div>
              <div id="rec-period-indicator"></div>
            </div>
          </div>
        </div>
        <div class="tab-content">
          <div class="content-spacing">
            <!-- ========== SE√á√ÉO 1: RESUMO COMPACTO ========== -->
            <div class="mb-12">
              <div class="flex items-center gap-2 mb-4">
                <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-green-500 rounded-full"></div>
                <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">‚ôªÔ∏è Resumo</h2>
              </div>
              
              <div class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-2xl shadow-lg border border-blue-200 dark:border-gray-600 p-4 mb-6">
                <!-- Header Compacto -->
                <div class="flex items-center justify-between mb-4 gap-4">
                  <div>
                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 flex items-center gap-2">
                      <span class="text-xl">‚ôªÔ∏è</span>
                      Controle de Recorrentes
                    </h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400">${g} recorrentes ‚Ä¢ ${String(s).padStart(2,"0")}/${o}</p>
                  </div>
                  <div class="text-right">
                    <div class="text-lg font-bold text-purple-600 dark:text-purple-400">
                      R$ ${N.toFixed(2)}
                    </div>
                    <p class="text-xs text-gray-500 dark:text-gray-400">Potencial</p>
                  </div>
                </div>
                
                <!-- M√©tricas Compactas -->
                <div class="grid grid-cols-3 gap-3 mb-4">
                  <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">
                    <div class="text-lg mb-1">‚úÖ</div>
                    <div class="text-lg font-bold text-green-600 dark:text-green-400">${w}</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Aplicadas</div>
                  </div>
                  
                  <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">
                    <div class="text-lg mb-1">‚è≥</div>
                    <div class="text-lg font-bold text-orange-600 dark:text-orange-400">${p}</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Pendentes</div>
                  </div>
                  
                  <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm border border-gray-200 dark:border-gray-600">
                    <div class="text-lg mb-1">üü¢</div>
                    <div class="text-lg font-bold text-blue-600 dark:text-blue-400">${X}</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Ativas</div>
                  </div>
                </div>

                <!-- Resumo Financeiro Compacto -->
                <div class="bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border border-gray-200 dark:border-gray-600">
                  <h5 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-1">
                    <span>üí∞</span>
                    Resumo Financeiro
                  </h5>
                  <div class="space-y-1">
                    <div class="flex justify-between text-xs">
                      <span class="text-gray-600 dark:text-gray-400">Aplicado:</span>
                      <span class="font-medium text-green-600 dark:text-green-400">R$ ${C.toFixed(2)}</span>
                    </div>
                    <div class="flex justify-between text-xs">
                      <span class="text-gray-600 dark:text-gray-400">Pendente:</span>
                      <span class="font-medium text-orange-600 dark:text-orange-400">R$ ${T.toFixed(2)}</span>
                    </div>
                    <div class="flex justify-between text-xs border-t border-gray-200 dark:border-gray-600 pt-1">
                      <span class="text-gray-600 dark:text-gray-400">Total:</span>
                      <span class="font-bold text-purple-600 dark:text-purple-400">
                        R$ ${N.toFixed(2)}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="mb-12">
              <div class="flex items-center gap-2 mb-4">
                <div class="w-1 h-6 bg-gradient-to-b from-purple-500 to-green-500 rounded-full"></div>
                <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üîß A√ß√µes & Filtros</h2>
              </div>
              <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-4 flex flex-col md:flex-row gap-3 md:gap-4 md:items-center md:justify-between">
                <div class="text-sm text-gray-600 dark:text-gray-400">Per√≠odo selecionado: <strong>${x}/${o}</strong></div>
                <div class="flex gap-2">
                  <button onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()" class="btn btn-primary btn-sm">‚ûï Nova Recorrente</button>
                  <button ${p===0?"disabled":""} onclick="window.efetivarRecorrentesMesAtual && window.efetivarRecorrentesMesAtual()" class="btn btn-outline btn-sm" ${p===0?"disabled":""}>
                    ‚ö° Efetivar Pendentes (${p})
                  </button>
                </div>
              </div>
            </div>

            <div class="mb-12">
              <div class="flex items-center gap-2 mb-4">
                <div class="w-1 h-6 bg-gradient-to-b from-green-500 to-teal-500 rounded-full"></div>
                <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100">üìã Lista de Recorrentes</h2>
              </div>
              <div id="rec-list" class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-4"></div>
            </div>
            </div>
          </div>
        </div>
      </div>
    `;try{const f=a.querySelector(".tab-container"),E="__recResizeHandler";window[E]&&window.removeEventListener("resize",window[E]);const $=()=>{f&&(window.innerWidth<=480?f.classList.add("recorrentes-compact"):f.classList.remove("recorrentes-compact"))};window[E]=$,$(),window.addEventListener("resize",$,{passive:!0})}catch{}try{Et("#rec-period-indicator")}catch{}const M=document.getElementById("rec-list");try{const f=document.getElementById("rec-summary-toggle"),E=document.getElementById("rec-summary-details");f&&E&&f.addEventListener("click",()=>{E.classList.contains("hidden")?(E.classList.remove("hidden"),f.textContent="Ocultar detalhes"):(E.classList.add("hidden"),f.textContent="Mostrar detalhes")})}catch{}if(!i.length)M.innerHTML='<div class="empty-state"><div class="empty-icon">‚ôªÔ∏è</div><div class="empty-text">Nenhuma recorrente cadastrada</div><div class="empty-description">Crie sua primeira recorrente para automatizar lan√ßamentos</div><div class="mt-2"><button class="btn btn-primary w-full" onclick="window.showAddRecorrenteModal && window.showAddRecorrenteModal()">‚ûï Nova Recorrente</button></div></div>';else{const f=o,E=s,Y=i.map(R=>{const y=yt(R,d,f,E);if(y?.aposUltimaParcela||y?.antesDaPrimeiraParcela)return null;const ce=R.descricao||R.nome||R.name||R.id,U=R.ativa!==!1,H=y?.temParcelas?`<span class="ml-2 text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-800">${y.parcelaAtual}/${y.totalParcelas}</span>`:"",be=y?.foiEfetivadaEsteMes?'<span class="text-xs text-green-600 ml-2">aplicada</span>':"",ue=Number(R.valor??0).toLocaleString("pt-BR",{minimumFractionDigits:2});return`
          <div class="p-3 rounded border border-gray-200 dark:border-gray-700 flex justify-between items-center mb-2 gap-4">
            <div class="truncate">
              <div class="font-medium ${U?"":"line-through opacity-70"}">${ce}${H}${be}</div>
              <div class="text-sm text-gray-500">R$ ${ue}</div>
            </div>
            <div class="flex items-center gap-2">
              <div class="text-xs ${U?"text-green-600":"text-gray-400"}">${U?"Ativa":"Inativa"}</div>
              <button
                class="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-300 hover:text-gray-900"
                title="Editar"
                onclick="window.editRecorrente && window.editRecorrente('${R.id}')"
                aria-label="Editar recorrente"
              >‚úèÔ∏è</button>
              <button
                class="p-1 rounded hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700"
                title="Apagar"
                onclick="window.deleteRecorrente && window.deleteRecorrente('${R.id}')"
                aria-label="Apagar recorrente"
              >üóëÔ∏è</button>
            </div>
          </div>
        `}).filter(Boolean).join("");M.innerHTML=Y||'<div class="empty-state"><div class="empty-icon">üóìÔ∏è</div><div class="empty-text">Nenhuma recorrente neste per√≠odo</div><div class="empty-description">Altere o per√≠odo ou crie uma recorrente v√°lida para este m√™s</div></div>'}}catch(r){console.error("Erro ao renderizar recorrentes:",r)}}function na(){try{if(window?.appState?.selectedYear&&window?.appState?.selectedMonth)return{year:window.appState.selectedYear,month:window.appState.selectedMonth}}catch{}const r=new Date;return{year:r.getFullYear(),month:r.getMonth()+1}}try{const r=async()=>{if((window.location.hash||"").split("?")[0]==="#/recorrentes"){try{await De()}catch{}return Te()}};b.on("period:changed",()=>queueMicrotask(()=>r())),b.on("budget:changed",()=>queueMicrotask(()=>r())),b.on("transactions:updated",()=>queueMicrotask(()=>r())),b.on("transaction:added",()=>queueMicrotask(()=>r())),b.on("transaction:updated",()=>queueMicrotask(()=>r())),b.on("transaction:deleted",()=>queueMicrotask(()=>r()))}catch{}typeof window<"u"&&(window.efetivarRecorrentesMesAtual=async function(){try{const r=window.appState?.currentUser?.uid,e=window.appState?.currentBudget?.id;if(!r||!e){window.Snackbar?window.Snackbar({message:"Usu√°rio ou or√ßamento n√£o encontrado",type:"error"}):alert("Usu√°rio ou or√ßamento n√£o encontrado");return}const a=new Date,o=window.appState?.selectedYear||a.getFullYear(),s=window.appState?.selectedMonth||a.getMonth()+1,n=await Zt(r,e,!0,o,s);typeof window.loadTransactions=="function"&&await window.loadTransactions(),await De(),window.Snackbar&&(n?.aplicadas>0?window.Snackbar({message:`Efetivadas ${n.aplicadas} recorrentes. ${n.pendentes} pendentes.`,type:"success"}):window.Snackbar({message:"Nenhuma recorrente para efetivar neste m√™s.",type:"info"}));try{const i=window.appState?.currentBudget?.id;b.emit("transactions:updated",{budgetId:i,transactions:window.appState?.transactions||[]})}catch{}try{const i=window.appState?.currentBudget?.id;b.emit("categories:updated",{budgetId:i,categories:window.appState?.categories||[]})}catch{}try{b.emit("recorrentes:updated")}catch{}try{window.renderDashboard&&window.renderDashboard()}catch{}await Te()}catch(r){console.error("Erro ao efetivar recorrentes:",r),window.Snackbar?window.Snackbar({message:"Erro ao efetivar recorrentes",type:"error"}):alert("Erro ao efetivar recorrentes")}},window.editRecorrente=function(r){try{const e=(window.appState?.recorrentes||[]).find(a=>a.id===r);if(!e){window.Snackbar?window.Snackbar({message:"Recorrente n√£o encontrada",type:"error"}):alert("Recorrente n√£o encontrada");return}typeof window.showAddRecorrenteModal=="function"&&window.showAddRecorrenteModal(e)}catch(e){console.error("Erro ao editar recorrente:",e)}},window.deleteRecorrente=async function(r){const e=window.appState?.currentUser?.uid;if(!e){window.Snackbar?window.Snackbar({message:"Usu√°rio n√£o autenticado",type:"error"}):alert("Usu√°rio n√£o autenticado");return}if(typeof window.confirm!="function"||window.confirm("Excluir esta recorrente?"))try{await ea(e,r),await De();try{typeof window.loadTransactions=="function"&&await window.loadTransactions()}catch{}window.Snackbar&&window.Snackbar({message:"Recorrente apagada",type:"success"}),await Te();try{b.emit("recorrentes:updated")}catch{}}catch(o){console.error("Erro ao excluir recorrente:",o),window.Snackbar?window.Snackbar({message:"Erro ao excluir recorrente",type:"error"}):alert("Erro ao excluir recorrente")}});function Aa(){try{if(!window.appState||!window.appState.transactions){window.Snackbar?window.Snackbar({message:"Nenhum dado dispon√≠vel para exportar.",type:"warning"}):alert("Nenhum dado dispon√≠vel para exportar.");return}const r={transactions:window.appState.transactions,categories:window.appState.categories,budgets:window.appState.budgets,recorrentes:window.appState.recorrentes},e=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),a=URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download="financeiro-backup.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a),window.Snackbar&&window.Snackbar({message:"‚úÖ Backup JSON exportado com sucesso!",type:"success"})}catch(r){console.error("‚ùå Erro ao exportar backup:",r),window.Snackbar?window.Snackbar({message:"Erro ao exportar backup: "+r.message,type:"error"}):alert("Erro ao exportar backup: "+r.message)}}async function Fa(){try{if(typeof window.XLSX>"u"&&await re(()=>import("https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"),[]),!window.appState||!window.appState.transactions){window.Snackbar?window.Snackbar({message:"Nenhum dado dispon√≠vel para exportar.",type:"warning"}):alert("Nenhum dado dispon√≠vel para exportar.");return}const r=window.XLSX.utils.book_new(),e=window.appState.transactions.map(s=>({Descri√ß√£o:s.descricao,Valor:s.valor,Tipo:s.tipo,Categoria:window.appState.categories.find(n=>n.id===s.categoriaId)?.nome||"",Data:s.createdAt&&s.createdAt.toDate?s.createdAt.toDate().toLocaleDateString():""}));window.XLSX.utils.book_append_sheet(r,window.XLSX.utils.json_to_sheet(e),"Transa√ß√µes");const a=window.appState.categories.map(s=>({Nome:s.nome,Tipo:s.tipo,Limite:s.limite,Cor:s.cor}));window.XLSX.utils.book_append_sheet(r,window.XLSX.utils.json_to_sheet(a),"Categorias");const o=window.appState.budgets.map(s=>({Nome:s.nome,Descri√ß√£o:s.descricao,ID:s.id}));window.XLSX.utils.book_append_sheet(r,window.XLSX.utils.json_to_sheet(o),"Or√ßamentos"),window.XLSX.writeFile(r,"financeiro-dados.xlsx"),window.Snackbar&&window.Snackbar({message:"‚úÖ Arquivo Excel exportado com sucesso!",type:"success"})}catch(r){console.error("‚ùå Erro ao exportar Excel:",r),window.Snackbar?window.Snackbar({message:"Erro ao exportar Excel: "+r.message,type:"error"}):alert("Erro ao exportar Excel: "+r.message)}}async function Da(){try{if(typeof window.jspdf>"u"&&await re(()=>import("https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"),[]),!window.appState||!window.appState.transactions){window.Snackbar?window.Snackbar({message:"Nenhum dado dispon√≠vel para exportar.",type:"warning"}):alert("Nenhum dado dispon√≠vel para exportar.");return}const{jsPDF:r}=window.jspdf,e=new r;let a=10;e.setFontSize(20),e.setFont("helvetica","bold"),e.text("üìä Relat√≥rio Financeiro",10,a),a+=15;const o=window.appState.currentBudget;o&&(e.setFontSize(14),e.setFont("helvetica","bold"),e.text(`Or√ßamento: ${o.nome}`,10,a),a+=8,e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`ID: ${o.id}`,10,a),a+=10);const s=window.appState.transactions.filter(d=>d.tipo==="receita").reduce((d,m)=>d+parseFloat(m.valor),0),n=window.appState.transactions.filter(d=>d.tipo==="despesa").reduce((d,m)=>d+parseFloat(m.valor),0),i=s-n;e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Resumo Geral:",10,a),a+=8,e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Total Receitas: R$ ${s.toFixed(2)}`,12,a),a+=6,e.text(`Total Despesas: R$ ${n.toFixed(2)}`,12,a),a+=6,e.setFont("helvetica","bold"),e.text(`Saldo: R$ ${i.toFixed(2)}`,12,a),e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Transa√ß√µes Recentes:",10,a),a+=8,e.setFontSize(9),e.setFont("helvetica","normal"),window.appState.transactions.sort((d,m)=>new Date(m.createdAt?.toDate?.()||m.createdAt)-new Date(d.createdAt?.toDate?.()||d.createdAt)).slice(0,15).forEach(d=>{const m=window.appState.categories.find(w=>w.id===d.categoriaId)?.nome||"Sem categoria",g=`${d.createdAt?.toDate?.()?d.createdAt.toDate().toLocaleDateString():"Data n√£o dispon√≠vel"} - ${d.descricao} | R$ ${d.valor} | ${d.tipo} | ${m}`;a>270&&(e.addPage(),a=10),e.text(g,12,a),a+=6}),a+=5,e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Gastos por Categoria:",10,a),a+=8,e.setFontSize(9),e.setFont("helvetica","normal"),window.appState.categories.forEach(d=>{const m=window.appState.transactions.filter(x=>x.categoriaId===d.id&&x.tipo==="despesa").reduce((x,g)=>x+parseFloat(g.valor),0);if(m>0){const x=d.limite?` / R$ ${d.limite}`:"",g=d.limite?` (${(m/d.limite*100).toFixed(1)}%)`:"";a>270&&(e.addPage(),a=10),e.text(`${d.nome}: R$ ${m.toFixed(2)}${x}${g}`,12,a),a+=6}}),e.save("relatorio-financeiro.pdf"),window.Snackbar&&window.Snackbar({message:"‚úÖ Relat√≥rio PDF exportado com sucesso!",type:"success"})}catch(r){console.error("‚ùå Erro ao exportar PDF:",r),window.Snackbar?window.Snackbar({message:"Erro ao exportar PDF: "+r.message,type:"error"}):alert("Erro ao exportar PDF: "+r.message)}}function Ta(){try{let o=function(s,n,i,d=170){return e.splitTextToSize(s,d).forEach(x=>{i>270&&(e.addPage(),i=10),e.text(x,n,i),i+=6}),i};if(typeof window.jspdf>"u"){console.error("‚ùå Biblioteca jsPDF n√£o est√° dispon√≠vel"),window.Snackbar?window.Snackbar({message:"Erro: Biblioteca jsPDF n√£o est√° carregada. Tente recarregar a p√°gina.",type:"error"}):alert("Erro: Biblioteca jsPDF n√£o est√° carregada. Tente recarregar a p√°gina.");return}const{jsPDF:r}=window.jspdf,e=new r;let a=10;e.setFontSize(24),e.setFont("helvetica","bold"),e.setFillColor(79,70,229),e.rect(0,0,210,40,"F"),e.setTextColor(255,255,255),e.text("Controle Financeiro",20,25),e.setFontSize(14),e.text("Guia Completo de Uso",20,35),a=50,e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),a=o("üéØ Como Usar o Aplicativo",20,a),e.setFontSize(10),e.setFont("helvetica","normal"),a=o("1. Fa√ßa login com sua conta Google",25,a),a=o("2. Crie categorias para organizar suas despesas e receitas",25,a),a=o("3. Adicione transa√ß√µes usando o bot√£o + ou comandos de voz",25,a),a=o("4. Configure despesas recorrentes para pagamentos fixos",25,a),a=o("5. Monitore seu saldo e gastos no dashboard",25,a),a+=10,e.setFontSize(12),e.setFont("helvetica","bold"),a=o("üé§ Comandos de Voz Dispon√≠veis",20,a),e.setFontSize(10),e.setFont("helvetica","normal"),a=o('‚Ä¢ "gastei 50 reais no supermercado em alimenta√ß√£o"',25,a),a=o('‚Ä¢ "recebi 2000 de sal√°rio em rendimentos"',25,a),a=o('‚Ä¢ "criar categoria alimenta√ß√£o despesa 500"',25,a),a=o('‚Ä¢ "qual meu saldo"',25,a),a=o('‚Ä¢ "mostrar transa√ß√µes"',25,a),a+=10,e.setFontSize(12),e.setFont("helvetica","bold"),a=o("üìä Funcionalidades Principais",20,a),e.setFontSize(10),e.setFont("helvetica","normal"),a=o("‚Ä¢ Dashboard com resumo financeiro",25,a),a=o("‚Ä¢ Gest√£o de transa√ß√µes e categorias",25,a),a=o("‚Ä¢ Sistema de despesas recorrentes",25,a),a=o("‚Ä¢ Alertas de limite de categoria",25,a),a=o("‚Ä¢ Backup e exporta√ß√£o de dados",25,a),a=o("‚Ä¢ Interface responsiva para mobile",25,a),a+=10,e.setFontSize(12),e.setFont("helvetica","bold"),a=o("üíæ Backup e Exporta√ß√£o",20,a),e.setFontSize(10),e.setFont("helvetica","normal"),a=o("‚Ä¢ Exporta√ß√£o em JSON para backup completo",25,a),a=o("‚Ä¢ Exporta√ß√£o em Excel para relat√≥rios",25,a),a=o("‚Ä¢ Exporta√ß√£o em PDF para documenta√ß√£o",25,a),a=o("‚Ä¢ Restaura√ß√£o de dados de backup",25,a),a+=10,e.setFontSize(12),e.setFont("helvetica","bold"),a=o("üîß Suporte e Contato",20,a),e.setFontSize(10),e.setFont("helvetica","normal"),a=o("Para d√∫vidas ou problemas:",25,a),a=o("‚Ä¢ Verifique os logs do console (F12)",30,a),a=o("‚Ä¢ Teste em diferentes navegadores",30,a),a=o("‚Ä¢ Consulte a documenta√ß√£o t√©cnica",30,a),e.save("guia-servo-tech-financas.pdf"),window.Snackbar&&window.Snackbar({message:"‚úÖ Guia PDF exportado com sucesso!",type:"success"})}catch(r){console.error("‚ùå Erro ao exportar guia PDF:",r),window.Snackbar?window.Snackbar({message:"Erro ao exportar guia PDF: "+r.message,type:"error"}):alert("Erro ao exportar guia PDF: "+r.message)}}function Ma(){console.log("üîç showExportOptions chamada"),re(async()=>{const{Modal:r}=await import("./index-CBMCDw62.js").then(e=>e.i);return{Modal:r}},__vite__mapDeps([2,0,1,3])).then(({Modal:r})=>{r({title:"üì§ Op√ß√µes de Exporta√ß√£o",content:`
        <div class="space-y-4">
          <button onclick="window.downloadBackup && window.downloadBackup()" class="w-full btn btn-primary btn-sm">
            <span class="icon-standard">üíæ</span>
            Backup JSON Completo
          </button>
          <button onclick="window.exportToExcel && window.exportToExcel()" class="w-full btn btn-outline btn-sm">
            <span class="icon-standard">üìä</span>
            Exportar para Excel
          </button>
          <button onclick="window.exportToPDF && window.exportToPDF()" class="w-full btn btn-outline btn-sm">
            <span class="icon-standard">üìÑ</span>
            Exportar para PDF
          </button>
          <button onclick="window.exportReadmePDF && window.exportReadmePDF()" class="w-full btn btn-outline btn-sm">
            <span class="icon-standard">üìñ</span>
            Guia de Uso (PDF)
          </button>
        </div>
      `})}).catch(()=>{alert("Abra as op√ß√µes de exporta√ß√£o nas configura√ß√µes.")})}function Ca(){try{"scrollRestoration"in history&&(history.scrollRestoration="manual")}catch{}const r=s=>{const n=(s||"").split("?")[0];return n&&n.startsWith("/")?n:"/dashboard"},e=["/dashboard","/transactions","/categories","/analytics","/recorrentes","/notifications","/settings"];document.addEventListener("keydown",s=>{if(!(s.target.tagName==="INPUT"||s.target.tagName==="TEXTAREA"))switch(s.key){case"ArrowLeft":s.preventDefault(),a("prev");break;case"ArrowRight":s.preventDefault(),a("next");break}});function a(s){const n=e.indexOf(r(window.location.hash.slice(1)));if(n===-1)return;let i;s==="next"?i=(n+1)%e.length:i=n===0?e.length-1:n-1;const d=e[i];window.location.hash=d,o(d)}function o(s){const i={"/dashboard":"Dashboard","/transactions":"Transa√ß√µes","/categories":"Categorias","/analytics":"An√°lises","/recorrentes":"Recorrentes","/notifications":"Notifica√ß√µes","/settings":"Configura√ß√µes"}[s]||"Dashboard";document.title=`Financeiro - ${i}`}}async function Na(){console.log("üöÄ Inicializando aplica√ß√£o...");try{if(window.appState?.isInitialized){console.log("‚úÖ Aplica√ß√£o j√° inicializada");return}if(window.appState?.currentUser){console.log("‚úÖ Usu√°rio j√° autenticado, configurando aplica√ß√£o..."),await ia();try{const r=new Date,e=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`,a=localStorage.getItem("recorrentes:lastAutoApplied");if(r.getDate()===1&&a!==e){const s=window.appState?.currentUser?.uid,n=window.appState?.currentBudget?.id;if(s&&n){const{aplicarRecorrentesDoMes:i,loadRecorrentes:d}=await re(async()=>{const{aplicarRecorrentesDoMes:x,loadRecorrentes:g}=await import("./main--Xl17bQY.js").then(w=>w.a3);return{aplicarRecorrentesDoMes:x,loadRecorrentes:g}},__vite__mapDeps([0,1])),m=await i(s,n,!0);typeof window.loadTransactions=="function"&&await window.loadTransactions(),await d();try{b.emit("transactions:updated")}catch{}try{b.emit("categories:updated")}catch{}try{b.emit("recorrentes:updated")}catch{}localStorage.setItem("recorrentes:lastAutoApplied",e),m?.aplicadas>0&&window.Snackbar&&window.Snackbar({message:`Recorrentes do m√™s aplicadas automaticamente (${m.aplicadas}).`,type:"info"})}}}catch(r){console.warn("Falha ao auto-aplicar recorrentes:",r)}da(),console.log("‚úÖ Aplica√ß√£o inicializada com sucesso")}else console.log("‚è≥ Aguardando autentica√ß√£o do usu√°rio...")}catch(r){console.error("‚ùå Erro ao inicializar aplica√ß√£o:",r)}}async function ia(){try{console.log("üìä Carregando dados iniciais...");const r=window.appState?.currentUser?.uid;if(!r){console.warn("‚ö†Ô∏è Usu√°rio n√£o autenticado, pulando carregamento de dados");return}const{loadUserBudgets:e}=await re(async()=>{const{loadUserBudgets:o}=await import("./main--Xl17bQY.js").then(s=>s.a8);return{loadUserBudgets:o}},__vite__mapDeps([0,1]));await e(r);const{selectDefaultBudget:a}=await re(async()=>{const{selectDefaultBudget:o}=await import("./main--Xl17bQY.js").then(s=>s.a8);return{selectDefaultBudget:o}},__vite__mapDeps([0,1]));await a(r),typeof window.loadTransactions=="function"&&await window.loadTransactions(),typeof window.loadCategories=="function"&&await window.loadCategories(),typeof window.loadRecorrentes=="function"&&await window.loadRecorrentes(),typeof window.loadNotifications=="function"&&await window.loadNotifications(),typeof window.listenNotifications=="function"&&await window.listenNotifications(),window.appState.currentBudget?.id&&typeof window.startAllListeners=="function"&&await window.startAllListeners(window.appState.currentBudget.id),console.log("‚úÖ Dados iniciais carregados com sucesso")}catch(r){console.error("‚ùå Erro ao carregar dados iniciais:",r)}}function da(){console.log("üîß Configurando event listeners..."),b.on("transaction:added",la),b.on("transaction:updated",ca),b.on("transaction:deleted",ua),b.on("category:added",pa),b.on("category:updated",ga),b.on("category:deleted",ma),b.on("budget:changed",va),console.log("‚úÖ Event listeners configurados")}function la(r){console.log("üìù Nova transa√ß√£o adicionada:",r)}function ca(r){console.log("üìù Transa√ß√£o atualizada:",r)}function ua(r){console.log("üóëÔ∏è Transa√ß√£o deletada:",r)}function pa(r){console.log("üìÇ Nova categoria adicionada:",r)}function ga(r){console.log("üìÇ Categoria atualizada:",r)}function ma(r){console.log("üóëÔ∏è Categoria deletada:",r)}function va(r){console.log("üí∞ Or√ßamento alterado:",r)}function $a(r,e="BRL"){if(r==null||isNaN(r))return"R$ 0,00";try{return new Intl.NumberFormat("pt-BR",{style:"currency",currency:e}).format(r)}catch(a){return console.error("‚ùå Erro ao formatar moeda:",a),`R$ ${r.toFixed(2).replace(".",",")}`}}function La(r,e={}){if(!r)return"";try{const a={year:"numeric",month:"2-digit",day:"2-digit",...e},o=new Date(r);return isNaN(o.getTime())?"":new Intl.DateTimeFormat("pt-BR",a).format(o)}catch(a){return console.error("‚ùå Erro ao formatar data:",a),""}}function Oa(r,e){return!e||e===0?0:Math.round(r/e*100)}function Pa(r){return r?r.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():""}function Ia(r,e){let a;return function(...s){const n=()=>{clearTimeout(a),r(...s)};clearTimeout(a),a=setTimeout(n,e)}}function ja(r,e){let a;return function(){const o=arguments,s=this;a||(r.apply(s,o),a=!0,setTimeout(()=>a=!1,e))}}function _a(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function za(r){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)}function Ba(r){return r?r.charAt(0).toUpperCase()+r.slice(1).toLowerCase():""}function Va(r,e=50){return!r||r.length<=e?r:r.substring(0,e)+"..."}function Xa(r){return!isNaN(parseFloat(r))&&isFinite(r)}function Ha(r){return Math.round((r+Number.EPSILON)*100)/100}function qa(r){const e=[];if(!r.descricao||r.descricao.trim().length===0?e.push("Descri√ß√£o √© obrigat√≥ria"):r.descricao.trim().length<3&&e.push("Descri√ß√£o deve ter pelo menos 3 caracteres"),!r.valor||isNaN(r.valor)?e.push("Valor deve ser um n√∫mero v√°lido"):r.valor<=0&&e.push("Valor deve ser maior que zero"),(!r.tipo||!["receita","despesa"].includes(r.tipo))&&e.push('Tipo deve ser "receita" ou "despesa"'),r.categoriaId||e.push("Categoria √© obrigat√≥ria"),r.data){const a=new Date(r.data);isNaN(a.getTime())&&e.push("Data deve ser v√°lida")}return{isValid:e.length===0,errors:e}}function Ga(r){const e=[];return!r.nome||r.nome.trim().length===0?e.push("Nome da categoria √© obrigat√≥rio"):r.nome.trim().length<2&&e.push("Nome da categoria deve ter pelo menos 2 caracteres"),(!r.tipo||!["receita","despesa"].includes(r.tipo))&&e.push('Tipo deve ser "receita" ou "despesa"'),r.limite!==void 0&&r.limite!==null&&(isNaN(r.limite)?e.push("Limite deve ser um n√∫mero v√°lido"):r.limite<0&&e.push("Limite n√£o pode ser negativo")),r.cor&&!fa(r.cor)&&e.push("Cor deve ser um c√≥digo de cor v√°lido"),{isValid:e.length===0,errors:e}}function Ya(r){const e=[];return!r.nome||r.nome.trim().length===0?e.push("Nome do or√ßamento √© obrigat√≥rio"):r.nome.trim().length<3&&e.push("Nome do or√ßamento deve ter pelo menos 3 caracteres"),!r.valorTotal||isNaN(r.valorTotal)?e.push("Valor total deve ser um n√∫mero v√°lido"):r.valorTotal<=0&&e.push("Valor total deve ser maior que zero"),r.periodo&&!["mensal","semanal","anual"].includes(r.periodo)&&e.push('Per√≠odo deve ser "mensal", "semanal" ou "anual"'),{isValid:e.length===0,errors:e}}function Ua(r){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)}function Ja(r){const e=[];return(!r||r.length<6)&&e.push("Senha deve ter pelo menos 6 caracteres"),/[A-Z]/.test(r)||e.push("Senha deve conter pelo menos uma letra mai√∫scula"),/[a-z]/.test(r)||e.push("Senha deve conter pelo menos uma letra min√∫scula"),/\d/.test(r)||e.push("Senha deve conter pelo menos um n√∫mero"),{isValid:e.length===0,errors:e}}function Wa(r){if(r=r.replace(/[^\d]/g,""),r.length!==11||/^(\d)\1{10}$/.test(r))return!1;let e=0;for(let n=0;n<9;n++)e+=parseInt(r.charAt(n))*(10-n);let a=e%11,o=a<2?0:11-a;e=0;for(let n=0;n<10;n++)e+=parseInt(r.charAt(n))*(11-n);a=e%11;let s=a<2?0:11-a;return parseInt(r.charAt(9))===o&&parseInt(r.charAt(10))===s}function fa(r){const e=new Option().style;return e.color=r,e.color!==""}function Ka(r){return r=r.replace(/[^\d]/g,""),r.length>=10&&r.length<=11}function Qa(r){try{const e=window.appState.budgets.find(i=>i.id===r);if(!e)return{receitas:0,despesas:0,saldo:0};const a=window.appState.transactions.filter(i=>i.budgetId===r),o=a.filter(i=>i.tipo==="receita").reduce((i,d)=>i+(d.valor||0),0),s=a.filter(i=>i.tipo==="despesa").reduce((i,d)=>i+(d.valor||0),0),n=o-s;return{receitas:j(o),despesas:j(s),saldo:j(n),orcado:e.valorTotal||0}}catch(e){return console.error("‚ùå Erro ao calcular saldo do or√ßamento:",e),{receitas:0,despesas:0,saldo:0,orcado:0}}}function Za(r,e=null){try{let a=window.appState.transactions.filter(s=>s.budgetId===r);if(e){const s=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0");a=a.filter(n=>(n.data?new Date(n.data).getFullYear()+"-"+String(new Date(n.data).getMonth()+1).padStart(2,"0"):new Date().getFullYear()+"-"+String(new Date().getMonth()+1).padStart(2,"0"))===s)}const o={};return a.forEach(s=>{const n=s.categoriaId,i=window.appState.categories.find(d=>d.id===n);i&&(o[n]||(o[n]={id:n,nome:i.nome,cor:i.cor,tipo:i.tipo,receitas:0,despesas:0,total:0}),s.tipo==="receita"?o[n].receitas+=s.valor||0:o[n].despesas+=s.valor||0,o[n].total=o[n].receitas-o[n].despesas)}),Object.values(o).map(s=>({...s,receitas:j(s.receitas),despesas:j(s.despesas),total:j(s.total)})).sort((s,n)=>Math.abs(n.total)-Math.abs(s.total))}catch(a){return console.error("‚ùå Erro ao calcular totais por categoria:",a),[]}}function At(r,e=6){try{const a=[],o=new Date;for(let s=0;s<e;s++){const n=new Date(o.getFullYear(),o.getMonth()-s,1),i=n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0"),d=n.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),m=window.appState.transactions.filter(p=>{if(p.budgetId!==r||!p.data)return!1;const N=new Date(p.data);return N.getFullYear()+"-"+String(N.getMonth()+1).padStart(2,"0")===i}),x=m.filter(p=>p.tipo==="receita").reduce((p,N)=>p+(N.valor||0),0),g=m.filter(p=>p.tipo==="despesa").reduce((p,N)=>p+(N.valor||0),0),w=x-g;a.push({month:i,monthName:d,receitas:j(x),despesas:j(g),saldo:j(w),transactionCount:m.length})}return a.reverse()}catch(a){return console.error("‚ùå Erro ao calcular estat√≠sticas mensais:",a),[]}}function er(r,e=3){try{const a=At(r,e);if(a.length<2)return{trend:"estavel",percentage:0};const o=a[a.length-1],s=a[a.length-2];if(s.saldo===0)return{trend:"estavel",percentage:0};const n=(o.saldo-s.saldo)/Math.abs(s.saldo)*100;let i="estavel";return n>5?i="crescimento":n<-5&&(i="declinio"),{trend:i,percentage:j(n),change:j(o.saldo-s.saldo)}}catch(a){return console.error("‚ùå Erro ao calcular tend√™ncias:",a),{trend:"estavel",percentage:0}}}function tr(r,e=3){try{const a=At(r,e);if(a.length<2)return null;const o=[];for(let d=1;d<a.length;d++){const m=a[d].saldo-a[d-1].saldo;o.push(m)}const s=o.reduce((d,m)=>d+m,0)/o.length,n=a[a.length-1].saldo,i=[];for(let d=1;d<=e;d++){const m=n+s*d;i.push({month:d,projectedSaldo:j(m),confidence:Math.max(0,100-d*20)})}return i}catch(a){return console.error("‚ùå Erro ao calcular proje√ß√µes:",a),null}}function j(r){return Math.round((r+Number.EPSILON)*100)/100}export{or as addTransactionWithNotifications,sr as applyCompactMode,nr as applyCurrentTheme,ir as applyTheme,dr as applyThemeSettings,xr as calcularNumeroParcela,Qa as calculateBudgetBalance,Za as calculateCategoryTotals,At as calculateMonthlyStats,Oa as calculatePercentage,tr as calculateProjections,er as calculateTrends,Ba as capitalizeFirst,fo as checkAuthState,Wr as closeVoiceModal,br as collapseAllDays,Ia as debounce,lr as deleteTransactionWithNotifications,Aa as downloadBackup,hr as expandAllDays,Ta as exportReadmePDF,Fa as exportToExcel,Da as exportToPDF,$a as formatCurrency,La as formatDate,wr as formatTransactionDisplayDate,_a as generateId,yr as getCollapsedDays,cr as getCurrentCompactMode,ur as getCurrentTheme,Sr as getTransactionDate,kr as getTransactionYearMonth,Kr as getVoiceSystem,Na as initializeApp,Er as isDayCollapsed,Xa as isNumeric,za as isValidEmail,Xr as leaveSharedBudget,Rr as loadAllOlderMonths,Ar as loadMonthSection,xo as logout,Qr as normalizarTexto,Pa as normalizeText,Zr as openVoiceModal,eo as parseNumeroPorExtenso,to as processCategoryVoice,ao as processTransactionVoice,ro as processVoiceCommand,Hr as removeUserFromBudget,Ir as renderAllCategories,Fr as renderAllTransactions,no as renderBottomNav,jr as renderCategories,sa as renderDashboard,io as renderFAB,_r as renderFilteredCategories,Dr as renderFilteredTransactions,Tr as renderMonthSectionHTML,Br as renderNotifications,Mr as renderOlderMonthsControl,Ra as renderRecorrentes,Cr as renderTransactionItemHTML,Nr as renderTransactions,$r as renderTransactionsGroupedByDay,lo as resetScrollPosition,Ha as roundToTwoDecimals,Lr as saveCollapsedDays,qr as sendCategoryChangeNotification,Gr as sendTransactionDeletedNotification,Yr as sendTransactionNotification,Ur as sendTransactionUpdatedNotification,co as setupCategoryButtons,uo as setupDashboardButtons,da as setupEventListeners,po as setupHeaderButtons,bo as setupLoginButton,Ca as setupNavigation,pr as setupThemeToggle,go as setupTransactionButtons,Ma as showExportOptions,mo as showLoading,oo as startVoiceRecognition,ja as throttle,gr as toggleCompactMode,Or as toggleDayGroup,ho as toggleLoginPage,mr as toggleTheme,Va as truncateText,vr as updateTransactionWithNotifications,Ya as validateBudget,Wa as validateCPF,Ga as validateCategory,Ua as validateEmail,Ja as validatePassword,Ka as validatePhone,qa as validateTransaction};

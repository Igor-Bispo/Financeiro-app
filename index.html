<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle Financeiro - Gerencie suas finan√ßas</title>
    <meta name="description" content="Aplicativo completo para controle financeiro pessoal com reconhecimento de voz, gr√°ficos e exporta√ß√£o PDF">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="theme-color" content="#2563eb">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1>Controle Financeiro</h1>
                <div class="header-actions">
                    <button class="btn btn-icon" id="darkModeBtn" onclick="toggleDarkMode()" title="Alternar modo escuro (Ctrl+D)">
                        üåô
                    </button>
                    <button class="btn btn-icon" onclick="exportToPDF()" title="Exportar PDF (Ctrl+E)">
                        üìÑ
                    </button>
                    <button class="btn btn-icon" onclick="showNotificationSettings()" title="Configura√ß√µes de notifica√ß√£o">
                        üîî
                    </button>
                    <button class="btn btn-icon" id="voiceBtn" onclick="toggleVoiceRecognition()" title="Reconhecimento de voz (Ctrl+V)">
                        üéôÔ∏è
                    </button>
                </div>
            </div>
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">üë§</div>
                <div>
                    <div id="userName">Fa√ßa login</div>
                    <button class="btn btn-secondary" id="loginBtn" onclick="AuthModule.login()">Entrar</button>
                    <button class="btn btn-secondary hidden" id="logoutBtn" onclick="AuthModule.logout()">Sair</button>
                </div>
            </div>
        </header>

        <!-- Estados de Loading e Erro -->
        <div id="loadingState" class="loading-state" style="display: none;">
            <!-- Conte√∫do ser√° inserido via JavaScript -->
        </div>

        <!-- Conte√∫do Principal -->
        <div id="mainContent">
            <!-- Cards de Resumo -->
            <div class="summary-cards">
                <div class="summary-card income">
                    <h3>Receita Total</h3>
                    <div class="amount" id="totalIncome">R$ 0,00</div>
                    <div class="text-secondary">Soma de todas as receitas</div>
                </div>
                <div class="summary-card expense">
                    <h3>Despesa Total</h3>
                    <div class="amount" id="totalExpense">R$ 0,00</div>
                    <div class="text-secondary">Soma dos limites das categorias</div>
                </div>
                <div class="summary-card budget">
                    <h3>Saldo Atual</h3>
                    <div class="amount" id="totalBudget">R$ 0,00</div>
                    <div class="text-secondary">Soma dos saldos das categorias</div>
                </div>
                <div class="summary-card balance">
                    <h3>Or√ßamento Restante</h3>
                    <div class="amount" id="budgetRemaining">R$ 0,00</div>
                    <div class="text-secondary">Receita Total - Despesa Total</div>
                </div>
            </div>

            <!-- Navega√ß√£o Mobile -->
            <nav class="mobile-nav">
                <button class="nav-tab active" data-tab="dashboard">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">Dashboard</span>
                </button>
                <button class="nav-tab" data-tab="transactions">
                    <span class="nav-icon">üí∞</span>
                    <span class="nav-label">Transa√ß√µes</span>
                </button>
                <button class="nav-tab" data-tab="categories">
                    <span class="nav-icon">üìÅ</span>
                    <span class="nav-label">Categorias</span>
                </button>
                <button class="nav-tab" data-tab="goals">
                    <span class="nav-icon">üéØ</span>
                    <span class="nav-label">Metas</span>
                </button>
                <button class="nav-tab" data-tab="budgets">
                    <span class="nav-icon">üìã</span>
                    <span class="nav-label">Or√ßamentos</span>
                </button>
            </nav>

            <!-- Conte√∫do das Abas -->
            <div class="tab-content">
                <!-- Aba Dashboard -->
                <div class="tab-pane active" id="dashboard-tab">
                    <!-- Dashboard com Gr√°ficos -->
                    <div class="dashboard-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <h3>Receitas vs Despesas</h3>
                                <button class="btn btn-secondary" onclick="FinanceApp.exportToPDF()">
                                    Exportar Relat√≥rio
                                </button>
                            </div>
                            <canvas id="incomeExpenseChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <div class="chart-header">
                                <h3>Distribui√ß√£o por Categoria</h3>
                            </div>
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>

                    <!-- Filtros -->
                    <div class="filter-bar">
                        <div class="filter-group">
                            <label for="periodFilter">Per√≠odo</label>
                            <select id="periodFilter" class="form-control">
                                <option value="month">Este M√™s</option>
                                <option value="quarter">Este Trimestre</option>
                                <option value="year">Este Ano</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="categoryFilter">Categoria</label>
                            <select id="categoryFilter" class="form-control">
                                <option value="all">Todas Categorias</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="typeFilter">Tipo</label>
                            <select id="typeFilter" class="form-control">
                                <option value="all">Todos</option>
                                <option value="income">Receitas</option>
                                <option value="expense">Despesas</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Aba Transa√ß√µes -->
                <div class="tab-pane" id="transactions-tab">
                    <div class="transactions-section">
                        <div class="section-header">
                            <h2>Transa√ß√µes Recentes</h2>
                            <div class="flex gap-2">
                                <button class="btn btn-primary" onclick="showTransactionModal()" title="Nova transa√ß√£o (Ctrl+N)">
                                    ‚ûï Nova Transa√ß√£o
                                </button>
                            </div>
                        </div>

                        <!-- Status do Reconhecimento de Voz -->
                        <div class="voice-status hidden" id="voiceStatus">
                            <div class="voice-indicator" id="voiceIndicator"></div>
                            <span id="voiceText">Ouvindo...</span>
                        </div>

                        <!-- Lista de Transa√ß√µes -->
                        <div class="transactions-list" id="transactionsList">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aba Categorias -->
                <div class="tab-pane" id="categories-tab">
                    <div class="categories-section">
                        <div class="section-header">
                            <h2>Gerenciar Categorias</h2>
                            <button class="btn btn-primary" onclick="showCategoryModal()" title="Nova categoria (Ctrl+C)">
                                ‚ûï Nova Categoria
                            </button>
                        </div>
                        <div class="categories-grid" id="categoriesList">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aba Metas -->
                <div class="tab-pane" id="goals-tab">
                    <div class="goals-section">
                        <div class="section-header">
                            <h2>Minhas Metas</h2>
                            <button class="btn btn-primary" onclick="showGoalModal()" title="Nova meta (Ctrl+G)">
                                ‚ûï Nova Meta
                            </button>
                        </div>
                        <div class="goals-grid" id="goalsList">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aba Or√ßamentos -->
                <div class="tab-pane" id="budgets-tab">
                    <div class="budgets-section">
                        <div class="section-header">
                            <h2>Or√ßamentos</h2>
                            <button class="btn btn-primary" onclick="showBudgetModal()" title="Novo or√ßamento (Ctrl+B)">
                                ‚ûï Novo Or√ßamento
                            </button>
                        </div>
                        <div class="budgets-grid" id="budgetsList">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Layout Desktop (mant√©m a estrutura original) -->
            <div class="desktop-layout">
                <!-- Se√ß√µes Principais -->
                <div class="main-sections">
                    <!-- Se√ß√£o de Transa√ß√µes -->
                    <section class="transactions-section">
                        <div class="section-header">
                            <h2>Transa√ß√µes Recentes</h2>
                            <div class="flex gap-2">
                                <button class="btn btn-primary" onclick="showTransactionModal()" title="Nova transa√ß√£o (Ctrl+N)">
                                    ‚ûï Nova Transa√ß√£o
                                </button>
                            </div>
                        </div>

                        <!-- Status do Reconhecimento de Voz -->
                        <div class="voice-status hidden" id="voiceStatus">
                            <div class="voice-indicator" id="voiceIndicator"></div>
                            <span id="voiceText">Ouvindo...</span>
                        </div>

                        <!-- Lista de Transa√ß√µes -->
                        <div class="transactions-list" id="transactionsList">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </section>

                    <!-- Sidebar -->
                    <aside class="sidebar">
                        <!-- Categorias -->
                        <div class="sidebar-section">
                            <div class="section-header">
                                <h3>Categorias</h3>
                                <button class="btn btn-secondary" onclick="showCategoryModal()" title="Nova categoria (Ctrl+C)">‚ûï</button>
                            </div>
                            <div class="categories-list" id="categoriesList">
                                <div class="loading">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Metas -->
                        <div class="sidebar-section">
                            <div class="section-header">
                                <h3>Metas</h3>
                                <button class="btn btn-secondary" onclick="showGoalModal()" title="Nova meta (Ctrl+G)">‚ûï</button>
                            </div>
                            <div class="goals-list" id="goalsList">
                                <div class="loading">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Or√ßamentos -->
                        <div class="sidebar-section">
                            <div class="section-header">
                                <h3>Or√ßamentos</h3>
                                <button class="btn btn-secondary" onclick="showBudgetModal()" title="Novo or√ßamento (Ctrl+B)">‚ûï</button>
                            </div>
                            <div id="budgetsList">
                                <div class="loading">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>

            <!-- FAB (Floating Action Button) -->
            <button class="fab" onclick="showTransactionModal()" title="Nova Transa√ß√£o">
                ‚ûï
            </button>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="quick-action" onclick="showCategoryModal()" title="Nova Categoria">
                    üìÅ
                </button>
                <button class="quick-action" onclick="showGoalModal()" title="Nova Meta">
                    üéØ
                </button>
                <button class="quick-action" onclick="showBudgetModal()" title="Novo Or√ßamento">
                    üìã
                </button>
            </div>
        </div>

        <!-- Container de Notifica√ß√µes -->
        <div class="notification-container" id="notificationContainer"></div>

        <!-- Modais -->
        <!-- Modal de Transa√ß√£o -->
        <div class="modal" id="transactionModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="transactionModalTitle">Nova Transa√ß√£o</h3>
                    <button class="modal-close" onclick="closeTransactionModal()">&times;</button>
                </div>
                <form id="transactionForm" onsubmit="handleTransactionSubmit(event)">
                    <div class="form-group">
                        <label for="transactionTitle">T√≠tulo</label>
                        <input type="text" id="transactionTitle" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="transactionAmount">Valor</label>
                        <input type="number" id="transactionAmount" class="form-control" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="transactionType">Tipo</label>
                        <select id="transactionType" class="form-control" required>
                            <option value="income">Receita</option>
                            <option value="expense">Despesa</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="transactionCategory">Categoria</label>
                        <select id="transactionCategory" class="form-control" required>
                            <option value="">Selecione uma categoria</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="transactionDate">Data</label>
                        <input type="date" id="transactionDate" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="transactionDescription">Descri√ß√£o (opcional)</label>
                        <textarea id="transactionDescription" class="form-control" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeTransactionModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal de Categoria -->
        <div class="modal" id="categoryModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="categoryModalTitle">Nova Categoria</h3>
                    <button class="modal-close" onclick="closeCategoryModal()">&times;</button>
                </div>
                <form id="categoryForm" onsubmit="handleCategorySubmit(event)">
                    <div class="form-group">
                        <label for="categoryName">Nome</label>
                        <input type="text" id="categoryName" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="categoryColor">Cor</label>
                        <input type="color" id="categoryColor" class="form-control" value="#2563eb">
                    </div>
                    <div class="form-group">
                        <label for="categoryType">Tipo</label>
                        <select id="categoryType" class="form-control" required>
                            <option value="expense">Despesa</option>
                            <option value="income">Receita</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="categoryLimit">Limite Mensal (opcional)</label>
                        <input type="number" id="categoryLimit" class="form-control" step="0.01" placeholder="0,00">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeCategoryModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal de Meta -->
        <div class="modal" id="goalModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="goalModalTitle">Nova Meta</h3>
                    <button class="modal-close" onclick="closeGoalModal()">&times;</button>
                </div>
                <form id="goalForm" onsubmit="handleGoalSubmit(event)">
                    <div class="form-group">
                        <label for="goalTitle">T√≠tulo</label>
                        <input type="text" id="goalTitle" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="goalTarget">Meta (R$)</label>
                        <input type="number" id="goalTarget" class="form-control" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="goalCurrent">Valor Atual (R$)</label>
                        <input type="number" id="goalCurrent" class="form-control" step="0.01" value="0">
                    </div>
                    <div class="form-group">
                        <label for="goalDeadline">Data Limite</label>
                        <input type="date" id="goalDeadline" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="goalDescription">Descri√ß√£o (opcional)</label>
                        <textarea id="goalDescription" class="form-control" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeGoalModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal de Or√ßamento -->
        <div class="modal" id="budgetModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="budgetModalTitle">Novo Or√ßamento</h3>
                    <button class="modal-close" onclick="closeBudgetModal()">&times;</button>
                </div>
                <form id="budgetForm" onsubmit="handleBudgetSubmit(event)">
                    <div class="form-group">
                        <label for="budgetTitle">T√≠tulo</label>
                        <input type="text" id="budgetTitle" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="budgetAmount">Valor Total</label>
                        <input type="number" id="budgetAmount" class="form-control" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="budgetPeriod">Per√≠odo</label>
                        <select id="budgetPeriod" class="form-control" required>
                            <option value="month">Mensal</option>
                            <option value="quarter">Trimestral</option>
                            <option value="year">Anual</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="budgetStartDate">Data de In√≠cio</label>
                        <input type="date" id="budgetStartDate" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="budgetDescription">Descri√ß√£o (opcional)</label>
                        <textarea id="budgetDescription" class="form-control" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeBudgetModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal de Configura√ß√µes de Notifica√ß√£o -->
        <div class="modal" id="notificationSettingsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Configura√ß√µes de Notifica√ß√£o</h3>
                    <button class="modal-close" onclick="closeNotificationSettings()">&times;</button>
                </div>
                <div class="notification-settings">
                    <div class="notification-setting-item">
                        <div class="notification-setting-info">
                            <div class="notification-setting-label">Notifica√ß√µes do Navegador</div>
                            <div class="notification-setting-description">Receber notifica√ß√µes push do navegador</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="browserNotifications" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="notification-setting-item">
                        <div class="notification-setting-info">
                            <div class="notification-setting-label">Som</div>
                            <div class="notification-setting-description">Tocar som ao receber notifica√ß√µes</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="soundEnabled" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="notification-setting-item">
                        <div class="notification-setting-info">
                            <div class="notification-setting-label">Vibra√ß√£o</div>
                            <div class="notification-setting-description">Vibrar dispositivo ao receber notifica√ß√µes</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="vibrationEnabled">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="notification-setting-item">
                        <div class="notification-setting-info">
                            <div class="notification-setting-label">Alertas de Or√ßamento</div>
                            <div class="notification-setting-description">Avisar quando or√ßamento estiver pr√≥ximo do limite</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="budgetAlerts" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="notification-setting-item">
                        <div class="notification-setting-info">
                            <div class="notification-setting-label">Lembretes de Metas</div>
                            <div class="notification-setting-description">Lembrar sobre progresso das metas</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="goalReminders" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="notification-setting-item">
                        <div class="notification-setting-info">
                            <div class="notification-setting-label">Lembretes de Pagamento</div>
                            <div class="notification-setting-description">Lembrar sobre pagamentos recorrentes</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="paymentReminders" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="notification-setting-item">
                        <div class="notification-setting-info">
                            <div class="notification-setting-label">Backup Autom√°tico</div>
                            <div class="notification-setting-description">Notificar sobre backup autom√°tico dos dados</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="backupNotifications" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="quiet-hours-settings">
                        <h4>Hor√°rio Silencioso</h4>
                        <div class="time-inputs">
                            <div class="time-input">
                                <label for="quietStart">In√≠cio</label>
                                <input type="time" id="quietStart" value="22:00">
                            </div>
                            <div class="time-input">
                                <label for="quietEnd">Fim</label>
                                <input type="time" id="quietEnd" value="08:00">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    
    <!-- Firebase -->
    <script src="js/firebase/config.js"></script>
    <script src="js/firebase/auth.js"></script>
    <script src="js/firebase/database.js"></script>
    
    <!-- Utils -->
    <script src="js/utils/helpers.js"></script>
    <script src="js/utils/ui.js"></script>
    <script src="js/utils/storage.js"></script>
    <script src="js/utils/notifications.js"></script>
    <script src="js/utils/i18n.js"></script>
    
    <!-- Modules -->
    <script src="js/modules/transactions.js"></script>
    <script src="js/modules/categories.js"></script>
    <script src="js/modules/goals.js"></script>
    <script src="js/modules/budgets.js"></script>
    <script src="js/modules/voice-recognition.js"></script>
    
    <!-- Main App -->
    <script src="js/app.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Sistema de Notifica√ß√µes Inteligente</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin: 20px 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .test-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin: 16px 0;
        }
        
        .test-button {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .test-button.success { background: #10b981; color: white; }
        .test-button.error { background: #ef4444; color: white; }
        .test-button.warning { background: #f59e0b; color: white; }
        .test-button.info { background: #3b82f6; color: white; }
        .test-button.alert { background: #dc2626; color: white; }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-online { background: #10b981; }
        .status-offline { background: #ef4444; }
        .status-loading { background: #f59e0b; animation: pulse 1s infinite; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .feature-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 12px;
        }
        
        .feature-success { background: rgba(16, 185, 129, 0.1); color: #10b981; }
        .feature-info { background: rgba(59, 130, 246, 0.1); color: #3b82f6; }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üîî Teste - Sistema de Notifica√ß√µes Inteligente</h1>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="showNotificationSettings()">
                    ‚öôÔ∏è Configura√ß√µes
                </button>
                <button class="btn btn-secondary" onclick="window.history.back()">
                    ‚Üê Voltar
                </button>
            </div>
        </header>

        <div class="test-section">
            <h2>üìã Status do Sistema</h2>
            <div class="flex gap-4 items-center mb-4">
                <div>
                    <span class="status-indicator" id="notificationStatus"></span>
                    <span id="statusText">Verificando...</span>
                </div>
                <div>
                    <span class="status-indicator" id="permissionStatus"></span>
                    <span id="permissionText">Verificando permiss√µes...</span>
                </div>
            </div>
            
            <div class="feature-list">
                <li>
                    <span class="feature-icon feature-success">‚úÖ</span>
                    <span>Notifica√ß√µes do navegador</span>
                </li>
                <li>
                    <span class="feature-icon feature-success">‚úÖ</span>
                    <span>Notifica√ß√µes na interface</span>
                </li>
                <li>
                    <span class="feature-icon feature-success">‚úÖ</span>
                    <span>Sons e vibra√ß√£o</span>
                </li>
                <li>
                    <span class="feature-icon feature-success">‚úÖ</span>
                    <span>Hor√°rio silencioso</span>
                </li>
                <li>
                    <span class="feature-icon feature-success">‚úÖ</span>
                    <span>Lembretes inteligentes</span>
                </li>
                <li>
                    <span class="feature-icon feature-info">‚ÑπÔ∏è</span>
                    <span>Alertas de or√ßamento</span>
                </li>
                <li>
                    <span class="feature-icon feature-info">‚ÑπÔ∏è</span>
                    <span>Lembretes de metas</span>
                </li>
                <li>
                    <span class="feature-icon feature-info">‚ÑπÔ∏è</span>
                    <span>Lembretes de pagamento</span>
                </li>
            </div>
        </div>

        <div class="test-section">
            <h2>üß™ Testes de Notifica√ß√£o</h2>
            <p>Clique nos bot√µes abaixo para testar diferentes tipos de notifica√ß√£o:</p>
            
            <div class="test-buttons">
                <button class="test-button success" onclick="testSuccessNotification()">
                    ‚úÖ Sucesso
                </button>
                <button class="test-button error" onclick="testErrorNotification()">
                    ‚ùå Erro
                </button>
                <button class="test-button warning" onclick="testWarningNotification()">
                    ‚ö†Ô∏è Aviso
                </button>
                <button class="test-button info" onclick="testInfoNotification()">
                    ‚ÑπÔ∏è Informa√ß√£o
                </button>
                <button class="test-button alert" onclick="testAlertNotification()">
                    üö® Alerta
                </button>
            </div>
        </div>

        <div class="test-section">
            <h2>üéØ Testes Espec√≠ficos</h2>
            <p>Teste notifica√ß√µes espec√≠ficas do sistema financeiro:</p>
            
            <div class="test-buttons">
                <button class="test-button info" onclick="testBudgetAlert()">
                    üí∞ Alerta de Or√ßamento
                </button>
                <button class="test-button warning" onclick="testGoalReminder()">
                    üéØ Lembrete de Meta
                </button>
                <button class="test-button info" onclick="testPaymentReminder()">
                    üí≥ Lembrete de Pagamento
                </button>
                <button class="test-button warning" onclick="testBackupReminder()">
                    üíæ Lembrete de Backup
                </button>
            </div>
        </div>

        <div class="test-section">
            <h2>‚öôÔ∏è Configura√ß√µes Avan√ßadas</h2>
            <p>Teste as configura√ß√µes do sistema de notifica√ß√µes:</p>
            
            <div class="test-buttons">
                <button class="btn btn-secondary" onclick="testQuietHours()">
                    üåô Testar Hor√°rio Silencioso
                </button>
                <button class="btn btn-secondary" onclick="testSound()">
                    üîä Testar Som
                </button>
                <button class="btn btn-secondary" onclick="testVibration()">
                    üì≥ Testar Vibra√ß√£o
                </button>
                <button class="btn btn-secondary" onclick="clearAllNotifications()">
                    üóëÔ∏è Limpar Todas
                </button>
            </div>
        </div>

        <div class="test-section">
            <h2>üìä Estat√≠sticas</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                    <div class="text-2xl font-bold text-blue-600" id="totalNotifications">0</div>
                    <div class="text-sm text-blue-500">Total</div>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <div class="text-2xl font-bold text-green-600" id="unreadNotifications">0</div>
                    <div class="text-sm text-green-500">N√£o lidas</div>
                </div>
                <div class="text-center p-4 bg-yellow-50 rounded-lg">
                    <div class="text-2xl font-bold text-yellow-600" id="todayNotifications">0</div>
                    <div class="text-sm text-yellow-500">Hoje</div>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <div class="text-2xl font-bold text-purple-600" id="activeReminders">0</div>
                    <div class="text-sm text-purple-500">Lembretes</div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/modules/notifications.js"></script>
    <script>
        // Aguardar carregamento do sistema de notifica√ß√µes
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(updateStatus, 1000);
            setInterval(updateStatus, 5000);
            setInterval(updateStats, 2000);
        });

        function updateStatus() {
            const notificationManager = window.NotificationManager;
            
            if (notificationManager) {
                // Status do sistema
                const statusIndicator = document.getElementById('notificationStatus');
                const statusText = document.getElementById('statusText');
                
                if (notificationManager.settings.enabled) {
                    statusIndicator.className = 'status-indicator status-online';
                    statusText.textContent = 'Sistema ativo';
                } else {
                    statusIndicator.className = 'status-indicator status-offline';
                    statusText.textContent = 'Sistema desativado';
                }
                
                // Status das permiss√µes
                const permissionIndicator = document.getElementById('permissionStatus');
                const permissionText = document.getElementById('permissionText');
                
                if (notificationManager.permission === 'granted') {
                    permissionIndicator.className = 'status-indicator status-online';
                    permissionText.textContent = 'Permiss√µes concedidas';
                } else if (notificationManager.permission === 'denied') {
                    permissionIndicator.className = 'status-indicator status-offline';
                    permissionText.textContent = 'Permiss√µes negadas';
                } else {
                    permissionIndicator.className = 'status-indicator status-loading';
                    permissionText.textContent = 'Aguardando permiss√£o';
                }
            } else {
                document.getElementById('notificationStatus').className = 'status-indicator status-offline';
                document.getElementById('statusText').textContent = 'Sistema n√£o dispon√≠vel';
            }
        }

        function updateStats() {
            const notificationManager = window.NotificationManager;
            
            if (notificationManager) {
                const notifications = notificationManager.getNotifications();
                const unreadCount = notificationManager.getUnreadCount();
                
                document.getElementById('totalNotifications').textContent = notifications.length;
                document.getElementById('unreadNotifications').textContent = unreadCount;
                
                // Contar notifica√ß√µes de hoje
                const today = new Date().toDateString();
                const todayCount = notifications.filter(n => 
                    new Date(n.timestamp).toDateString() === today
                ).length;
                document.getElementById('todayNotifications').textContent = todayCount;
                
                // Contar lembretes ativos
                const activeReminders = notificationManager.reminders.filter(r => r.active).length;
                document.getElementById('activeReminders').textContent = activeReminders;
            }
        }

        // Fun√ß√µes de teste
        function testSuccessNotification() {
            if (window.NotificationManager) {
                window.NotificationManager.showNotification(
                    'Teste de Sucesso',
                    'Esta √© uma notifica√ß√£o de sucesso para testar o sistema!',
                    'success',
                    { category: 'test', data: { type: 'success' } }
                );
            }
        }

        function testErrorNotification() {
            if (window.NotificationManager) {
                window.NotificationManager.showNotification(
                    'Teste de Erro',
                    'Esta √© uma notifica√ß√£o de erro para testar o sistema!',
                    'error',
                    { category: 'test', data: { type: 'error' } }
                );
            }
        }

        function testWarningNotification() {
            if (window.NotificationManager) {
                window.NotificationManager.showNotification(
                    'Teste de Aviso',
                    'Esta √© uma notifica√ß√£o de aviso para testar o sistema!',
                    'warning',
                    { category: 'test', data: { type: 'warning' } }
                );
            }
        }

        function testInfoNotification() {
            if (window.NotificationManager) {
                window.NotificationManager.showNotification(
                    'Teste de Informa√ß√£o',
                    'Esta √© uma notifica√ß√£o de informa√ß√£o para testar o sistema!',
                    'info',
                    { category: 'test', data: { type: 'info' } }
                );
            }
        }

        function testAlertNotification() {
            if (window.NotificationManager) {
                window.NotificationManager.showNotification(
                    'Teste de Alerta',
                    'Esta √© uma notifica√ß√£o de alerta que requer aten√ß√£o!',
                    'alert',
                    { category: 'test', data: { type: 'alert' } }
                );
            }
        }

        function testBudgetAlert() {
            if (window.NotificationManager) {
                window.NotificationManager.showBudgetAlert('Alimenta√ß√£o', 450, 500);
            }
        }

        function testGoalReminder() {
            if (window.NotificationManager) {
                const testGoal = {
                    id: 'test-goal',
                    title: 'Viagem para Europa',
                    current: 5000,
                    target: 10000,
                    deadline: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000) // 30 dias
                };
                window.NotificationManager.showGoalReminder(testGoal);
            }
        }

        function testPaymentReminder() {
            if (window.NotificationManager) {
                const testTransaction = {
                    id: 'test-payment',
                    title: 'Aluguel',
                    amount: 1200,
                    isRecorrente: true,
                    proximoVencimento: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000) // 3 dias
                };
                window.NotificationManager.showPaymentReminder(testTransaction);
            }
        }

        function testBackupReminder() {
            if (window.NotificationManager) {
                window.NotificationManager.showBackupReminder();
            }
        }

        function testQuietHours() {
            if (window.NotificationManager) {
                const isQuiet = window.NotificationManager.isQuietHours();
                const message = isQuiet ? 
                    'Hor√°rio silencioso ativo - notifica√ß√µes suprimidas' : 
                    'Hor√°rio silencioso inativo - notifica√ß√µes permitidas';
                
                window.NotificationManager.showNotification(
                    'Teste de Hor√°rio Silencioso',
                    message,
                    isQuiet ? 'warning' : 'info',
                    { category: 'test', data: { quietHours: isQuiet } }
                );
            }
        }

        function testSound() {
            if (window.NotificationManager) {
                window.NotificationManager.playNotificationSound('info');
                window.NotificationManager.showNotification(
                    'Teste de Som',
                    'Voc√™ deve ter ouvido um som de notifica√ß√£o!',
                    'info',
                    { category: 'test', data: { sound: true } }
                );
            }
        }

        function testVibration() {
            if (window.NotificationManager && 'vibrate' in navigator) {
                window.NotificationManager.vibrate('alert');
                window.NotificationManager.showNotification(
                    'Teste de Vibra√ß√£o',
                    'Voc√™ deve ter sentido uma vibra√ß√£o no dispositivo!',
                    'info',
                    { category: 'test', data: { vibration: true } }
                );
            } else {
                alert('Vibra√ß√£o n√£o suportada neste dispositivo');
            }
        }

        function clearAllNotifications() {
            if (window.NotificationManager) {
                window.NotificationManager.clearAll();
                updateStats();
                window.NotificationManager.showNotification(
                    'Notifica√ß√µes Limpas',
                    'Todas as notifica√ß√µes foram removidas!',
                    'success',
                    { category: 'test', data: { cleared: true } }
                );
            }
        }

        function showNotificationSettings() {
            if (typeof showNotificationSettings === 'function') {
                showNotificationSettings();
            } else {
                alert('Fun√ß√£o de configura√ß√µes n√£o dispon√≠vel');
            }
        }
    </script>
</body>
</html> 